
<!-- saved from url=(0028)https://live.paj.com.my/P314 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="color-scheme" content="light dark"></head><body><div class="line-gutter-backdrop"></div><form autocomplete="off"><label class="line-wrap-control">Line wrap<input type="checkbox" aria-label="Line wrap"></label></form><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content">    <span class="html-tag">&lt;title&gt;</span>Jejak Kedudukan Bas Muafakat Johor<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">UTF-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">viewport</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">width=device-width, initial-scale=1.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">description</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Jejak Kedudukan Bas Muafakat Johor</span>"/&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">shortcut icon</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-paj.png" rel="noreferrer noopener">/assets/logo-paj.png</a>"/&gt;</span></td></tr><tr><td class="line-number" value="9"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="10"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/plugins/global/plugins.bundle.css" rel="noreferrer noopener">/assets/plugins/global/plugins.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/css/style.bundle.css" rel="noreferrer noopener">/assets/css/style.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="12"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css" rel="noreferrer noopener">https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">    <span class="html-tag">&lt;style&gt;</span></td></tr><tr><td class="line-number" value="14"></td><td class="line-content">        body {</td></tr><tr><td class="line-number" value="15"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="16"></td><td class="line-content">            padding: 0;</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">        #map {</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">            top: 0;</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">            bottom: 0;</td></tr><tr><td class="line-number" value="22"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="23"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="24"></td><td class="line-content">        .legend-card {</td></tr><tr><td class="line-number" value="25"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">            top: 10px;</td></tr><tr><td class="line-number" value="27"></td><td class="line-content">            right: 10px;</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">            background: white;</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">            padding-top: 3px;</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">            box-shadow: 0 2px 4px rgba(0,0,0,0.1);</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">            z-index: 1;</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">            max-width: 200px;</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">        .legend-title {</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">            font-weight: 600;</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">            margin: 0 0 10px 0;</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="42"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="43"></td><td class="line-content">        .legend-item {</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">            display: flex;</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">            align-items: center;</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">            margin-bottom: 8px;</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">        .legend-item:last-child {</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">            margin-bottom: 0;</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="51"></td><td class="line-content">        .legend-icon {</td></tr><tr><td class="line-number" value="52"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">            height: 20px;</td></tr><tr><td class="line-number" value="54"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="55"></td><td class="line-content">            background-size: contain;</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">            background-repeat: no-repeat;</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">            background-position: center;</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="59"></td><td class="line-content">        .legend-text {</td></tr><tr><td class="line-number" value="60"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">        .legend-route {</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">            background-color: #ff0000;</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">            height: 3px;</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="68"></td><td class="line-content">            border-radius: 2px;</td></tr><tr><td class="line-number" value="69"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">        .mapboxgl-popup-content {</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="73"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="74"></td><td class="line-content">        .bus-stop-name {</td></tr><tr><td class="line-number" value="75"></td><td class="line-content">            font-weight: bold;</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="77"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="78"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="80"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="81"></td><td class="line-content">        /* New styles for the sliding cards */</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">        .bus-cards-container {</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">            position: fixed;</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">            bottom: 30px;</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">            left: 50%;</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">            transform: translateX(-50%);</td></tr><tr><td class="line-number" value="87"></td><td class="line-content">            /*height: 50px;*/</td></tr><tr><td class="line-number" value="88"></td><td class="line-content">            background: transparent;</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">            overflow-x: auto;</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">            white-space: nowrap;</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">            padding-top: 10px;</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">            padding-bottom: 10px;</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">            padding-left: 10px;</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">            /*padding-bottom: 10px;*/</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">            scrollbar-width: none; /* Firefox */</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">            -ms-overflow-style: none; /* IE and Edge */</td></tr><tr><td class="line-number" value="97"></td><td class="line-content">            z-index: 1000;</td></tr><tr><td class="line-number" value="98"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">            max-width: 1200px;</td></tr><tr><td class="line-number" value="100"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="101"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="102"></td><td class="line-content">        /*.bus-cards-container::-webkit-scrollbar {*/</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">        /*    display: none; !* Chrome, Safari, Opera *!*/</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="105"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="106"></td><td class="line-content">        .bus-card {</td></tr><tr><td class="line-number" value="107"></td><td class="line-content">            display: inline-block;</td></tr><tr><td class="line-number" value="108"></td><td class="line-content">            width: 160px;</td></tr><tr><td class="line-number" value="109"></td><td class="line-content">            height: 60px;</td></tr><tr><td class="line-number" value="110"></td><td class="line-content">            margin-right: 10px;</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">            background: rgba(255, 255, 255, 0.9);</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">            padding: 10px;</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">            vertical-align: top;</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">            cursor: pointer;</td></tr><tr><td class="line-number" value="117"></td><td class="line-content">            transition: all 0.2s ease;</td></tr><tr><td class="line-number" value="118"></td><td class="line-content">            backdrop-filter: blur(5px);</td></tr><tr><td class="line-number" value="119"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; /* Add this line */</td></tr><tr><td class="line-number" value="120"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="121"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="122"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="123"></td><td class="line-content">        .bus-card:hover {</td></tr><tr><td class="line-number" value="124"></td><td class="line-content">            transform: translateY(-2px);</td></tr><tr><td class="line-number" value="125"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="126"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="127"></td><td class="line-content">        .bus-card.active {</td></tr><tr><td class="line-number" value="128"></td><td class="line-content">            background: #e3f2fd;</td></tr><tr><td class="line-number" value="129"></td><td class="line-content">            border: 2px solid #2196f3;</td></tr><tr><td class="line-number" value="130"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="131"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="132"></td><td class="line-content">        .bus-id {</td></tr><tr><td class="line-number" value="133"></td><td class="line-content">            /*font-weight: bold;*/</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">            /*font-size: 16px;*/</td></tr><tr><td class="line-number" value="135"></td><td class="line-content">            color: #434343;</td></tr><tr><td class="line-number" value="136"></td><td class="line-content">            margin: 0 0 5px 0;</td></tr><tr><td class="line-number" value="137"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="138"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="139"></td><td class="line-content">        .last-update {</td></tr><tr><td class="line-number" value="140"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="141"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="142"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="143"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="144"></td><td class="line-content">        .online {</td></tr><tr><td class="line-number" value="145"></td><td class="line-content">            /*background: #0fa354;*/</td></tr><tr><td class="line-number" value="146"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="147"></td><td class="line-content">        .offline {</td></tr><tr><td class="line-number" value="148"></td><td class="line-content">            background: #dadada;</td></tr><tr><td class="line-number" value="149"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="150"></td><td class="line-content">        /*.logo-container img {*/</td></tr><tr><td class="line-number" value="151"></td><td class="line-content">        /*    height: 40px;*/</td></tr><tr><td class="line-number" value="152"></td><td class="line-content">        /*    width: auto;*/</td></tr><tr><td class="line-number" value="153"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="154"></td><td class="line-content"> .back-btn{</td></tr><tr><td class="line-number" value="155"></td><td class="line-content">      display:inline-flex;</td></tr><tr><td class="line-number" value="156"></td><td class="line-content">      align-items:center;</td></tr><tr><td class="line-number" value="157"></td><td class="line-content">      gap:8px;</td></tr><tr><td class="line-number" value="158"></td><td class="line-content">      margin-top:10px;</td></tr><tr><td class="line-number" value="159"></td><td class="line-content">      padding:8px 12px;</td></tr><tr><td class="line-number" value="160"></td><td class="line-content">      border-radius:8px;</td></tr><tr><td class="line-number" value="161"></td><td class="line-content">      border:1px solid rgba(0,0,0,.08);</td></tr><tr><td class="line-number" value="162"></td><td class="line-content">      background:#f4f6f8;</td></tr><tr><td class="line-number" value="163"></td><td class="line-content">      font-size:12px;</td></tr><tr><td class="line-number" value="164"></td><td class="line-content">      font-weight:600;</td></tr><tr><td class="line-number" value="165"></td><td class="line-content">      color:#2b2e34;</td></tr><tr><td class="line-number" value="166"></td><td class="line-content">      text-decoration:none;</td></tr><tr><td class="line-number" value="167"></td><td class="line-content">      box-shadow:0 1px 2px rgba(0,0,0,.06);</td></tr><tr><td class="line-number" value="168"></td><td class="line-content">      transition:transform .12s ease, background .12s ease;</td></tr><tr><td class="line-number" value="169"></td><td class="line-content">  }</td></tr><tr><td class="line-number" value="170"></td><td class="line-content">  .back-btn:hover{ background:#e9ecef; transform:translateY(-1px); }</td></tr><tr><td class="line-number" value="171"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="172"></td><td class="line-content">  .legend-card{ z-index: 2001!important; } /* pastikan atas Mapbox controls */</td></tr><tr><td class="line-number" value="173"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="174"></td><td class="line-content">  .legend-nav {</td></tr><tr><td class="line-number" value="175"></td><td class="line-content">    display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;</td></tr><tr><td class="line-number" value="176"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="177"></td><td class="line-content">.legend-btn {</td></tr><tr><td class="line-number" value="178"></td><td class="line-content">    display:inline-flex; align-items:center; gap:6px;</td></tr><tr><td class="line-number" value="179"></td><td class="line-content">    background:#f4f6f8; border:1px solid #e2e8f0; border-radius:8px;</td></tr><tr><td class="line-number" value="180"></td><td class="line-content">    padding:8px 10px; font-size:12px; color:#333; text-decoration:none;</td></tr><tr><td class="line-number" value="181"></td><td class="line-content">    box-shadow:0 1px 2px rgba(0,0,0,.05);</td></tr><tr><td class="line-number" value="182"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="183"></td><td class="line-content">.legend-btn:hover { background:#eef2f6; }</td></tr><tr><td class="line-number" value="184"></td><td class="line-content">.legend-btn .kecil { opacity:.7; font-weight:600; }</td></tr><tr><td class="line-number" value="185"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="186"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="187"></td><td class="line-content">    <span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="188"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="189"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://unpkg.com/@turf/turf@6.5.0/turf.min.js" rel="noreferrer noopener">https://unpkg.com/@turf/turf@6.5.0/turf.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="190"></td><td class="line-content"><span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="191"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><span class="html-tag">&lt;body&gt;</span></td></tr><tr><td class="line-number" value="193"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">map</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="194"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bus-cards-container</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">busCards</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="195"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-card text-center</span>"&gt;</span></td></tr><tr><td class="line-number" value="196"></td><td class="line-content">    <span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-main.png" rel="noreferrer noopener">https://live.paj.com.my/assets/logo-main.png</a>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">logo-container mt-2</span>" <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">Logo</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width: 70px; height: auto;</span>"&gt;</span></td></tr><tr><td class="line-number" value="197"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="198"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="199"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="200"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Bas<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="201"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="202"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="203"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-stop-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="204"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Perhentian<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="205"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="206"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="207"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-route</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="208"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Laluan<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="209"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="210"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="211"></td><td class="line-content">    <span class="html-comment">&lt;!-- NEW: Butang Kembali --&gt;</span></td></tr><tr><td class="line-number" value="212"></td><td class="line-content">    <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">back-btn</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://live.paj.com.my/" rel="noreferrer noopener">https://live.paj.com.my</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">btnBack</span>"&gt;</span></td></tr><tr><td class="line-number" value="213"></td><td class="line-content">        <span class="html-comment">&lt;!-- ikon anak panah kecil (SVG inline supaya tiada dependensi) --&gt;</span></td></tr><tr><td class="line-number" value="214"></td><td class="line-content">        <span class="html-tag">&lt;svg <span class="html-attribute-name">width</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">viewBox</span>="<span class="html-attribute-value">0 0 24 24</span>" <span class="html-attribute-name">fill</span>="<span class="html-attribute-value">none</span>" <span class="html-attribute-name">aria-hidden</span>="<span class="html-attribute-value">true</span>"&gt;</span></td></tr><tr><td class="line-number" value="215"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M10 19l-7-7 7-7</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="216"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M3 12h18</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="217"></td><td class="line-content">        <span class="html-tag">&lt;/svg&gt;</span></td></tr><tr><td class="line-number" value="218"></td><td class="line-content">        Kembali</td></tr><tr><td class="line-number" value="219"></td><td class="line-content">    <span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="220"></td><td class="line-content"><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="221"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://code.jquery.com/jquery-3.6.0.min.js" rel="noreferrer noopener">https://code.jquery.com/jquery-3.6.0.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="222"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="223"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="224"></td><td class="line-content">    let geojson = {"name":"P314","type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"LineString","coordinates":[[103.9012836556493,1.46573681160258],[103.9013714782069,1.465520100537364],[103.9013456598785,1.465465877139654],[103.9019933882201,1.465152794797888],[103.9024491145156,1.464944412552618],[103.9030857425989,1.466050612760981],[103.903503281641,1.46684032165456],[103.9047494523773,1.468842051895669],[103.904492556621,1.468950796365658],[103.9028580908688,1.469769911111672],[103.9014816617017,1.470392415070578],[103.8999237066,1.471126405287855],[103.8994964854292,1.47017924219178],[103.8988753501847,1.468867630847701],[103.898739391911,1.468526254719082],[103.8982442275874,1.467533413225422],[103.8976968497836,1.466236778562968],[103.8969870557636,1.464793351183581],[103.8969331946667,1.464725581540792],[103.8968219016591,1.46478719293895],[103.8966085891211,1.464896487673454],[103.8963341244132,1.465008909944112],[103.8960709009625,1.465122104741312],[103.8952363509183,1.465492347396652],[103.89399500073,1.466136966919001],[103.8930917286525,1.466542130072196],[103.8929100960052,1.46662530171151],[103.8924097397941,1.46703452272595],[103.8922680013157,1.467330688707449],[103.892140729588,1.467746223633871],[103.8922647856811,1.468223229214056],[103.8928133812787,1.469550426844455],[103.8935431182773,1.4708673786663],[103.8940906638016,1.472075266234415],[103.8944962503245,1.472904041564219],[103.8947193821166,1.473123384662597],[103.8950128527486,1.47324875630766],[103.8953659784536,1.473253597530837],[103.8957607738303,1.473185941037823],[103.8962791522436,1.472922988152875],[103.8969395672508,1.472612770213528],[103.8968382486509,1.472349272805948],[103.8965620882363,1.471793220015756],[103.8962219948403,1.471094179273347],[103.8959876320269,1.470556234058683],[103.8957263555752,1.469962512615229],[103.8955481214684,1.469574589323479],[103.895401410033,1.46921139608329],[103.8954312282494,1.469153314881965],[103.8954656975263,1.469108796894358],[103.8955467946468,1.469078050145972],[103.8956081921049,1.469037129934046],[103.8957327688652,1.469222285166379],[103.8959364992404,1.46966260357445],[103.8958564703402,1.469722616045652],[103.8956694643262,1.469786608435028],[103.8959947211191,1.4704791920934],[103.8962886866495,1.471101791385723],[103.8965515846622,1.471722316605627],[103.8969665872924,1.472587597900401],[103.8970670852615,1.472543301727613],[103.8983992836847,1.471913281355095],[103.8997387209381,1.471295171505828],[103.9000440284966,1.47137159783884],[103.900385569546,1.472246206527312],[103.9011519148962,1.47383537051658],[103.9015085302029,1.474649922360621],[103.9019965536871,1.475881567874424],[103.9025957542208,1.477287819121167],[103.9032689546296,1.478982994241954],[103.904012136009,1.480975733676283],[103.90442177556,1.481794788308757],[103.9047980540283,1.482905475610021],[103.9052693549765,1.483858732119917],[103.9053645674441,1.484599304762537],[103.9052725834878,1.485243729903012],[103.9045983638272,1.486915318353494],[103.9044178147074,1.487318927886287],[103.9046220102402,1.487408636319619],[103.9055002978128,1.487850105340476],[103.9063469823934,1.488235823520631],[103.9069858056473,1.488481716757599],[103.9072469427573,1.488541088449067],[103.907619740072,1.488552416986021],[103.9082359905447,1.488421094748833],[103.9088503245568,1.488179090614011],[103.9092067863732,1.48803541525627],[103.9110552133109,1.487965362462403],[103.912810513744,1.48787964500307],[103.913677213851,1.487980355543199],[103.9145681618442,1.488026264398886],[103.9148783753349,1.488104637900893],[103.9153640946558,1.487452214621857],[103.915664726456,1.487197397990725],[103.916099026803,1.487079682879302],[103.9163889197117,1.487316747243379],[103.9171831244384,1.488758415895643],[103.9191083447246,1.492241897144393],[103.9207943140619,1.495094372709217],[103.9210338649665,1.494907741113425],[103.9216900251903,1.494337056988164],[103.9224127581988,1.493642224693743],[103.9231430203384,1.492930809656457],[103.9234491549589,1.49262278215452],[103.923552161334,1.492629677753538],[103.9236510161913,1.492652888885239],[103.9245010421548,1.493399986138487],[103.925988745652,1.494676560610066],[103.9266846143872,1.495284086787009],[103.9268705969219,1.495416959461814],[103.9270138432066,1.495526172413919],[103.9272277135881,1.495609793733158],[103.9274427596585,1.495652744930891],[103.9277007488892,1.495688728449735],[103.9277934620184,1.495703695936694],[103.9278181068741,1.495650546351349],[103.9278408054916,1.495556780334994],[103.9276904695722,1.495503874497053],[103.9276004659843,1.495542097860842],[103.9273789364248,1.495499474464234],[103.9273713345724,1.495499268088681],[103.9271256050767,1.495433817995182],[103.9269412169214,1.49531872627422],[103.9264523889762,1.494943902446124],[103.9256682508795,1.494247994711599],[103.9246115830834,1.493368317083056],[103.9238043956821,1.492638018249301],[103.9237413871771,1.492616121570246],[103.9237392774126,1.492521979457782],[103.9236906020845,1.49238416240296],[103.9235929918569,1.492348654138093],[103.9234355123663,1.492377238712216],[103.9233226122624,1.492544678952945],[103.9232703386113,1.492646693707225],[103.9225050941999,1.493436227311035],[103.9215168224402,1.494395813369603],[103.9209187657985,1.494845637598188],[103.9207698205791,1.494929939194139],[103.9206794418658,1.494996086861635],[103.9208620957333,1.495310477531865],[103.9211218056375,1.495865896284512],[103.9213894751426,1.496585253432776],[103.9216383975492,1.49746764411658],[103.9217014117665,1.499105604404577],[103.9217302371212,1.50005225481989],[103.9217566872133,1.500390381004431],[103.9218633668364,1.501957150170423],[103.9219645457544,1.503347427055748],[103.9220961831413,1.505996024826195],[103.9232630673311,1.505965183477046],[103.9255083718333,1.505909074537699],[103.928224862727,1.505822535917583],[103.9304111307478,1.505736854872279],[103.9320771213679,1.505748892814461],[103.9323127783926,1.505871466578443],[103.9325005919157,1.506159912127399],[103.9325333378502,1.507633670308915],[103.932435285816,1.507844321556792],[103.9321338300904,1.508020766683938],[103.9290196898608,1.508127425573536],[103.9252067365784,1.508286351059354],[103.9231879146012,1.508359495271273],[103.9231742955084,1.509222513366481],[103.9222298227259,1.509308110995311],[103.9223731079234,1.512027909555043],[103.92247829804,1.516819370308311],[103.9225255515316,1.518483361978402],[103.9226333760128,1.519560277835335],[103.9230518046355,1.520674989921167],[103.9235747349207,1.521372386365274],[103.9248205272681,1.522381705779947],[103.9261028168367,1.522881002119407],[103.9272332376906,1.522862823257344],[103.9293103104185,1.522718257459639],[103.9481685235762,1.521673001961917],[103.9550275043748,1.521380444064853],[103.966387782541,1.520854490881979],[103.974748920682,1.520430808516045],[103.9823181630829,1.52005861031552],[103.9880002840033,1.51944237203591],[103.9925339816149,1.51899291926115],[103.9956041147788,1.518563475548639],[103.9968356201743,1.518372216159821],[103.9972075424325,1.518330522239674],[103.9973737589452,1.518358430887596],[103.9973396790093,1.518424483746996],[103.9972983835777,1.518480254917639],[103.9971365215947,1.518487111617075],[103.9969769844743,1.518528110194283],[103.9971149070095,1.51863032297966],[103.9973452630057,1.518563238519396],[103.9973358995566,1.518518926310229],[103.9973373355709,1.518455265771484],[103.9974164478914,1.51836464044308],[103.997440827994,1.518311597381665],[103.9973701670494,1.518290235595262],[103.9972434592014,1.518296268839137],[103.9965520614379,1.518357366673374],[103.9954759815184,1.518534034987154],[103.993261521793,1.51882654048546],[103.9906618795945,1.51911911276017],[103.9878786888515,1.519397270549355],[103.9852074537464,1.51969793407965],[103.9817587784662,1.519931483799998],[103.9789781976357,1.52007878780977],[103.9762193655313,1.520230813405444],[103.9738211228205,1.520332265707384],[103.9708688141292,1.520500663760023],[103.9682845739332,1.520631067881116],[103.9656724823303,1.520770196706517],[103.9620363970875,1.520959371873751],[103.9590745271577,1.521068000875686],[103.9559537283051,1.521223579140546],[103.9528189104475,1.521381149635841],[103.9500947201914,1.521481106874329],[103.9463370930751,1.521651467483373],[103.9433544400057,1.52180735179218],[103.9426353350103,1.521916649159115],[103.9414053351283,1.521998547016098],[103.9385837808165,1.522147572324646],[103.9365619336403,1.522225029354397],[103.9345041959779,1.522345130702611],[103.9330229212484,1.522468193920112],[103.9302981222298,1.522601362263071],[103.9281499859097,1.522707529440634],[103.9261307922452,1.522783588908925],[103.9258953233991,1.52275538458954],[103.9249466889994,1.522374928746041],[103.924134681201,1.521902033704293],[103.9235282049707,1.521206112898789],[103.9231882231693,1.52079990807992],[103.9230528657498,1.520540721170309],[103.9228007507195,1.519841972712249],[103.9226658516782,1.519512989255701],[103.9226044015042,1.518736766950474],[103.9225589900857,1.517417345525479],[103.9225530574511,1.516475744149401],[103.9224720705106,1.514997807237984],[103.9223365960681,1.512645738352642],[103.9222357996634,1.510491543082431],[103.922211742046,1.509836386421589],[103.9221372857757,1.509206214778445],[103.9231490643608,1.509125349622255],[103.923195579324,1.508461042230503],[103.9322058372183,1.508066120718239],[103.9325160910418,1.507884326754355],[103.9326143500378,1.507536613187447],[103.9325797666921,1.506515540936117],[103.932571603019,1.506072048797972],[103.9323578244455,1.505695108861072],[103.9319013246808,1.505622701848145],[103.9311667287757,1.505646878967455],[103.9275612300472,1.505804415302207],[103.9224175698277,1.505926290300633],[103.9222005169139,1.50593599204946],[103.9219165983551,1.502160239816921],[103.9218363946419,1.50067850597027],[103.9216594721129,1.498585897902952],[103.921610021455,1.497937720667294],[103.9215546087948,1.497267912261213],[103.9214686275109,1.496715317562751],[103.9212115702877,1.495988486061842],[103.9210049674438,1.495505413022554],[103.9208530814219,1.495158555756276],[103.9213848587597,1.49469178292298],[103.9216209154953,1.494471143516192],[103.922265780858,1.493817995826422],[103.9227318062545,1.49338943328633],[103.9233208249669,1.492811349034384],[103.9234605741196,1.49266892417767],[103.9235425812226,1.492671149944042],[103.9236719654748,1.492685780046634],[103.9238301754015,1.492774145116846],[103.9247647636672,1.493591682805808],[103.9259883172289,1.494623863780276],[103.9266275463754,1.495188611831038],[103.926847676531,1.495341950235393],[103.9270389634571,1.495482581925726],[103.9271619141866,1.495537172386906],[103.9273771724211,1.495593785654954],[103.9276179668301,1.495630387798764],[103.9277464902477,1.495661064156626],[103.92778588028,1.495631932886309],[103.9277710566522,1.495574561440595],[103.9276617061154,1.495577564350382],[103.9275269860775,1.49556793571999],[103.927350714433,1.495539323956752],[103.9271333351663,1.495485733701706],[103.9269907872186,1.495392285274514],[103.9268168056672,1.495280496821469],[103.926478490946,1.494996416505666],[103.9259091258973,1.494506616550776],[103.9251548512661,1.493864769135],[103.9246225944499,1.493419854530494],[103.9240062755493,1.49287722231595],[103.923829632747,1.492702407814453],[103.923696746347,1.492621120203901],[103.9236957976469,1.492555329972452],[103.9236732047225,1.492425403736596],[103.9235280146529,1.492360580766688],[103.9234352227719,1.492414843882699],[103.9233951259043,1.492484235689229],[103.9233407175754,1.492583464702969],[103.9232590416932,1.492686486701547],[103.9225491328272,1.493375050099584],[103.9218643665313,1.494047117553382],[103.921113052391,1.494687860115602],[103.9208845403295,1.494765879728234],[103.9207446420264,1.494721930902831],[103.9205617786375,1.494675425334766],[103.9202708487284,1.494000133543789],[103.9200944999229,1.493679193192671],[103.9199986169179,1.493598761066144],[103.9197102320651,1.493155445866923],[103.9179574606271,1.490011596073179],[103.9169298041903,1.488098027380685],[103.9164606938042,1.487193264237933],[103.9159676958343,1.486936667314194],[103.9155513458398,1.487175586605172],[103.91482705201,1.487830308526589],[103.9146782428772,1.487934107316692],[103.9123725639684,1.487819363398379],[103.9098128784232,1.487919425961007],[103.9084606489659,1.488204666089634],[103.907464087052,1.488500025502541],[103.9069558308982,1.488417742828879],[103.9045730202925,1.48729770292466],[103.9049526977428,1.486380879243167],[103.9053594563098,1.485259627129262],[103.9054757182197,1.484593041319756],[103.9053884488662,1.483994947781621],[103.9049515591741,1.482867883110017],[103.9043693589934,1.481525391101946],[103.9040943910011,1.480894091231095],[103.9037383425047,1.479998879241494],[103.9033390997931,1.47896946087967],[103.9033338875911,1.478969460924779],[103.9030002761459,1.478134334393138],[103.9025163594302,1.476963016902093],[103.9022240297445,1.476269077014825],[103.9017862889927,1.475212721378271],[103.9013123572443,1.473962762722022],[103.9011635143361,1.473650947009022],[103.9000706400521,1.471348840676405],[103.8991487378455,1.469373385181201],[103.8984767201565,1.467882186113135],[103.8978774607538,1.466819135061042],[103.8969844284098,1.464674280556771],[103.8950756515141,1.465600497219868],[103.8931104015318,1.466577722155895],[103.892515047159,1.46688514604087],[103.8922494201794,1.467233264062313],[103.8921747576929,1.467477619315552],[103.8922356590424,1.468008127045871],[103.8925432349122,1.46868077492019],[103.8931506729647,1.470051138139732],[103.8942759172592,1.472307569380711],[103.8946056910696,1.472933350593187],[103.8949062920207,1.473147273674355],[103.8951430567574,1.473185404832787],[103.8955254504784,1.473158149558374],[103.8958096777823,1.473060907431137],[103.8962472349184,1.472891370193065],[103.8968946944699,1.472508894832404],[103.8967872034526,1.472324073433474],[103.896630340832,1.47195801088528],[103.8964266708355,1.471543499548844],[103.8960978711457,1.470842849925416],[103.895782319055,1.470112836022897],[103.895557256786,1.469643336434],[103.8953797053782,1.469208031550191],[103.895423035114,1.469124207580927],[103.8955652756035,1.469035423727794],[103.8956296743376,1.469018368336606],[103.8958379945496,1.469341539148656],[103.8959683348675,1.469670729218915],[103.8958376110162,1.469748648580746],[103.8956693494561,1.469803706176166],[103.8959031775409,1.470312081651107],[103.8962084189509,1.470980989035927],[103.8964172589201,1.471402141936962],[103.8967867269296,1.472174785477599],[103.8969781961086,1.472527474067611],[103.8983587988476,1.471862555591969],[103.8998764963266,1.471158845115518],[103.9020935549049,1.470248852489939],[103.9000870733804,1.465994155142139],[103.9006523920572,1.465757883973314],[103.9007556588649,1.465903076408479],[103.9012836556493,1.46573681160258]]}}]};</td></tr><tr><td class="line-number" value="225"></td><td class="line-content">    let pois = [{"name":"Jalan Ixora 4, ~ Bandar Bistari Perdana","lat":"1.50572638","lng":"103.95010780"},{"name":"Sekolah Agama Dato\u0027 Hj Abdul Rahman Ahmad","lat":"1.52232450","lng":"103.93472350"},{"name":"Taman Cahaya Masai","lat":"1.50711857","lng":"103.92222980"},{"name":"Taman Desa Rakyat Perdana","lat":"1.51377648","lng":"103.92245690"},{"name":"Opposite Sekolah Kebangsaan Kota Masai 3,Jalan Kota Masai -","lat":"1.49072228","lng":"103.92689010"},{"name":"Taman Kota Masai, Jalan Kota Masai","lat":"1.49323732","lng":"103.92301420"},{"name":"Tesco Kota Masai","lat":"1.48449351","lng":"103.93574640"},{"name":"Terminal Bas Kota Masai","lat":"1.48180631","lng":"103.95376850"},{"name":"Terminal Bas Kota Masai","lat":"1.48180631","lng":"103.95376850"}];</td></tr><tr><td class="line-number" value="226"></td><td class="line-content">    let imageBusStop = 'https://live.paj.com.my/assets/bus-stop-marker.png';</td></tr><tr><td class="line-number" value="227"></td><td class="line-content">    let imageArrows = 'https://live.paj.com.my/assets/arrow-markers-red.png';</td></tr><tr><td class="line-number" value="228"></td><td class="line-content">    let imageBus = 'https://live.paj.com.my/assets/bus-marker.png';</td></tr><tr><td class="line-number" value="229"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="230"></td><td class="line-content">    // Convert POIs to GeoJSON format</td></tr><tr><td class="line-number" value="231"></td><td class="line-content">    const poisGeoJSON = {</td></tr><tr><td class="line-number" value="232"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="233"></td><td class="line-content">        features: pois.map(poi =&gt; ({</td></tr><tr><td class="line-number" value="234"></td><td class="line-content">            type: 'Feature',</td></tr><tr><td class="line-number" value="235"></td><td class="line-content">            geometry: {</td></tr><tr><td class="line-number" value="236"></td><td class="line-content">                type: 'Point',</td></tr><tr><td class="line-number" value="237"></td><td class="line-content">                coordinates: [parseFloat(poi.lng), parseFloat(poi.lat)]</td></tr><tr><td class="line-number" value="238"></td><td class="line-content">            },</td></tr><tr><td class="line-number" value="239"></td><td class="line-content">            properties: {</td></tr><tr><td class="line-number" value="240"></td><td class="line-content">                name: poi.name</td></tr><tr><td class="line-number" value="241"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="242"></td><td class="line-content">        }))</td></tr><tr><td class="line-number" value="243"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="244"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="245"></td><td class="line-content">    // Create initial bus GeoJSON with empty features</td></tr><tr><td class="line-number" value="246"></td><td class="line-content">    const busGeoJSON = {</td></tr><tr><td class="line-number" value="247"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="248"></td><td class="line-content">        features: []</td></tr><tr><td class="line-number" value="249"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="250"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="251"></td><td class="line-content">    mapboxgl.accessToken = 'pk.eyJ1IjoiYWxpZmRhcnNpbSIsImEiOiJjbTRjZ3djcmIwNTMxMmlxcGZvZWx1eTFqIn0.X3VV1PhXekp3_HAwoB6kbw';</td></tr><tr><td class="line-number" value="252"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="253"></td><td class="line-content">    // Initialize map with default center</td></tr><tr><td class="line-number" value="254"></td><td class="line-content">    const map = new mapboxgl.Map({</td></tr><tr><td class="line-number" value="255"></td><td class="line-content">        container: 'map',</td></tr><tr><td class="line-number" value="256"></td><td class="line-content">        style: 'mapbox://styles/mapbox/streets-v12',</td></tr><tr><td class="line-number" value="257"></td><td class="line-content">        center: [103.317818, 2.029433],</td></tr><tr><td class="line-number" value="258"></td><td class="line-content">        zoom: 8</td></tr><tr><td class="line-number" value="259"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="260"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="261"></td><td class="line-content">    // Wait for map to load before adding layers</td></tr><tr><td class="line-number" value="262"></td><td class="line-content">    map.on('load', () =&gt; {</td></tr><tr><td class="line-number" value="263"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="264"></td><td class="line-content">        // Load both bus stop and bus icons</td></tr><tr><td class="line-number" value="265"></td><td class="line-content">        Promise.all([</td></tr><tr><td class="line-number" value="266"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="267"></td><td class="line-content">                map.loadImage(imageBusStop, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="268"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="269"></td><td class="line-content">                    map.addImage('bus-stop-icon', image);</td></tr><tr><td class="line-number" value="270"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="271"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="272"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="273"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="274"></td><td class="line-content">                map.loadImage(imageBus, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="275"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="276"></td><td class="line-content">                    map.addImage('bus-icon', image);</td></tr><tr><td class="line-number" value="277"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="278"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="279"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="280"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="281"></td><td class="line-content">                map.loadImage(imageArrows, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="282"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="283"></td><td class="line-content">                    map.addImage('arrow-icon', image);</td></tr><tr><td class="line-number" value="284"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="285"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="286"></td><td class="line-content">            })</td></tr><tr><td class="line-number" value="287"></td><td class="line-content">        ]).then(() =&gt; {</td></tr><tr><td class="line-number" value="288"></td><td class="line-content">            // Add the route source</td></tr><tr><td class="line-number" value="289"></td><td class="line-content">            map.addSource('route', {</td></tr><tr><td class="line-number" value="290"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="291"></td><td class="line-content">                'data': geojson</td></tr><tr><td class="line-number" value="292"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="293"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="294"></td><td class="line-content">            // Add the bus stops source</td></tr><tr><td class="line-number" value="295"></td><td class="line-content">            map.addSource('bus-stops', {</td></tr><tr><td class="line-number" value="296"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="297"></td><td class="line-content">                'data': poisGeoJSON</td></tr><tr><td class="line-number" value="298"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="299"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="300"></td><td class="line-content">            // Add the bus source</td></tr><tr><td class="line-number" value="301"></td><td class="line-content">            map.addSource('bus', {</td></tr><tr><td class="line-number" value="302"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="303"></td><td class="line-content">                'data': busGeoJSON</td></tr><tr><td class="line-number" value="304"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="305"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="306"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="307"></td><td class="line-content">            // Add the arrow layer</td></tr><tr><td class="line-number" value="308"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="309"></td><td class="line-content">                'id': 'route-arrows',</td></tr><tr><td class="line-number" value="310"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="311"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="312"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="313"></td><td class="line-content">                    'symbol-placement': 'line',</td></tr><tr><td class="line-number" value="314"></td><td class="line-content">                    'symbol-spacing': 25,</td></tr><tr><td class="line-number" value="315"></td><td class="line-content">                    'icon-image': 'arrow-icon',</td></tr><tr><td class="line-number" value="316"></td><td class="line-content">                    'icon-size': 0.3,</td></tr><tr><td class="line-number" value="317"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="318"></td><td class="line-content">                    'icon-ignore-placement': true,</td></tr><tr><td class="line-number" value="319"></td><td class="line-content">                    'icon-rotation-alignment': 'map',</td></tr><tr><td class="line-number" value="320"></td><td class="line-content">                    'icon-pitch-alignment': 'map'</td></tr><tr><td class="line-number" value="321"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="322"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="323"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="324"></td><td class="line-content">            // Add the route layer</td></tr><tr><td class="line-number" value="325"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="326"></td><td class="line-content">                'id': 'route',</td></tr><tr><td class="line-number" value="327"></td><td class="line-content">                'type': 'line',</td></tr><tr><td class="line-number" value="328"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="329"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="330"></td><td class="line-content">                    'line-join': 'round',</td></tr><tr><td class="line-number" value="331"></td><td class="line-content">                    'line-cap': 'round'</td></tr><tr><td class="line-number" value="332"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="333"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="334"></td><td class="line-content">                    'line-color': '#ff0000',</td></tr><tr><td class="line-number" value="335"></td><td class="line-content">                    'line-width': 3</td></tr><tr><td class="line-number" value="336"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="337"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="338"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="339"></td><td class="line-content">            // Add the bus stops layer</td></tr><tr><td class="line-number" value="340"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="341"></td><td class="line-content">                'id': 'bus-stops',</td></tr><tr><td class="line-number" value="342"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="343"></td><td class="line-content">                'source': 'bus-stops',</td></tr><tr><td class="line-number" value="344"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="345"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="346"></td><td class="line-content">                    'icon-image': 'bus-stop-icon',</td></tr><tr><td class="line-number" value="347"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="348"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="349"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="350"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="351"></td><td class="line-content">                        10, 0.45,</td></tr><tr><td class="line-number" value="352"></td><td class="line-content">                        13, 0.55,</td></tr><tr><td class="line-number" value="353"></td><td class="line-content">                        16, 0.65</td></tr><tr><td class="line-number" value="354"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="355"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="356"></td><td class="line-content">                    'text-field': ['get', 'name'],</td></tr><tr><td class="line-number" value="357"></td><td class="line-content">                    'text-size': 11.5,</td></tr><tr><td class="line-number" value="358"></td><td class="line-content">                    'text-offset': [0, -1.8],</td></tr><tr><td class="line-number" value="359"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="360"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="361"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold'],</td></tr><tr><td class="line-number" value="362"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="363"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="364"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="365"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="366"></td><td class="line-content">                    'text-color': '#6884D9',</td></tr><tr><td class="line-number" value="367"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="368"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="369"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="370"></td><td class="line-content">            // Add the bus layer</td></tr><tr><td class="line-number" value="371"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="372"></td><td class="line-content">                'id': 'bus',</td></tr><tr><td class="line-number" value="373"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="374"></td><td class="line-content">                'source': 'bus',</td></tr><tr><td class="line-number" value="375"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="376"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="377"></td><td class="line-content">                    'icon-image': 'bus-icon',</td></tr><tr><td class="line-number" value="378"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="379"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="380"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="381"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="382"></td><td class="line-content">                        10, 0.65,</td></tr><tr><td class="line-number" value="383"></td><td class="line-content">                        13, 0.75,</td></tr><tr><td class="line-number" value="384"></td><td class="line-content">                        16, 0.85</td></tr><tr><td class="line-number" value="385"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="386"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="387"></td><td class="line-content">                    'text-field': ['get', 'busId'],</td></tr><tr><td class="line-number" value="388"></td><td class="line-content">                    'text-size': 12,</td></tr><tr><td class="line-number" value="389"></td><td class="line-content">                    'text-offset': [0, -2.1],</td></tr><tr><td class="line-number" value="390"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="391"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="392"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold']</td></tr><tr><td class="line-number" value="393"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="394"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="395"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="396"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="397"></td><td class="line-content">                    'text-color': '#ff3c00'</td></tr><tr><td class="line-number" value="398"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="399"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="400"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="401"></td><td class="line-content">            // Add popup on click for buses</td></tr><tr><td class="line-number" value="402"></td><td class="line-content">            map.on('click', 'bus', (e) =&gt; {</td></tr><tr><td class="line-number" value="403"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="404"></td><td class="line-content">                const busId = e.features[0].properties.busId;</td></tr><tr><td class="line-number" value="405"></td><td class="line-content">                const lastUpdate = new Date(e.features[0].properties.lastUpdate).toLocaleString();</td></tr><tr><td class="line-number" value="406"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="407"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="408"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="409"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="410"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="411"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="412"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="413"></td><td class="line-content">                        &lt;p class="bus-stop-name"&gt;Bus ${busId}&lt;/p&gt;</td></tr><tr><td class="line-number" value="414"></td><td class="line-content">                        &lt;p style="margin: 5px 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdate}&lt;/p&gt;</td></tr><tr><td class="line-number" value="415"></td><td class="line-content">                    `)</td></tr><tr><td class="line-number" value="416"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="417"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="418"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="419"></td><td class="line-content">            // Change cursor on hover for buses</td></tr><tr><td class="line-number" value="420"></td><td class="line-content">            map.on('mouseenter', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="421"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="422"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="423"></td><td class="line-content">            map.on('mouseleave', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="424"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="425"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="426"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="427"></td><td class="line-content">            // Add popup on click for bus stops</td></tr><tr><td class="line-number" value="428"></td><td class="line-content">            map.on('click', 'bus-stops', (e) =&gt; {</td></tr><tr><td class="line-number" value="429"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="430"></td><td class="line-content">                const name = e.features[0].properties.name;</td></tr><tr><td class="line-number" value="431"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="432"></td><td class="line-content">                new mapboxgl.Popup()</td></tr><tr><td class="line-number" value="433"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="434"></td><td class="line-content">                    .setHTML(`&lt;p class="bus-stop-name"&gt;${name}&lt;/p&gt;`)</td></tr><tr><td class="line-number" value="435"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="436"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="437"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="438"></td><td class="line-content">            // Change cursor on hover for bus stops</td></tr><tr><td class="line-number" value="439"></td><td class="line-content">            map.on('mouseenter', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="440"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="441"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="442"></td><td class="line-content">            map.on('mouseleave', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="443"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="444"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="445"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="446"></td><td class="line-content">            // Get the bounds of all features</td></tr><tr><td class="line-number" value="447"></td><td class="line-content">            const coordinates = geojson.features[0].geometry.coordinates;</td></tr><tr><td class="line-number" value="448"></td><td class="line-content">            const bounds = coordinates.reduce((bounds, coord) =&gt; {</td></tr><tr><td class="line-number" value="449"></td><td class="line-content">                return bounds.extend(coord);</td></tr><tr><td class="line-number" value="450"></td><td class="line-content">            }, new mapboxgl.LngLatBounds(coordinates[0], coordinates[0]));</td></tr><tr><td class="line-number" value="451"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="452"></td><td class="line-content">            // Extend bounds to include POIs</td></tr><tr><td class="line-number" value="453"></td><td class="line-content">            pois.forEach(poi =&gt; {</td></tr><tr><td class="line-number" value="454"></td><td class="line-content">                bounds.extend([parseFloat(poi.lng), parseFloat(poi.lat)]);</td></tr><tr><td class="line-number" value="455"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="456"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="457"></td><td class="line-content">            // Fit the map to the route with padding</td></tr><tr><td class="line-number" value="458"></td><td class="line-content">            map.fitBounds(bounds, {</td></tr><tr><td class="line-number" value="459"></td><td class="line-content">                padding: 50,</td></tr><tr><td class="line-number" value="460"></td><td class="line-content">                duration: 1000</td></tr><tr><td class="line-number" value="461"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="462"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="463"></td><td class="line-content">        }).catch(error =&gt; console.error('Error loading images:', error));</td></tr><tr><td class="line-number" value="464"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="465"></td><td class="line-content">        updateBusLocation();</td></tr><tr><td class="line-number" value="466"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="467"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="468"></td><td class="line-content">    // Function to fetch and update bus location</td></tr><tr><td class="line-number" value="469"></td><td class="line-content">    function updateBusLocation() {</td></tr><tr><td class="line-number" value="470"></td><td class="line-content">        $.ajax({</td></tr><tr><td class="line-number" value="471"></td><td class="line-content">            url: `https://live.paj.com.my/get/P314`,</td></tr><tr><td class="line-number" value="472"></td><td class="line-content">            method: 'get',</td></tr><tr><td class="line-number" value="473"></td><td class="line-content">            cache: false,</td></tr><tr><td class="line-number" value="474"></td><td class="line-content">            dataType: "json",</td></tr><tr><td class="line-number" value="475"></td><td class="line-content">            success: function(result) {</td></tr><tr><td class="line-number" value="476"></td><td class="line-content">                if (result.success) {</td></tr><tr><td class="line-number" value="477"></td><td class="line-content">                    let arrayData = Object.values(result.data);</td></tr><tr><td class="line-number" value="478"></td><td class="line-content">                    // Update bus positions in GeoJSON</td></tr><tr><td class="line-number" value="479"></td><td class="line-content">                    const newBusGeoJSON = {</td></tr><tr><td class="line-number" value="480"></td><td class="line-content">                        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="481"></td><td class="line-content">                        features: arrayData.map(bus =&gt; ({</td></tr><tr><td class="line-number" value="482"></td><td class="line-content">                            type: 'Feature',</td></tr><tr><td class="line-number" value="483"></td><td class="line-content">                            geometry: {</td></tr><tr><td class="line-number" value="484"></td><td class="line-content">                                type: 'Point',</td></tr><tr><td class="line-number" value="485"></td><td class="line-content">                                coordinates: [bus.lng, bus.lat]</td></tr><tr><td class="line-number" value="486"></td><td class="line-content">                            },</td></tr><tr><td class="line-number" value="487"></td><td class="line-content">                            properties: {</td></tr><tr><td class="line-number" value="488"></td><td class="line-content">                                busId: bus.bus,</td></tr><tr><td class="line-number" value="489"></td><td class="line-content">                                title: `Bus ${bus.bus}`,</td></tr><tr><td class="line-number" value="490"></td><td class="line-content">                                lastUpdate: bus.time</td></tr><tr><td class="line-number" value="491"></td><td class="line-content">                            }</td></tr><tr><td class="line-number" value="492"></td><td class="line-content">                        }))</td></tr><tr><td class="line-number" value="493"></td><td class="line-content">                    };</td></tr><tr><td class="line-number" value="494"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="495"></td><td class="line-content">                    try {</td></tr><tr><td class="line-number" value="496"></td><td class="line-content">                        map.getSource('bus').setData(newBusGeoJSON);</td></tr><tr><td class="line-number" value="497"></td><td class="line-content">                        // Update the sliding cards</td></tr><tr><td class="line-number" value="498"></td><td class="line-content">                        updateBusCards(arrayData);</td></tr><tr><td class="line-number" value="499"></td><td class="line-content">                    } catch (e) {</td></tr><tr><td class="line-number" value="500"></td><td class="line-content">                        // console.error('Error updating map:', e);</td></tr><tr><td class="line-number" value="501"></td><td class="line-content">                    }</td></tr><tr><td class="line-number" value="502"></td><td class="line-content">                } else {</td></tr><tr><td class="line-number" value="503"></td><td class="line-content">                    // console.log('Error:', result.message);</td></tr><tr><td class="line-number" value="504"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="505"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="506"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="507"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="508"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="509"></td><td class="line-content">    // Function to update bus cards</td></tr><tr><td class="line-number" value="510"></td><td class="line-content">    function updateBusCards(busData) {</td></tr><tr><td class="line-number" value="511"></td><td class="line-content">        const busCardsContainer = document.getElementById('busCards');</td></tr><tr><td class="line-number" value="512"></td><td class="line-content">        busCardsContainer.innerHTML = ''; // Clear existing cards</td></tr><tr><td class="line-number" value="513"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="514"></td><td class="line-content">        if (busData.length &lt; 3) {</td></tr><tr><td class="line-number" value="515"></td><td class="line-content">            // Center the container for a single bus</td></tr><tr><td class="line-number" value="516"></td><td class="line-content">            busCardsContainer.style.display = 'flex';</td></tr><tr><td class="line-number" value="517"></td><td class="line-content">            busCardsContainer.style.justifyContent = 'center';</td></tr><tr><td class="line-number" value="518"></td><td class="line-content">        } else {</td></tr><tr><td class="line-number" value="519"></td><td class="line-content">            // Restore default styles for multiple buses</td></tr><tr><td class="line-number" value="520"></td><td class="line-content">            busCardsContainer.style.display = 'block';</td></tr><tr><td class="line-number" value="521"></td><td class="line-content">            busCardsContainer.style.justifyContent = ''; // Clear the justifyContent</td></tr><tr><td class="line-number" value="522"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="523"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="524"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="525"></td><td class="line-content">        busData.forEach(bus =&gt; {</td></tr><tr><td class="line-number" value="526"></td><td class="line-content">            const card = document.createElement('div');</td></tr><tr><td class="line-number" value="527"></td><td class="line-content">            card.className = 'bus-card';</td></tr><tr><td class="line-number" value="528"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="529"></td><td class="line-content">            // Check if the last update is within the last 30 minutes</td></tr><tr><td class="line-number" value="530"></td><td class="line-content">            const lastUpdateTime = new Date(bus.time);</td></tr><tr><td class="line-number" value="531"></td><td class="line-content">            // const timeDifferenceInMinutes = (currentTime - lastUpdateTime) / (1000 * 60);</td></tr><tr><td class="line-number" value="532"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="533"></td><td class="line-content">            // if (timeDifferenceInMinutes &lt;= 30) {</td></tr><tr><td class="line-number" value="534"></td><td class="line-content">            //     card.style.background = 'rgb(20,192,80)'; // Light green background</td></tr><tr><td class="line-number" value="535"></td><td class="line-content">            // }</td></tr><tr><td class="line-number" value="536"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="537"></td><td class="line-content">            card.onclick = () =&gt; {</td></tr><tr><td class="line-number" value="538"></td><td class="line-content">                // Remove active class from all cards</td></tr><tr><td class="line-number" value="539"></td><td class="line-content">                document.querySelectorAll('.bus-card').forEach(c =&gt; c.classList.remove('active'));</td></tr><tr><td class="line-number" value="540"></td><td class="line-content">                // Add active class to clicked card</td></tr><tr><td class="line-number" value="541"></td><td class="line-content">                card.classList.add('active');</td></tr><tr><td class="line-number" value="542"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="543"></td><td class="line-content">                // Fly to bus location</td></tr><tr><td class="line-number" value="544"></td><td class="line-content">                map.flyTo({</td></tr><tr><td class="line-number" value="545"></td><td class="line-content">                    center: [bus.lng, bus.lat],</td></tr><tr><td class="line-number" value="546"></td><td class="line-content">                    zoom: 15,</td></tr><tr><td class="line-number" value="547"></td><td class="line-content">                    duration: 1000</td></tr><tr><td class="line-number" value="548"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="549"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="550"></td><td class="line-content">                // Show popup for the bus</td></tr><tr><td class="line-number" value="551"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="552"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="553"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="554"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="555"></td><td class="line-content">                    .setLngLat([bus.lng, bus.lat])</td></tr><tr><td class="line-number" value="556"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="557"></td><td class="line-content">                    &lt;p class="bus-stop-name"&gt;Bus ${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="558"></td><td class="line-content">                    &lt;p style="margin: 0 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdateTime.toLocaleString()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="559"></td><td class="line-content">                `)</td></tr><tr><td class="line-number" value="560"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="561"></td><td class="line-content">            };</td></tr><tr><td class="line-number" value="562"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="563"></td><td class="line-content">            let time = new Date(bus.time);</td></tr><tr><td class="line-number" value="564"></td><td class="line-content">            let now = new Date();</td></tr><tr><td class="line-number" value="565"></td><td class="line-content">            let timeDifference = (now - time) / (1000 * 60); // Difference in minutes</td></tr><tr><td class="line-number" value="566"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="567"></td><td class="line-content">            let onlineStat = '';</td></tr><tr><td class="line-number" value="568"></td><td class="line-content">            // Apply green background if less than 30 minutes</td></tr><tr><td class="line-number" value="569"></td><td class="line-content">            if (timeDifference &lt; 30) {</td></tr><tr><td class="line-number" value="570"></td><td class="line-content">                // add a class to the card</td></tr><tr><td class="line-number" value="571"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream mt-1 fs-2 online" style="color: #0fa354 !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="572"></td><td class="line-content">                card.classList.add('online');</td></tr><tr><td class="line-number" value="573"></td><td class="line-content">                card.classList.remove('offline');</td></tr><tr><td class="line-number" value="574"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="575"></td><td class="line-content">            else {</td></tr><tr><td class="line-number" value="576"></td><td class="line-content">                // remove the class</td></tr><tr><td class="line-number" value="577"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream-slash mt-1 fs-2 offline" style="color: #ff274f !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="578"></td><td class="line-content">                card.classList.remove('online');</td></tr><tr><td class="line-number" value="579"></td><td class="line-content">                card.classList.add('offline');</td></tr><tr><td class="line-number" value="580"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="581"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="582"></td><td class="line-content">            // Format time as dd/mm/yyyy hh:mm:ss AM/PM</td></tr><tr><td class="line-number" value="583"></td><td class="line-content">            let timeString = time.toLocaleString('en-GB', {hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true});</td></tr><tr><td class="line-number" value="584"></td><td class="line-content">            card.innerHTML = `</td></tr><tr><td class="line-number" value="585"></td><td class="line-content">                &lt;div class="d-flex justify-content-between"&gt;</td></tr><tr><td class="line-number" value="586"></td><td class="line-content">                    &lt;div class="d-flex"&gt;</td></tr><tr><td class="line-number" value="587"></td><td class="line-content">                        &lt;div class="legend-icon me-1" style="background-image: url(https://live.paj.com.my/assets/bus-marker.png)"&gt;&lt;/div&gt;</td></tr><tr><td class="line-number" value="588"></td><td class="line-content">                        &lt;p class="bus-id mb-0 fs-4 fw-bold"&gt;${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="589"></td><td class="line-content">                    &lt;/div&gt;</td></tr><tr><td class="line-number" value="590"></td><td class="line-content">                    ${onlineStat}</td></tr><tr><td class="line-number" value="591"></td><td class="line-content">                &lt;/div&gt;</td></tr><tr><td class="line-number" value="592"></td><td class="line-content">                &lt;p class="last-update fs-7 fw-bold"&gt;&lt;i class="fa-solid fa-clock ms-1 me-2 text-primary"&gt;&lt;/i&gt;${timeString.toUpperCase()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="593"></td><td class="line-content">            `;</td></tr><tr><td class="line-number" value="594"></td><td class="line-content">            busCardsContainer.appendChild(card);</td></tr><tr><td class="line-number" value="595"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="596"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="597"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="598"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="599"></td><td class="line-content">    // interval to update bus location</td></tr><tr><td class="line-number" value="600"></td><td class="line-content">    setInterval(updateBusLocation, 10000);</td></tr><tr><td class="line-number" value="601"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="602"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="603"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span></td></tr><tr><td class="line-number" value="604"></td><td class="line-content"><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>