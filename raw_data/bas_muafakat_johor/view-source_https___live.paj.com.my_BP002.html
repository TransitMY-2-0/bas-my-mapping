
<!-- saved from url=(0029)https://live.paj.com.my/BP002 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="color-scheme" content="light dark"></head><body><div class="line-gutter-backdrop"></div><form autocomplete="off"><label class="line-wrap-control">Line wrap<input type="checkbox" aria-label="Line wrap"></label></form><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content">    <span class="html-tag">&lt;title&gt;</span>Jejak Kedudukan Bas Muafakat Johor<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">UTF-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">viewport</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">width=device-width, initial-scale=1.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">description</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Jejak Kedudukan Bas Muafakat Johor</span>"/&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">shortcut icon</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-paj.png" rel="noreferrer noopener">/assets/logo-paj.png</a>"/&gt;</span></td></tr><tr><td class="line-number" value="9"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="10"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/plugins/global/plugins.bundle.css" rel="noreferrer noopener">/assets/plugins/global/plugins.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/css/style.bundle.css" rel="noreferrer noopener">/assets/css/style.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="12"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css" rel="noreferrer noopener">https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">    <span class="html-tag">&lt;style&gt;</span></td></tr><tr><td class="line-number" value="14"></td><td class="line-content">        body {</td></tr><tr><td class="line-number" value="15"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="16"></td><td class="line-content">            padding: 0;</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">        #map {</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">            top: 0;</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">            bottom: 0;</td></tr><tr><td class="line-number" value="22"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="23"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="24"></td><td class="line-content">        .legend-card {</td></tr><tr><td class="line-number" value="25"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">            top: 10px;</td></tr><tr><td class="line-number" value="27"></td><td class="line-content">            right: 10px;</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">            background: white;</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">            padding-top: 3px;</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">            box-shadow: 0 2px 4px rgba(0,0,0,0.1);</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">            z-index: 1;</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">            max-width: 200px;</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">        .legend-title {</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">            font-weight: 600;</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">            margin: 0 0 10px 0;</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="42"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="43"></td><td class="line-content">        .legend-item {</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">            display: flex;</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">            align-items: center;</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">            margin-bottom: 8px;</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">        .legend-item:last-child {</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">            margin-bottom: 0;</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="51"></td><td class="line-content">        .legend-icon {</td></tr><tr><td class="line-number" value="52"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">            height: 20px;</td></tr><tr><td class="line-number" value="54"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="55"></td><td class="line-content">            background-size: contain;</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">            background-repeat: no-repeat;</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">            background-position: center;</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="59"></td><td class="line-content">        .legend-text {</td></tr><tr><td class="line-number" value="60"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">        .legend-route {</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">            background-color: #ff0000;</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">            height: 3px;</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="68"></td><td class="line-content">            border-radius: 2px;</td></tr><tr><td class="line-number" value="69"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">        .mapboxgl-popup-content {</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="73"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="74"></td><td class="line-content">        .bus-stop-name {</td></tr><tr><td class="line-number" value="75"></td><td class="line-content">            font-weight: bold;</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="77"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="78"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="80"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="81"></td><td class="line-content">        /* New styles for the sliding cards */</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">        .bus-cards-container {</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">            position: fixed;</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">            bottom: 30px;</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">            left: 50%;</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">            transform: translateX(-50%);</td></tr><tr><td class="line-number" value="87"></td><td class="line-content">            /*height: 50px;*/</td></tr><tr><td class="line-number" value="88"></td><td class="line-content">            background: transparent;</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">            overflow-x: auto;</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">            white-space: nowrap;</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">            padding-top: 10px;</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">            padding-bottom: 10px;</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">            padding-left: 10px;</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">            /*padding-bottom: 10px;*/</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">            scrollbar-width: none; /* Firefox */</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">            -ms-overflow-style: none; /* IE and Edge */</td></tr><tr><td class="line-number" value="97"></td><td class="line-content">            z-index: 1000;</td></tr><tr><td class="line-number" value="98"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">            max-width: 1200px;</td></tr><tr><td class="line-number" value="100"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="101"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="102"></td><td class="line-content">        /*.bus-cards-container::-webkit-scrollbar {*/</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">        /*    display: none; !* Chrome, Safari, Opera *!*/</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="105"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="106"></td><td class="line-content">        .bus-card {</td></tr><tr><td class="line-number" value="107"></td><td class="line-content">            display: inline-block;</td></tr><tr><td class="line-number" value="108"></td><td class="line-content">            width: 160px;</td></tr><tr><td class="line-number" value="109"></td><td class="line-content">            height: 60px;</td></tr><tr><td class="line-number" value="110"></td><td class="line-content">            margin-right: 10px;</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">            background: rgba(255, 255, 255, 0.9);</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">            padding: 10px;</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">            vertical-align: top;</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">            cursor: pointer;</td></tr><tr><td class="line-number" value="117"></td><td class="line-content">            transition: all 0.2s ease;</td></tr><tr><td class="line-number" value="118"></td><td class="line-content">            backdrop-filter: blur(5px);</td></tr><tr><td class="line-number" value="119"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; /* Add this line */</td></tr><tr><td class="line-number" value="120"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="121"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="122"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="123"></td><td class="line-content">        .bus-card:hover {</td></tr><tr><td class="line-number" value="124"></td><td class="line-content">            transform: translateY(-2px);</td></tr><tr><td class="line-number" value="125"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="126"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="127"></td><td class="line-content">        .bus-card.active {</td></tr><tr><td class="line-number" value="128"></td><td class="line-content">            background: #e3f2fd;</td></tr><tr><td class="line-number" value="129"></td><td class="line-content">            border: 2px solid #2196f3;</td></tr><tr><td class="line-number" value="130"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="131"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="132"></td><td class="line-content">        .bus-id {</td></tr><tr><td class="line-number" value="133"></td><td class="line-content">            /*font-weight: bold;*/</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">            /*font-size: 16px;*/</td></tr><tr><td class="line-number" value="135"></td><td class="line-content">            color: #434343;</td></tr><tr><td class="line-number" value="136"></td><td class="line-content">            margin: 0 0 5px 0;</td></tr><tr><td class="line-number" value="137"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="138"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="139"></td><td class="line-content">        .last-update {</td></tr><tr><td class="line-number" value="140"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="141"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="142"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="143"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="144"></td><td class="line-content">        .online {</td></tr><tr><td class="line-number" value="145"></td><td class="line-content">            /*background: #0fa354;*/</td></tr><tr><td class="line-number" value="146"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="147"></td><td class="line-content">        .offline {</td></tr><tr><td class="line-number" value="148"></td><td class="line-content">            background: #dadada;</td></tr><tr><td class="line-number" value="149"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="150"></td><td class="line-content">        /*.logo-container img {*/</td></tr><tr><td class="line-number" value="151"></td><td class="line-content">        /*    height: 40px;*/</td></tr><tr><td class="line-number" value="152"></td><td class="line-content">        /*    width: auto;*/</td></tr><tr><td class="line-number" value="153"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="154"></td><td class="line-content"> .back-btn{</td></tr><tr><td class="line-number" value="155"></td><td class="line-content">      display:inline-flex;</td></tr><tr><td class="line-number" value="156"></td><td class="line-content">      align-items:center;</td></tr><tr><td class="line-number" value="157"></td><td class="line-content">      gap:8px;</td></tr><tr><td class="line-number" value="158"></td><td class="line-content">      margin-top:10px;</td></tr><tr><td class="line-number" value="159"></td><td class="line-content">      padding:8px 12px;</td></tr><tr><td class="line-number" value="160"></td><td class="line-content">      border-radius:8px;</td></tr><tr><td class="line-number" value="161"></td><td class="line-content">      border:1px solid rgba(0,0,0,.08);</td></tr><tr><td class="line-number" value="162"></td><td class="line-content">      background:#f4f6f8;</td></tr><tr><td class="line-number" value="163"></td><td class="line-content">      font-size:12px;</td></tr><tr><td class="line-number" value="164"></td><td class="line-content">      font-weight:600;</td></tr><tr><td class="line-number" value="165"></td><td class="line-content">      color:#2b2e34;</td></tr><tr><td class="line-number" value="166"></td><td class="line-content">      text-decoration:none;</td></tr><tr><td class="line-number" value="167"></td><td class="line-content">      box-shadow:0 1px 2px rgba(0,0,0,.06);</td></tr><tr><td class="line-number" value="168"></td><td class="line-content">      transition:transform .12s ease, background .12s ease;</td></tr><tr><td class="line-number" value="169"></td><td class="line-content">  }</td></tr><tr><td class="line-number" value="170"></td><td class="line-content">  .back-btn:hover{ background:#e9ecef; transform:translateY(-1px); }</td></tr><tr><td class="line-number" value="171"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="172"></td><td class="line-content">  .legend-card{ z-index: 2001!important; } /* pastikan atas Mapbox controls */</td></tr><tr><td class="line-number" value="173"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="174"></td><td class="line-content">  .legend-nav {</td></tr><tr><td class="line-number" value="175"></td><td class="line-content">    display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;</td></tr><tr><td class="line-number" value="176"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="177"></td><td class="line-content">.legend-btn {</td></tr><tr><td class="line-number" value="178"></td><td class="line-content">    display:inline-flex; align-items:center; gap:6px;</td></tr><tr><td class="line-number" value="179"></td><td class="line-content">    background:#f4f6f8; border:1px solid #e2e8f0; border-radius:8px;</td></tr><tr><td class="line-number" value="180"></td><td class="line-content">    padding:8px 10px; font-size:12px; color:#333; text-decoration:none;</td></tr><tr><td class="line-number" value="181"></td><td class="line-content">    box-shadow:0 1px 2px rgba(0,0,0,.05);</td></tr><tr><td class="line-number" value="182"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="183"></td><td class="line-content">.legend-btn:hover { background:#eef2f6; }</td></tr><tr><td class="line-number" value="184"></td><td class="line-content">.legend-btn .kecil { opacity:.7; font-weight:600; }</td></tr><tr><td class="line-number" value="185"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="186"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="187"></td><td class="line-content">    <span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="188"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="189"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://unpkg.com/@turf/turf@6.5.0/turf.min.js" rel="noreferrer noopener">https://unpkg.com/@turf/turf@6.5.0/turf.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="190"></td><td class="line-content"><span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="191"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><span class="html-tag">&lt;body&gt;</span></td></tr><tr><td class="line-number" value="193"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">map</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="194"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bus-cards-container</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">busCards</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="195"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-card text-center</span>"&gt;</span></td></tr><tr><td class="line-number" value="196"></td><td class="line-content">    <span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-main.png" rel="noreferrer noopener">https://live.paj.com.my/assets/logo-main.png</a>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">logo-container mt-2</span>" <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">Logo</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width: 70px; height: auto;</span>"&gt;</span></td></tr><tr><td class="line-number" value="197"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="198"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="199"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="200"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Bas<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="201"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="202"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="203"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-stop-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="204"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Perhentian<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="205"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="206"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="207"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-route</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="208"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Laluan<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="209"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="210"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="211"></td><td class="line-content">    <span class="html-comment">&lt;!-- NEW: Butang Kembali --&gt;</span></td></tr><tr><td class="line-number" value="212"></td><td class="line-content">    <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">back-btn</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://live.paj.com.my/" rel="noreferrer noopener">https://live.paj.com.my</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">btnBack</span>"&gt;</span></td></tr><tr><td class="line-number" value="213"></td><td class="line-content">        <span class="html-comment">&lt;!-- ikon anak panah kecil (SVG inline supaya tiada dependensi) --&gt;</span></td></tr><tr><td class="line-number" value="214"></td><td class="line-content">        <span class="html-tag">&lt;svg <span class="html-attribute-name">width</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">viewBox</span>="<span class="html-attribute-value">0 0 24 24</span>" <span class="html-attribute-name">fill</span>="<span class="html-attribute-value">none</span>" <span class="html-attribute-name">aria-hidden</span>="<span class="html-attribute-value">true</span>"&gt;</span></td></tr><tr><td class="line-number" value="215"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M10 19l-7-7 7-7</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="216"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M3 12h18</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="217"></td><td class="line-content">        <span class="html-tag">&lt;/svg&gt;</span></td></tr><tr><td class="line-number" value="218"></td><td class="line-content">        Kembali</td></tr><tr><td class="line-number" value="219"></td><td class="line-content">    <span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="220"></td><td class="line-content"><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="221"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://code.jquery.com/jquery-3.6.0.min.js" rel="noreferrer noopener">https://code.jquery.com/jquery-3.6.0.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="222"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="223"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="224"></td><td class="line-content">    let geojson = {"name":"BP002","type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"LineString","coordinates":[[102.9265968393374,1.853425917157484],[102.9269161839657,1.853392481133619],[102.9268410401288,1.852715362316504],[102.9267170784615,1.85147170288696],[102.9279267124689,1.851329937176628],[102.928252719811,1.851268637733788],[102.9290988564525,1.850995720204054],[102.9301895019068,1.850662390961122],[102.9316871807855,1.850195827052555],[102.9334256794849,1.849670339221657],[102.9340489418223,1.849508682251138],[102.9344894079295,1.850840528344361],[102.9350981708774,1.8528429700575],[102.9356715134946,1.854700304419745],[102.9362448924372,1.856476605727097],[102.9364967412238,1.857319232328836],[102.9369548109648,1.857211064252609],[102.9379758275889,1.856898945397632],[102.9392152437557,1.856535210678333],[102.9412918753318,1.855945802223538],[102.9422794364084,1.855679876420478],[102.943122113691,1.855453880309149],[102.9440085745704,1.855195632263075],[102.9448710487296,1.85496479416344],[102.9455828104438,1.854745339246138],[102.9462810603547,1.85457542017387],[102.9464182808712,1.854538549258368],[102.9467149737492,1.854804091145386],[102.9472311578278,1.855617165834977],[102.9476942672803,1.856280966429091],[102.9478466648037,1.856619746802596],[102.94788287739,1.8574008647689],[102.9479307268983,1.857789540418205],[102.948039596984,1.858110179116172],[102.9483260461624,1.858414712472571],[102.9490491675176,1.859034371270208],[102.9500382496102,1.859874369596532],[102.9510468769669,1.86071703547666],[102.9514841897104,1.861166144499466],[102.952082317853,1.86178517081733],[102.9528175527311,1.862402659382132],[102.9532263774117,1.862619725483374],[102.9542274867194,1.862990489684587],[102.9553271835294,1.863090819599455],[102.9562781898707,1.863147464386575],[102.9583883820805,1.863279329121128],[102.960006369082,1.863399995000975],[102.9630428397548,1.863555020078245],[102.9654235876961,1.86378195923124],[102.9666508034261,1.864073959363897],[102.967562204701,1.86442600220706],[102.9690495951505,1.865054735579245],[102.9710164476357,1.8657789885062],[102.9721598477901,1.866276038150085],[102.9736830562868,1.866903769869396],[102.9754860831982,1.867526106145508],[102.9762471473258,1.867849993067051],[102.9765916295945,1.867971362989233],[102.9786086498808,1.86856659401057],[102.9803502287216,1.869039540771512],[102.9815075099437,1.869388022072575],[102.9819254163786,1.869541204779324],[102.9826907548978,1.869744954937906],[102.9834069789382,1.869946142615622],[102.9856457393542,1.870633640174035],[102.9876960151757,1.871222298450157],[102.9885540196417,1.87144976267019],[102.9891515294665,1.871450410550207],[102.9897685203763,1.871286446829278],[102.9911855368746,1.870500217015898],[102.991489182094,1.870186320588019],[102.9922201783074,1.869446177056949],[102.992914612198,1.868893397585422],[102.9936464285753,1.868500731739824],[102.9944763679374,1.868081605997199],[102.9953122870547,1.86767770391308],[102.9957636025656,1.867374919059372],[102.9964130336472,1.866809203650803],[102.9973165498975,1.866037639825908],[102.9986336103425,1.86497299737001],[102.9995156396927,1.86424048322875],[103.0001535867948,1.863713866741913],[103.0008986100418,1.863112828148284],[103.0022389413615,1.862015015644068],[103.0035354423566,1.860941638023639],[103.0041713785838,1.860433923402575],[103.0054299913554,1.859444667015137],[103.0063948838043,1.858710622729133],[103.0075091724725,1.857850349706983],[103.0080486532972,1.857448560468093],[103.0084653767771,1.857196466095907],[103.0090130409156,1.856958362133041],[103.01015755178,1.856488718101091],[103.0108637346593,1.856253183921788],[103.0110238933394,1.856240570724598],[103.0117065678383,1.85614381470437],[103.0133811974041,1.855895603118966],[103.0152902414101,1.855639894042058],[103.0167314019036,1.855395699463563],[103.0180208105914,1.855254083264821],[103.0199239007077,1.854999469523832],[103.0209683610663,1.854882654713152],[103.0223546980657,1.854687170861779],[103.0238330626571,1.854494325077455],[103.0247510378929,1.854374476269926],[103.025384582677,1.854303641260855],[103.0264962484329,1.854144826930944],[103.0278681757704,1.854008464057622],[103.0292311149914,1.853857242269921],[103.0314040318067,1.853522326181718],[103.0328360721357,1.853311530305337],[103.0342863809524,1.853110801508052],[103.0363621584234,1.85283832261762],[103.0387882302052,1.852500230656066],[103.0403461390632,1.852289882356091],[103.0417673801978,1.852163119491159],[103.0432888274049,1.851915629630065],[103.0460254732335,1.851514247033914],[103.0473937735552,1.8514144329265],[103.0485471982524,1.851242399805638],[103.0500330888997,1.851012145530643],[103.0513958557602,1.850793013352688],[103.0527550545251,1.850590296315952],[103.0540909046843,1.850470522790824],[103.0551307525983,1.850338159578275],[103.0567251912774,1.850107323369412],[103.0580619253585,1.849935874417458],[103.0597844145946,1.849692548397487],[103.0612632441839,1.849516883730739],[103.0633683308338,1.849258837343043],[103.0659469371009,1.848935308004796],[103.0672127212249,1.848856770249133],[103.0684039530433,1.848735936634043],[103.0694476211986,1.848515513654226],[103.0704242310501,1.848346085074883],[103.0715386800611,1.848183808694043],[103.072979800341,1.847994794860287],[103.0736537001102,1.848059390441849],[103.0744119294818,1.848215675392927],[103.0756151787297,1.848522673499014],[103.0767724791732,1.84892086674329],[103.0778603650602,1.849388479833516],[103.0787980110699,1.849780421572514],[103.0793730171573,1.849981413941906],[103.0805185910988,1.850264940321062],[103.0817286484949,1.850692694477462],[103.0828474894952,1.851107184595255],[103.084287573353,1.85163451972048],[103.0859222625182,1.852215672154146],[103.0864546446365,1.85242083523719],[103.0865595673009,1.85268475456958],[103.0865114951141,1.852855438666663],[103.0864033568595,1.853316684319473],[103.0860923712502,1.854162009478057],[103.0857372892117,1.855247753466976],[103.0854800603477,1.856013215286516],[103.0852818147077,1.85670176789846],[103.0851805686525,1.857131040274942],[103.085263079802,1.857234841858592],[103.0853374723895,1.857129918637018],[103.0855281699863,1.85654447725496],[103.0857566417963,1.855791886060217],[103.0858695874192,1.855471579620205],[103.0861654190862,1.854512548570512],[103.0865388148799,1.853454969962749],[103.08674740511,1.852873149418519],[103.0867687876264,1.852778256774923],[103.0869916232248,1.852668540270376],[103.0873832623106,1.852747783997534],[103.088511127307,1.853091001608908],[103.0900883971501,1.85359756127496],[103.0912774882529,1.853974803349802],[103.0922374143746,1.854292109434589],[103.0930888267628,1.854588695221367],[103.0940868414,1.854973089123446],[103.0953534858545,1.855549088799991],[103.0965233303072,1.856085885976193],[103.0974588317446,1.856517183357166],[103.0984667187493,1.856933901022441],[103.0990195039552,1.857202042973322],[103.0991854193214,1.857318081922472],[103.0991871818296,1.857328556681378],[103.0991899953094,1.857664612583639],[103.0990668539563,1.85804934498111],[103.0987397541807,1.859033573109687],[103.098506031253,1.859819207461518],[103.0982186671391,1.860682884307435],[103.0979347494613,1.861562092482693],[103.0977846613859,1.862016544366488],[103.0976803967497,1.862364495744209],[103.0980282329326,1.862508162985314],[103.0983002115617,1.862657105036163],[103.0984905089122,1.86278349277132],[103.0986362584676,1.862550277231822],[103.0988358406484,1.862238126616514],[103.0990315327831,1.861972113584164],[103.0991408515063,1.861813040388006],[103.099259251854,1.861726961916403],[103.098830443991,1.861434666506513],[103.0984759976136,1.861199066566133],[103.0983550566435,1.861103706733909],[103.0981849446883,1.860939894949151],[103.0982460988359,1.860684832939019],[103.0984988188637,1.859928168189106],[103.0987144132456,1.859205965552969],[103.0989052188434,1.858652211149945],[103.0990531447056,1.858189362008352],[103.0991686302775,1.857800596922831],[103.0992246552396,1.857643869263365],[103.0992274471225,1.857537947780869],[103.0992319769598,1.857438112018502],[103.0993076188942,1.857345739231275],[103.0998317619031,1.857640461376038],[103.100621012928,1.858145592281486],[103.1011095642212,1.858478081863965],[103.1018429221927,1.858984376919641],[103.1028769894696,1.859687511945313],[103.1040360704967,1.860487157751089],[103.1054059551861,1.861395262688248],[103.1064855359413,1.862121077334605],[103.1073810518387,1.862722226146655],[103.1083451402651,1.863368324408268],[103.1092828722486,1.864015966703441],[103.1099177336212,1.864413257464536],[103.1104775702274,1.864802323201994],[103.1107856813147,1.864982584102245],[103.1111276364453,1.865171253821373],[103.1116147580306,1.865320741399013],[103.1118581380298,1.865419534073796],[103.1118823944232,1.865531307986252],[103.1118492134595,1.865714095281468],[103.1117853272735,1.865835509104316],[103.1114243166834,1.866262377041734],[103.1111512401918,1.866561658530418],[103.1108899743647,1.866867154028614],[103.1108488813828,1.866915809071069],[103.1110838279961,1.867002582471674],[103.1112842919358,1.86706615796612],[103.1114460790222,1.867108771285924],[103.111606040137,1.867168718016966],[103.1116915973661,1.867181344079583],[103.1117186011551,1.867145987287906],[103.111621777421,1.867125299474388],[103.1115058657274,1.867104894256073],[103.1112464326693,1.867020074691431],[103.1110991177517,1.866964092515809],[103.11094754834,1.866895347104651],[103.111159968792,1.866634329117845],[103.1114245011647,1.866309286853855],[103.1116944702934,1.865972932590738],[103.1118499365274,1.865735839601594],[103.1119287178915,1.865585224502093],[103.1119881838998,1.86538879191401],[103.1114311809291,1.865203600486214],[103.1111155564576,1.865076598283266],[103.1107770806431,1.864902495087221],[103.1102878869355,1.864600344392731],[103.1098753939667,1.864329981035128],[103.109386235704,1.864005600322012],[103.1089261000307,1.863678674371386],[103.1083531194306,1.863307568548653],[103.10783907742,1.862962047748628],[103.1072623791895,1.862564498223388],[103.1065960987478,1.862118811168332],[103.1059986584063,1.86171619963458],[103.1052661063736,1.861257117635509],[103.1047381137104,1.86089180070023],[103.1040544424627,1.860428474764583],[103.1033416915404,1.859944524016433],[103.1027499165947,1.85953448267263],[103.1021887143947,1.859141882957982],[103.1015880303188,1.858726716062189],[103.1009716410975,1.858344569421896],[103.1003666577862,1.857915356488907],[103.0996166615699,1.857462592175531],[103.0989173396477,1.857060228849674],[103.0982176185026,1.856761621026912],[103.0972597447087,1.85633166805885],[103.096275259657,1.855887094048141],[103.0952800497769,1.855423012600201],[103.0944274370795,1.855047069609064],[103.0930909400526,1.854501028523704],[103.0919214465511,1.854091012844123],[103.0899782568854,1.853470118831234],[103.0880448301526,1.852828216096724],[103.0867198288102,1.852406723228944],[103.0858119402849,1.85210404894544],[103.0848170033469,1.851756356629153],[103.0839106557867,1.851442962098065],[103.0825819919777,1.850954327583626],[103.0812497808584,1.850464592869428],[103.0802889375705,1.850037621995645],[103.0795161266865,1.849718860733611],[103.0787406683352,1.849397736373777],[103.0779424854563,1.84918257681971],[103.0769572284986,1.848895837096693],[103.0761956196799,1.848628281723167],[103.0752500426864,1.848313640220892],[103.0742586917238,1.848101916076995],[103.0734309236944,1.847941831055334],[103.072938205703,1.8479282162531],[103.0725047005257,1.847963382044369],[103.0718649644899,1.848047301122683],[103.0711101328298,1.84816474278011],[103.0705312176753,1.848243223450382],[103.0699748692581,1.848318671910987],[103.0696383151051,1.848341069181669],[103.0691992753534,1.848373573411975],[103.0686642119195,1.848403158410393],[103.0680081025022,1.848448556948721],[103.0675681790548,1.848516575331355],[103.0670146901596,1.848629776896959],[103.065772389694,1.848876097024797],[103.065465853135,1.848911273194227],[103.0649586947577,1.848985475363894],[103.0638488111872,1.8491326783239],[103.0630289453697,1.849221772511339],[103.0615922924281,1.84941377273962],[103.0599739412765,1.849601051053271],[103.0583750399234,1.849808180386788],[103.0571454066994,1.849962001878397],[103.0549291380885,1.850230092238068],[103.053375163469,1.850452206655438],[103.0521965006531,1.850605148817702],[103.0503792630958,1.850836253555705],[103.0488562203144,1.851022729415262],[103.0478218288211,1.851134388477219],[103.0468095222079,1.851291812428969],[103.0458322661398,1.851464403545811],[103.0448645317524,1.851606510550339],[103.0438423995962,1.85175245295012],[103.0425910367852,1.851924171955395],[103.0413840993521,1.852105067785225],[103.0398756588229,1.852290061415883],[103.0381534722451,1.85249198529908],[103.0367739799556,1.852676502524699],[103.0351848623197,1.852878881435374],[103.0336213204567,1.853103169003252],[103.0323884262554,1.853285498660799],[103.0312112068222,1.853460146626729],[103.0301531922944,1.853627457521099],[103.0289736672532,1.853765494119533],[103.0277484497662,1.853944612962304],[103.0262904968176,1.854099240293569],[103.0249434252279,1.854282802203466],[103.023920834016,1.85436912426088],[103.0226916034328,1.854531949677868],[103.021765350196,1.85465155508447],[103.0206441382806,1.854829429050619],[103.0195526544661,1.85498936140509],[103.0183079722281,1.855143254835238],[103.0170940107391,1.855293541064958],[103.015820397724,1.855461392825926],[103.0137917197438,1.855757754728308],[103.0120415402337,1.856009120448704],[103.0107796380947,1.856198346715414],[103.0103736998555,1.856230985151391],[103.0099926304808,1.856276090819674],[103.0094062361455,1.856424185075528],[103.0089026900731,1.856642956461747],[103.0083005538336,1.856986294098414],[103.0079348130709,1.857355252323131],[103.0076346662234,1.857642100477095],[103.0070135790799,1.858141809822149],[103.0064082031727,1.858590157785028],[103.0051983496958,1.859547853906719],[103.0042805027399,1.860246865508021],[103.0027543608249,1.861435348347375],[103.0012922098723,1.862651143254238],[102.9997990705818,1.863861303627743],[102.9987629873336,1.864722661490043],[102.9970147741783,1.866147462219689],[102.9954162377394,1.867507029075289],[102.9952077318636,1.867652982852032],[102.9941297752114,1.868167373631873],[102.9932441509336,1.868546355345812],[102.9928933557423,1.86878631604435],[102.9922766425126,1.869207003064989],[102.9912659128892,1.870080969256889],[102.9909076121755,1.870360567292324],[102.9906058855238,1.870560929139423],[102.9901635747376,1.870752851423879],[102.9893327358242,1.871029196116692],[102.9884817385766,1.871166541012964],[102.9872694202426,1.871083081870133],[102.9869582006835,1.870963050357404],[102.9860676242191,1.870705976437635],[102.9848793581345,1.870363366872981],[102.9837820335005,1.870031314227099],[102.9827468475233,1.86972164083987],[102.9822684020957,1.869550743733437],[102.9816803978196,1.869371327779242],[102.9811058403271,1.869215653943527],[102.9800915213857,1.868896134982822],[102.9785528112054,1.868451494384545],[102.9773834939609,1.868082750847603],[102.9765308490173,1.86778096900468],[102.9762008667772,1.867665215856549],[102.9757352168954,1.86753264759918],[102.9750241855987,1.867324023250909],[102.9741780460586,1.867004043186401],[102.9732372710312,1.866626423044631],[102.9719991433127,1.866127335175988],[102.9711625513077,1.865783430428571],[102.970112900751,1.865358901244742],[102.9688142564537,1.864881528646569],[102.9682254985299,1.864624819089583],[102.9671615892576,1.864176533780145],[102.966374184033,1.863849215981392],[102.9657227470953,1.863699195976618],[102.964739514396,1.863577074184824],[102.9634904997196,1.863483229277042],[102.9621140508723,1.863422543760748],[102.959901552791,1.863312726903874],[102.9588713165443,1.86325398011653],[102.9579811930839,1.863208232220813],[102.9570035308148,1.863133042601725],[102.9559275573356,1.863061919445427],[102.9549017145948,1.862988663668355],[102.9543699878169,1.862929134831061],[102.953890622299,1.862782587459751],[102.9531853419096,1.862524999052459],[102.9527958701071,1.862289601900962],[102.9520474278284,1.861616704630544],[102.9513141930951,1.86087192378447],[102.9507659826067,1.860350709853188],[102.9499117795414,1.859640111937973],[102.9485831520057,1.85856855568873],[102.948123321415,1.85811475731042],[102.9480049208201,1.857793932729629],[102.9479305256467,1.856990978546698],[102.9478709461012,1.856389173471771],[102.947602193297,1.856013023981753],[102.9471814229266,1.855316984807877],[102.9469186566497,1.855030839269242],[102.9467930041035,1.854839961378788],[102.9466631054748,1.85467231826802],[102.9465079151893,1.854485556526272],[102.9464220455893,1.854420614029048],[102.946150233919,1.854550278319568],[102.9458934299214,1.854631438062614],[102.9455645508794,1.854721768066416],[102.9453802776112,1.854768304959068],[102.9450464558897,1.854862496461669],[102.9445821536176,1.854996740278864],[102.9439974700413,1.855156070328922],[102.9436237711339,1.855283578674365],[102.9431317799575,1.855416652317406],[102.9426688883691,1.855545891884619],[102.9422297655555,1.85566850709858],[102.94141735116,1.855872979277369],[102.9408166858607,1.856047824950689],[102.940300479671,1.856195541420053],[102.939613277932,1.856386414135476],[102.9386676819803,1.856657229129101],[102.9378391884465,1.856872155844584],[102.9373583917116,1.857024382112921],[102.9368325438691,1.85717802401957],[102.9365611238862,1.857246649773155],[102.9361027795346,1.857362462021233],[102.9352670772799,1.85762623755901],[102.9344597293551,1.857891419634367],[102.9336806268455,1.858136069516229],[102.9331578584131,1.858308091254183],[102.9321061212789,1.858609487477034],[102.9312557552911,1.858839987403088],[102.930394976599,1.859037400743969],[102.9293453295071,1.859274687592186],[102.9283666981914,1.859477542191621],[102.9279725117773,1.859517116399224],[102.9274480093061,1.859451218959147],[102.9270246364607,1.859348625438485],[102.9269707215707,1.85886297143166],[102.9268641576439,1.858099447501762],[102.9267296076979,1.857180973206233],[102.9266145935979,1.85633612661762],[102.926443311155,1.855156027396625],[102.9262949309799,1.853892868645091],[102.9262379887609,1.853451181262123],[102.926482267675,1.853425795524644],[102.9265968393374,1.853425917157484]]}}]};</td></tr><tr><td class="line-number" value="225"></td><td class="line-content">    let pois = [{"name":"Terminal Bas Express Batu Pahat","lat":"1.85336979","lng":"102.92666980"},{"name":"MASJID JAMEK SULTAN ISMAIL","lat":"1.85578300","lng":"102.94732600"},{"name":"PANTAI HOSPITAL BATU PAHAT","lat":"1.86001900","lng":"102.95021000"},{"name":"BP MALL","lat":"1.86362800","lng":"102.96312600"},{"name":"JALAN KLUANG","lat":"1.86613300","lng":"102.97177200"},{"name":"PARIT HAJI MOHAMAD NOR","lat":"1.86867500","lng":"102.97873300"},{"name":"COWBOY BATU PAHAT","lat":"1.87040500","lng":"102.98447500"},{"name":"TAMAN MUTIARA","lat":"1.86060600","lng":"103.00413400"},{"name":"PARIT SENGKUANG","lat":"1.85504500","lng":"103.02024700"},{"name":"SRI GADING","lat":"1.85389400","lng":"103.02937600"},{"name":"SMK SRI GADING","lat":"1.85093900","lng":"103.05129200"},{"name":"Taman Universiti Batu Pahat","lat":"1.84814100","lng":"103.07251500"},{"name":"KKTM SRI GADING","lat":"1.85019000","lng":"103.07996400"},{"name":"UTHM","lat":"1.85313300","lng":"103.08831300"},{"name":"PETRON PARIT RAJA","lat":"1.86404700","lng":"103.10918600"},{"name":"KOMPLEKS NIAGA PARIT RAJA","lat":"1.86649800","lng":"103.11163800"},{"name":"KLINIK KESIHATAN PARIT RAJA","lat":"1.86379800","lng":"103.10928100"},{"name":"PARIT SEMPADAN","lat":"1.85678800","lng":"103.09866000"},{"name":"FUJITSU","lat":"1.85442100","lng":"103.09327000"},{"name":"OPPOSITE UTHM","lat":"1.85239500","lng":"103.08727900"},{"name":"PARIT JELUTONG","lat":"1.85114700","lng":"103.08361300"},{"name":"OPPOSITE SMK SRI GADING","lat":"1.85054500","lng":"103.05084700"},{"name":"PARIT BUDIN","lat":"1.85173800","lng":"103.04283000"},{"name":"IPG TUN HUSSEIN ONN","lat":"1.87039000","lng":"102.98529500"},{"name":"OPPOSITE BP MALL","lat":"1.86337700","lng":"102.96327100"},{"name":"THE SUMMIT BATU PAHAT","lat":"1.85773800","lng":"102.93481400"},{"name":"Terminal Bas Express Batu Pahat","lat":"1.85336979","lng":"102.92666980"}];</td></tr><tr><td class="line-number" value="226"></td><td class="line-content">    let imageBusStop = 'https://live.paj.com.my/assets/bus-stop-marker.png';</td></tr><tr><td class="line-number" value="227"></td><td class="line-content">    let imageArrows = 'https://live.paj.com.my/assets/arrow-markers-red.png';</td></tr><tr><td class="line-number" value="228"></td><td class="line-content">    let imageBus = 'https://live.paj.com.my/assets/bus-marker.png';</td></tr><tr><td class="line-number" value="229"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="230"></td><td class="line-content">    // Convert POIs to GeoJSON format</td></tr><tr><td class="line-number" value="231"></td><td class="line-content">    const poisGeoJSON = {</td></tr><tr><td class="line-number" value="232"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="233"></td><td class="line-content">        features: pois.map(poi =&gt; ({</td></tr><tr><td class="line-number" value="234"></td><td class="line-content">            type: 'Feature',</td></tr><tr><td class="line-number" value="235"></td><td class="line-content">            geometry: {</td></tr><tr><td class="line-number" value="236"></td><td class="line-content">                type: 'Point',</td></tr><tr><td class="line-number" value="237"></td><td class="line-content">                coordinates: [parseFloat(poi.lng), parseFloat(poi.lat)]</td></tr><tr><td class="line-number" value="238"></td><td class="line-content">            },</td></tr><tr><td class="line-number" value="239"></td><td class="line-content">            properties: {</td></tr><tr><td class="line-number" value="240"></td><td class="line-content">                name: poi.name</td></tr><tr><td class="line-number" value="241"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="242"></td><td class="line-content">        }))</td></tr><tr><td class="line-number" value="243"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="244"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="245"></td><td class="line-content">    // Create initial bus GeoJSON with empty features</td></tr><tr><td class="line-number" value="246"></td><td class="line-content">    const busGeoJSON = {</td></tr><tr><td class="line-number" value="247"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="248"></td><td class="line-content">        features: []</td></tr><tr><td class="line-number" value="249"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="250"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="251"></td><td class="line-content">    mapboxgl.accessToken = 'pk.eyJ1IjoiYWxpZmRhcnNpbSIsImEiOiJjbTRjZ3djcmIwNTMxMmlxcGZvZWx1eTFqIn0.X3VV1PhXekp3_HAwoB6kbw';</td></tr><tr><td class="line-number" value="252"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="253"></td><td class="line-content">    // Initialize map with default center</td></tr><tr><td class="line-number" value="254"></td><td class="line-content">    const map = new mapboxgl.Map({</td></tr><tr><td class="line-number" value="255"></td><td class="line-content">        container: 'map',</td></tr><tr><td class="line-number" value="256"></td><td class="line-content">        style: 'mapbox://styles/mapbox/streets-v12',</td></tr><tr><td class="line-number" value="257"></td><td class="line-content">        center: [103.317818, 2.029433],</td></tr><tr><td class="line-number" value="258"></td><td class="line-content">        zoom: 8</td></tr><tr><td class="line-number" value="259"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="260"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="261"></td><td class="line-content">    // Wait for map to load before adding layers</td></tr><tr><td class="line-number" value="262"></td><td class="line-content">    map.on('load', () =&gt; {</td></tr><tr><td class="line-number" value="263"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="264"></td><td class="line-content">        // Load both bus stop and bus icons</td></tr><tr><td class="line-number" value="265"></td><td class="line-content">        Promise.all([</td></tr><tr><td class="line-number" value="266"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="267"></td><td class="line-content">                map.loadImage(imageBusStop, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="268"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="269"></td><td class="line-content">                    map.addImage('bus-stop-icon', image);</td></tr><tr><td class="line-number" value="270"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="271"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="272"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="273"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="274"></td><td class="line-content">                map.loadImage(imageBus, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="275"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="276"></td><td class="line-content">                    map.addImage('bus-icon', image);</td></tr><tr><td class="line-number" value="277"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="278"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="279"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="280"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="281"></td><td class="line-content">                map.loadImage(imageArrows, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="282"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="283"></td><td class="line-content">                    map.addImage('arrow-icon', image);</td></tr><tr><td class="line-number" value="284"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="285"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="286"></td><td class="line-content">            })</td></tr><tr><td class="line-number" value="287"></td><td class="line-content">        ]).then(() =&gt; {</td></tr><tr><td class="line-number" value="288"></td><td class="line-content">            // Add the route source</td></tr><tr><td class="line-number" value="289"></td><td class="line-content">            map.addSource('route', {</td></tr><tr><td class="line-number" value="290"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="291"></td><td class="line-content">                'data': geojson</td></tr><tr><td class="line-number" value="292"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="293"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="294"></td><td class="line-content">            // Add the bus stops source</td></tr><tr><td class="line-number" value="295"></td><td class="line-content">            map.addSource('bus-stops', {</td></tr><tr><td class="line-number" value="296"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="297"></td><td class="line-content">                'data': poisGeoJSON</td></tr><tr><td class="line-number" value="298"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="299"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="300"></td><td class="line-content">            // Add the bus source</td></tr><tr><td class="line-number" value="301"></td><td class="line-content">            map.addSource('bus', {</td></tr><tr><td class="line-number" value="302"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="303"></td><td class="line-content">                'data': busGeoJSON</td></tr><tr><td class="line-number" value="304"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="305"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="306"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="307"></td><td class="line-content">            // Add the arrow layer</td></tr><tr><td class="line-number" value="308"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="309"></td><td class="line-content">                'id': 'route-arrows',</td></tr><tr><td class="line-number" value="310"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="311"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="312"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="313"></td><td class="line-content">                    'symbol-placement': 'line',</td></tr><tr><td class="line-number" value="314"></td><td class="line-content">                    'symbol-spacing': 25,</td></tr><tr><td class="line-number" value="315"></td><td class="line-content">                    'icon-image': 'arrow-icon',</td></tr><tr><td class="line-number" value="316"></td><td class="line-content">                    'icon-size': 0.3,</td></tr><tr><td class="line-number" value="317"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="318"></td><td class="line-content">                    'icon-ignore-placement': true,</td></tr><tr><td class="line-number" value="319"></td><td class="line-content">                    'icon-rotation-alignment': 'map',</td></tr><tr><td class="line-number" value="320"></td><td class="line-content">                    'icon-pitch-alignment': 'map'</td></tr><tr><td class="line-number" value="321"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="322"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="323"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="324"></td><td class="line-content">            // Add the route layer</td></tr><tr><td class="line-number" value="325"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="326"></td><td class="line-content">                'id': 'route',</td></tr><tr><td class="line-number" value="327"></td><td class="line-content">                'type': 'line',</td></tr><tr><td class="line-number" value="328"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="329"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="330"></td><td class="line-content">                    'line-join': 'round',</td></tr><tr><td class="line-number" value="331"></td><td class="line-content">                    'line-cap': 'round'</td></tr><tr><td class="line-number" value="332"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="333"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="334"></td><td class="line-content">                    'line-color': '#ff0000',</td></tr><tr><td class="line-number" value="335"></td><td class="line-content">                    'line-width': 3</td></tr><tr><td class="line-number" value="336"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="337"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="338"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="339"></td><td class="line-content">            // Add the bus stops layer</td></tr><tr><td class="line-number" value="340"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="341"></td><td class="line-content">                'id': 'bus-stops',</td></tr><tr><td class="line-number" value="342"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="343"></td><td class="line-content">                'source': 'bus-stops',</td></tr><tr><td class="line-number" value="344"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="345"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="346"></td><td class="line-content">                    'icon-image': 'bus-stop-icon',</td></tr><tr><td class="line-number" value="347"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="348"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="349"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="350"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="351"></td><td class="line-content">                        10, 0.45,</td></tr><tr><td class="line-number" value="352"></td><td class="line-content">                        13, 0.55,</td></tr><tr><td class="line-number" value="353"></td><td class="line-content">                        16, 0.65</td></tr><tr><td class="line-number" value="354"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="355"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="356"></td><td class="line-content">                    'text-field': ['get', 'name'],</td></tr><tr><td class="line-number" value="357"></td><td class="line-content">                    'text-size': 11.5,</td></tr><tr><td class="line-number" value="358"></td><td class="line-content">                    'text-offset': [0, -1.8],</td></tr><tr><td class="line-number" value="359"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="360"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="361"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold'],</td></tr><tr><td class="line-number" value="362"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="363"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="364"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="365"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="366"></td><td class="line-content">                    'text-color': '#6884D9',</td></tr><tr><td class="line-number" value="367"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="368"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="369"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="370"></td><td class="line-content">            // Add the bus layer</td></tr><tr><td class="line-number" value="371"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="372"></td><td class="line-content">                'id': 'bus',</td></tr><tr><td class="line-number" value="373"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="374"></td><td class="line-content">                'source': 'bus',</td></tr><tr><td class="line-number" value="375"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="376"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="377"></td><td class="line-content">                    'icon-image': 'bus-icon',</td></tr><tr><td class="line-number" value="378"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="379"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="380"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="381"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="382"></td><td class="line-content">                        10, 0.65,</td></tr><tr><td class="line-number" value="383"></td><td class="line-content">                        13, 0.75,</td></tr><tr><td class="line-number" value="384"></td><td class="line-content">                        16, 0.85</td></tr><tr><td class="line-number" value="385"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="386"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="387"></td><td class="line-content">                    'text-field': ['get', 'busId'],</td></tr><tr><td class="line-number" value="388"></td><td class="line-content">                    'text-size': 12,</td></tr><tr><td class="line-number" value="389"></td><td class="line-content">                    'text-offset': [0, -2.1],</td></tr><tr><td class="line-number" value="390"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="391"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="392"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold']</td></tr><tr><td class="line-number" value="393"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="394"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="395"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="396"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="397"></td><td class="line-content">                    'text-color': '#ff3c00'</td></tr><tr><td class="line-number" value="398"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="399"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="400"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="401"></td><td class="line-content">            // Add popup on click for buses</td></tr><tr><td class="line-number" value="402"></td><td class="line-content">            map.on('click', 'bus', (e) =&gt; {</td></tr><tr><td class="line-number" value="403"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="404"></td><td class="line-content">                const busId = e.features[0].properties.busId;</td></tr><tr><td class="line-number" value="405"></td><td class="line-content">                const lastUpdate = new Date(e.features[0].properties.lastUpdate).toLocaleString();</td></tr><tr><td class="line-number" value="406"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="407"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="408"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="409"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="410"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="411"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="412"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="413"></td><td class="line-content">                        &lt;p class="bus-stop-name"&gt;Bus ${busId}&lt;/p&gt;</td></tr><tr><td class="line-number" value="414"></td><td class="line-content">                        &lt;p style="margin: 5px 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdate}&lt;/p&gt;</td></tr><tr><td class="line-number" value="415"></td><td class="line-content">                    `)</td></tr><tr><td class="line-number" value="416"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="417"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="418"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="419"></td><td class="line-content">            // Change cursor on hover for buses</td></tr><tr><td class="line-number" value="420"></td><td class="line-content">            map.on('mouseenter', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="421"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="422"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="423"></td><td class="line-content">            map.on('mouseleave', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="424"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="425"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="426"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="427"></td><td class="line-content">            // Add popup on click for bus stops</td></tr><tr><td class="line-number" value="428"></td><td class="line-content">            map.on('click', 'bus-stops', (e) =&gt; {</td></tr><tr><td class="line-number" value="429"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="430"></td><td class="line-content">                const name = e.features[0].properties.name;</td></tr><tr><td class="line-number" value="431"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="432"></td><td class="line-content">                new mapboxgl.Popup()</td></tr><tr><td class="line-number" value="433"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="434"></td><td class="line-content">                    .setHTML(`&lt;p class="bus-stop-name"&gt;${name}&lt;/p&gt;`)</td></tr><tr><td class="line-number" value="435"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="436"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="437"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="438"></td><td class="line-content">            // Change cursor on hover for bus stops</td></tr><tr><td class="line-number" value="439"></td><td class="line-content">            map.on('mouseenter', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="440"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="441"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="442"></td><td class="line-content">            map.on('mouseleave', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="443"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="444"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="445"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="446"></td><td class="line-content">            // Get the bounds of all features</td></tr><tr><td class="line-number" value="447"></td><td class="line-content">            const coordinates = geojson.features[0].geometry.coordinates;</td></tr><tr><td class="line-number" value="448"></td><td class="line-content">            const bounds = coordinates.reduce((bounds, coord) =&gt; {</td></tr><tr><td class="line-number" value="449"></td><td class="line-content">                return bounds.extend(coord);</td></tr><tr><td class="line-number" value="450"></td><td class="line-content">            }, new mapboxgl.LngLatBounds(coordinates[0], coordinates[0]));</td></tr><tr><td class="line-number" value="451"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="452"></td><td class="line-content">            // Extend bounds to include POIs</td></tr><tr><td class="line-number" value="453"></td><td class="line-content">            pois.forEach(poi =&gt; {</td></tr><tr><td class="line-number" value="454"></td><td class="line-content">                bounds.extend([parseFloat(poi.lng), parseFloat(poi.lat)]);</td></tr><tr><td class="line-number" value="455"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="456"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="457"></td><td class="line-content">            // Fit the map to the route with padding</td></tr><tr><td class="line-number" value="458"></td><td class="line-content">            map.fitBounds(bounds, {</td></tr><tr><td class="line-number" value="459"></td><td class="line-content">                padding: 50,</td></tr><tr><td class="line-number" value="460"></td><td class="line-content">                duration: 1000</td></tr><tr><td class="line-number" value="461"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="462"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="463"></td><td class="line-content">        }).catch(error =&gt; console.error('Error loading images:', error));</td></tr><tr><td class="line-number" value="464"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="465"></td><td class="line-content">        updateBusLocation();</td></tr><tr><td class="line-number" value="466"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="467"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="468"></td><td class="line-content">    // Function to fetch and update bus location</td></tr><tr><td class="line-number" value="469"></td><td class="line-content">    function updateBusLocation() {</td></tr><tr><td class="line-number" value="470"></td><td class="line-content">        $.ajax({</td></tr><tr><td class="line-number" value="471"></td><td class="line-content">            url: `https://live.paj.com.my/get/BP002`,</td></tr><tr><td class="line-number" value="472"></td><td class="line-content">            method: 'get',</td></tr><tr><td class="line-number" value="473"></td><td class="line-content">            cache: false,</td></tr><tr><td class="line-number" value="474"></td><td class="line-content">            dataType: "json",</td></tr><tr><td class="line-number" value="475"></td><td class="line-content">            success: function(result) {</td></tr><tr><td class="line-number" value="476"></td><td class="line-content">                if (result.success) {</td></tr><tr><td class="line-number" value="477"></td><td class="line-content">                    let arrayData = Object.values(result.data);</td></tr><tr><td class="line-number" value="478"></td><td class="line-content">                    // Update bus positions in GeoJSON</td></tr><tr><td class="line-number" value="479"></td><td class="line-content">                    const newBusGeoJSON = {</td></tr><tr><td class="line-number" value="480"></td><td class="line-content">                        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="481"></td><td class="line-content">                        features: arrayData.map(bus =&gt; ({</td></tr><tr><td class="line-number" value="482"></td><td class="line-content">                            type: 'Feature',</td></tr><tr><td class="line-number" value="483"></td><td class="line-content">                            geometry: {</td></tr><tr><td class="line-number" value="484"></td><td class="line-content">                                type: 'Point',</td></tr><tr><td class="line-number" value="485"></td><td class="line-content">                                coordinates: [bus.lng, bus.lat]</td></tr><tr><td class="line-number" value="486"></td><td class="line-content">                            },</td></tr><tr><td class="line-number" value="487"></td><td class="line-content">                            properties: {</td></tr><tr><td class="line-number" value="488"></td><td class="line-content">                                busId: bus.bus,</td></tr><tr><td class="line-number" value="489"></td><td class="line-content">                                title: `Bus ${bus.bus}`,</td></tr><tr><td class="line-number" value="490"></td><td class="line-content">                                lastUpdate: bus.time</td></tr><tr><td class="line-number" value="491"></td><td class="line-content">                            }</td></tr><tr><td class="line-number" value="492"></td><td class="line-content">                        }))</td></tr><tr><td class="line-number" value="493"></td><td class="line-content">                    };</td></tr><tr><td class="line-number" value="494"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="495"></td><td class="line-content">                    try {</td></tr><tr><td class="line-number" value="496"></td><td class="line-content">                        map.getSource('bus').setData(newBusGeoJSON);</td></tr><tr><td class="line-number" value="497"></td><td class="line-content">                        // Update the sliding cards</td></tr><tr><td class="line-number" value="498"></td><td class="line-content">                        updateBusCards(arrayData);</td></tr><tr><td class="line-number" value="499"></td><td class="line-content">                    } catch (e) {</td></tr><tr><td class="line-number" value="500"></td><td class="line-content">                        // console.error('Error updating map:', e);</td></tr><tr><td class="line-number" value="501"></td><td class="line-content">                    }</td></tr><tr><td class="line-number" value="502"></td><td class="line-content">                } else {</td></tr><tr><td class="line-number" value="503"></td><td class="line-content">                    // console.log('Error:', result.message);</td></tr><tr><td class="line-number" value="504"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="505"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="506"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="507"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="508"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="509"></td><td class="line-content">    // Function to update bus cards</td></tr><tr><td class="line-number" value="510"></td><td class="line-content">    function updateBusCards(busData) {</td></tr><tr><td class="line-number" value="511"></td><td class="line-content">        const busCardsContainer = document.getElementById('busCards');</td></tr><tr><td class="line-number" value="512"></td><td class="line-content">        busCardsContainer.innerHTML = ''; // Clear existing cards</td></tr><tr><td class="line-number" value="513"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="514"></td><td class="line-content">        if (busData.length &lt; 3) {</td></tr><tr><td class="line-number" value="515"></td><td class="line-content">            // Center the container for a single bus</td></tr><tr><td class="line-number" value="516"></td><td class="line-content">            busCardsContainer.style.display = 'flex';</td></tr><tr><td class="line-number" value="517"></td><td class="line-content">            busCardsContainer.style.justifyContent = 'center';</td></tr><tr><td class="line-number" value="518"></td><td class="line-content">        } else {</td></tr><tr><td class="line-number" value="519"></td><td class="line-content">            // Restore default styles for multiple buses</td></tr><tr><td class="line-number" value="520"></td><td class="line-content">            busCardsContainer.style.display = 'block';</td></tr><tr><td class="line-number" value="521"></td><td class="line-content">            busCardsContainer.style.justifyContent = ''; // Clear the justifyContent</td></tr><tr><td class="line-number" value="522"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="523"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="524"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="525"></td><td class="line-content">        busData.forEach(bus =&gt; {</td></tr><tr><td class="line-number" value="526"></td><td class="line-content">            const card = document.createElement('div');</td></tr><tr><td class="line-number" value="527"></td><td class="line-content">            card.className = 'bus-card';</td></tr><tr><td class="line-number" value="528"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="529"></td><td class="line-content">            // Check if the last update is within the last 30 minutes</td></tr><tr><td class="line-number" value="530"></td><td class="line-content">            const lastUpdateTime = new Date(bus.time);</td></tr><tr><td class="line-number" value="531"></td><td class="line-content">            // const timeDifferenceInMinutes = (currentTime - lastUpdateTime) / (1000 * 60);</td></tr><tr><td class="line-number" value="532"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="533"></td><td class="line-content">            // if (timeDifferenceInMinutes &lt;= 30) {</td></tr><tr><td class="line-number" value="534"></td><td class="line-content">            //     card.style.background = 'rgb(20,192,80)'; // Light green background</td></tr><tr><td class="line-number" value="535"></td><td class="line-content">            // }</td></tr><tr><td class="line-number" value="536"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="537"></td><td class="line-content">            card.onclick = () =&gt; {</td></tr><tr><td class="line-number" value="538"></td><td class="line-content">                // Remove active class from all cards</td></tr><tr><td class="line-number" value="539"></td><td class="line-content">                document.querySelectorAll('.bus-card').forEach(c =&gt; c.classList.remove('active'));</td></tr><tr><td class="line-number" value="540"></td><td class="line-content">                // Add active class to clicked card</td></tr><tr><td class="line-number" value="541"></td><td class="line-content">                card.classList.add('active');</td></tr><tr><td class="line-number" value="542"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="543"></td><td class="line-content">                // Fly to bus location</td></tr><tr><td class="line-number" value="544"></td><td class="line-content">                map.flyTo({</td></tr><tr><td class="line-number" value="545"></td><td class="line-content">                    center: [bus.lng, bus.lat],</td></tr><tr><td class="line-number" value="546"></td><td class="line-content">                    zoom: 15,</td></tr><tr><td class="line-number" value="547"></td><td class="line-content">                    duration: 1000</td></tr><tr><td class="line-number" value="548"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="549"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="550"></td><td class="line-content">                // Show popup for the bus</td></tr><tr><td class="line-number" value="551"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="552"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="553"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="554"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="555"></td><td class="line-content">                    .setLngLat([bus.lng, bus.lat])</td></tr><tr><td class="line-number" value="556"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="557"></td><td class="line-content">                    &lt;p class="bus-stop-name"&gt;Bus ${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="558"></td><td class="line-content">                    &lt;p style="margin: 0 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdateTime.toLocaleString()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="559"></td><td class="line-content">                `)</td></tr><tr><td class="line-number" value="560"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="561"></td><td class="line-content">            };</td></tr><tr><td class="line-number" value="562"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="563"></td><td class="line-content">            let time = new Date(bus.time);</td></tr><tr><td class="line-number" value="564"></td><td class="line-content">            let now = new Date();</td></tr><tr><td class="line-number" value="565"></td><td class="line-content">            let timeDifference = (now - time) / (1000 * 60); // Difference in minutes</td></tr><tr><td class="line-number" value="566"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="567"></td><td class="line-content">            let onlineStat = '';</td></tr><tr><td class="line-number" value="568"></td><td class="line-content">            // Apply green background if less than 30 minutes</td></tr><tr><td class="line-number" value="569"></td><td class="line-content">            if (timeDifference &lt; 30) {</td></tr><tr><td class="line-number" value="570"></td><td class="line-content">                // add a class to the card</td></tr><tr><td class="line-number" value="571"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream mt-1 fs-2 online" style="color: #0fa354 !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="572"></td><td class="line-content">                card.classList.add('online');</td></tr><tr><td class="line-number" value="573"></td><td class="line-content">                card.classList.remove('offline');</td></tr><tr><td class="line-number" value="574"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="575"></td><td class="line-content">            else {</td></tr><tr><td class="line-number" value="576"></td><td class="line-content">                // remove the class</td></tr><tr><td class="line-number" value="577"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream-slash mt-1 fs-2 offline" style="color: #ff274f !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="578"></td><td class="line-content">                card.classList.remove('online');</td></tr><tr><td class="line-number" value="579"></td><td class="line-content">                card.classList.add('offline');</td></tr><tr><td class="line-number" value="580"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="581"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="582"></td><td class="line-content">            // Format time as dd/mm/yyyy hh:mm:ss AM/PM</td></tr><tr><td class="line-number" value="583"></td><td class="line-content">            let timeString = time.toLocaleString('en-GB', {hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true});</td></tr><tr><td class="line-number" value="584"></td><td class="line-content">            card.innerHTML = `</td></tr><tr><td class="line-number" value="585"></td><td class="line-content">                &lt;div class="d-flex justify-content-between"&gt;</td></tr><tr><td class="line-number" value="586"></td><td class="line-content">                    &lt;div class="d-flex"&gt;</td></tr><tr><td class="line-number" value="587"></td><td class="line-content">                        &lt;div class="legend-icon me-1" style="background-image: url(https://live.paj.com.my/assets/bus-marker.png)"&gt;&lt;/div&gt;</td></tr><tr><td class="line-number" value="588"></td><td class="line-content">                        &lt;p class="bus-id mb-0 fs-4 fw-bold"&gt;${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="589"></td><td class="line-content">                    &lt;/div&gt;</td></tr><tr><td class="line-number" value="590"></td><td class="line-content">                    ${onlineStat}</td></tr><tr><td class="line-number" value="591"></td><td class="line-content">                &lt;/div&gt;</td></tr><tr><td class="line-number" value="592"></td><td class="line-content">                &lt;p class="last-update fs-7 fw-bold"&gt;&lt;i class="fa-solid fa-clock ms-1 me-2 text-primary"&gt;&lt;/i&gt;${timeString.toUpperCase()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="593"></td><td class="line-content">            `;</td></tr><tr><td class="line-number" value="594"></td><td class="line-content">            busCardsContainer.appendChild(card);</td></tr><tr><td class="line-number" value="595"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="596"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="597"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="598"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="599"></td><td class="line-content">    // interval to update bus location</td></tr><tr><td class="line-number" value="600"></td><td class="line-content">    setInterval(updateBusLocation, 10000);</td></tr><tr><td class="line-number" value="601"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="602"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="603"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span></td></tr><tr><td class="line-number" value="604"></td><td class="line-content"><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>