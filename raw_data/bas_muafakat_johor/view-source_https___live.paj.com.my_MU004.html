
<!-- saved from url=(0029)https://live.paj.com.my/MU004 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="color-scheme" content="light dark"></head><body><div class="line-gutter-backdrop"></div><form autocomplete="off"><label class="line-wrap-control">Line wrap<input type="checkbox" aria-label="Line wrap"></label></form><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content">    <span class="html-tag">&lt;title&gt;</span>Jejak Kedudukan Bas Muafakat Johor<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">UTF-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">viewport</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">width=device-width, initial-scale=1.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">description</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Jejak Kedudukan Bas Muafakat Johor</span>"/&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">shortcut icon</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-paj.png" rel="noreferrer noopener">/assets/logo-paj.png</a>"/&gt;</span></td></tr><tr><td class="line-number" value="9"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="10"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/plugins/global/plugins.bundle.css" rel="noreferrer noopener">/assets/plugins/global/plugins.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/css/style.bundle.css" rel="noreferrer noopener">/assets/css/style.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="12"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css" rel="noreferrer noopener">https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">    <span class="html-tag">&lt;style&gt;</span></td></tr><tr><td class="line-number" value="14"></td><td class="line-content">        body {</td></tr><tr><td class="line-number" value="15"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="16"></td><td class="line-content">            padding: 0;</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">        #map {</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">            top: 0;</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">            bottom: 0;</td></tr><tr><td class="line-number" value="22"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="23"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="24"></td><td class="line-content">        .legend-card {</td></tr><tr><td class="line-number" value="25"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">            top: 10px;</td></tr><tr><td class="line-number" value="27"></td><td class="line-content">            right: 10px;</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">            background: white;</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">            padding-top: 3px;</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">            box-shadow: 0 2px 4px rgba(0,0,0,0.1);</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">            z-index: 1;</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">            max-width: 200px;</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">        .legend-title {</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">            font-weight: 600;</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">            margin: 0 0 10px 0;</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="42"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="43"></td><td class="line-content">        .legend-item {</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">            display: flex;</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">            align-items: center;</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">            margin-bottom: 8px;</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">        .legend-item:last-child {</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">            margin-bottom: 0;</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="51"></td><td class="line-content">        .legend-icon {</td></tr><tr><td class="line-number" value="52"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">            height: 20px;</td></tr><tr><td class="line-number" value="54"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="55"></td><td class="line-content">            background-size: contain;</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">            background-repeat: no-repeat;</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">            background-position: center;</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="59"></td><td class="line-content">        .legend-text {</td></tr><tr><td class="line-number" value="60"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">        .legend-route {</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">            background-color: #ff0000;</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">            height: 3px;</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="68"></td><td class="line-content">            border-radius: 2px;</td></tr><tr><td class="line-number" value="69"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">        .mapboxgl-popup-content {</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="73"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="74"></td><td class="line-content">        .bus-stop-name {</td></tr><tr><td class="line-number" value="75"></td><td class="line-content">            font-weight: bold;</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="77"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="78"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="80"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="81"></td><td class="line-content">        /* New styles for the sliding cards */</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">        .bus-cards-container {</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">            position: fixed;</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">            bottom: 30px;</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">            left: 50%;</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">            transform: translateX(-50%);</td></tr><tr><td class="line-number" value="87"></td><td class="line-content">            /*height: 50px;*/</td></tr><tr><td class="line-number" value="88"></td><td class="line-content">            background: transparent;</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">            overflow-x: auto;</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">            white-space: nowrap;</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">            padding-top: 10px;</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">            padding-bottom: 10px;</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">            padding-left: 10px;</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">            /*padding-bottom: 10px;*/</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">            scrollbar-width: none; /* Firefox */</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">            -ms-overflow-style: none; /* IE and Edge */</td></tr><tr><td class="line-number" value="97"></td><td class="line-content">            z-index: 1000;</td></tr><tr><td class="line-number" value="98"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">            max-width: 1200px;</td></tr><tr><td class="line-number" value="100"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="101"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="102"></td><td class="line-content">        /*.bus-cards-container::-webkit-scrollbar {*/</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">        /*    display: none; !* Chrome, Safari, Opera *!*/</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="105"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="106"></td><td class="line-content">        .bus-card {</td></tr><tr><td class="line-number" value="107"></td><td class="line-content">            display: inline-block;</td></tr><tr><td class="line-number" value="108"></td><td class="line-content">            width: 160px;</td></tr><tr><td class="line-number" value="109"></td><td class="line-content">            height: 60px;</td></tr><tr><td class="line-number" value="110"></td><td class="line-content">            margin-right: 10px;</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">            background: rgba(255, 255, 255, 0.9);</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">            padding: 10px;</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">            vertical-align: top;</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">            cursor: pointer;</td></tr><tr><td class="line-number" value="117"></td><td class="line-content">            transition: all 0.2s ease;</td></tr><tr><td class="line-number" value="118"></td><td class="line-content">            backdrop-filter: blur(5px);</td></tr><tr><td class="line-number" value="119"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; /* Add this line */</td></tr><tr><td class="line-number" value="120"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="121"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="122"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="123"></td><td class="line-content">        .bus-card:hover {</td></tr><tr><td class="line-number" value="124"></td><td class="line-content">            transform: translateY(-2px);</td></tr><tr><td class="line-number" value="125"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="126"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="127"></td><td class="line-content">        .bus-card.active {</td></tr><tr><td class="line-number" value="128"></td><td class="line-content">            background: #e3f2fd;</td></tr><tr><td class="line-number" value="129"></td><td class="line-content">            border: 2px solid #2196f3;</td></tr><tr><td class="line-number" value="130"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="131"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="132"></td><td class="line-content">        .bus-id {</td></tr><tr><td class="line-number" value="133"></td><td class="line-content">            /*font-weight: bold;*/</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">            /*font-size: 16px;*/</td></tr><tr><td class="line-number" value="135"></td><td class="line-content">            color: #434343;</td></tr><tr><td class="line-number" value="136"></td><td class="line-content">            margin: 0 0 5px 0;</td></tr><tr><td class="line-number" value="137"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="138"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="139"></td><td class="line-content">        .last-update {</td></tr><tr><td class="line-number" value="140"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="141"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="142"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="143"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="144"></td><td class="line-content">        .online {</td></tr><tr><td class="line-number" value="145"></td><td class="line-content">            /*background: #0fa354;*/</td></tr><tr><td class="line-number" value="146"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="147"></td><td class="line-content">        .offline {</td></tr><tr><td class="line-number" value="148"></td><td class="line-content">            background: #dadada;</td></tr><tr><td class="line-number" value="149"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="150"></td><td class="line-content">        /*.logo-container img {*/</td></tr><tr><td class="line-number" value="151"></td><td class="line-content">        /*    height: 40px;*/</td></tr><tr><td class="line-number" value="152"></td><td class="line-content">        /*    width: auto;*/</td></tr><tr><td class="line-number" value="153"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="154"></td><td class="line-content"> .back-btn{</td></tr><tr><td class="line-number" value="155"></td><td class="line-content">      display:inline-flex;</td></tr><tr><td class="line-number" value="156"></td><td class="line-content">      align-items:center;</td></tr><tr><td class="line-number" value="157"></td><td class="line-content">      gap:8px;</td></tr><tr><td class="line-number" value="158"></td><td class="line-content">      margin-top:10px;</td></tr><tr><td class="line-number" value="159"></td><td class="line-content">      padding:8px 12px;</td></tr><tr><td class="line-number" value="160"></td><td class="line-content">      border-radius:8px;</td></tr><tr><td class="line-number" value="161"></td><td class="line-content">      border:1px solid rgba(0,0,0,.08);</td></tr><tr><td class="line-number" value="162"></td><td class="line-content">      background:#f4f6f8;</td></tr><tr><td class="line-number" value="163"></td><td class="line-content">      font-size:12px;</td></tr><tr><td class="line-number" value="164"></td><td class="line-content">      font-weight:600;</td></tr><tr><td class="line-number" value="165"></td><td class="line-content">      color:#2b2e34;</td></tr><tr><td class="line-number" value="166"></td><td class="line-content">      text-decoration:none;</td></tr><tr><td class="line-number" value="167"></td><td class="line-content">      box-shadow:0 1px 2px rgba(0,0,0,.06);</td></tr><tr><td class="line-number" value="168"></td><td class="line-content">      transition:transform .12s ease, background .12s ease;</td></tr><tr><td class="line-number" value="169"></td><td class="line-content">  }</td></tr><tr><td class="line-number" value="170"></td><td class="line-content">  .back-btn:hover{ background:#e9ecef; transform:translateY(-1px); }</td></tr><tr><td class="line-number" value="171"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="172"></td><td class="line-content">  .legend-card{ z-index: 2001!important; } /* pastikan atas Mapbox controls */</td></tr><tr><td class="line-number" value="173"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="174"></td><td class="line-content">  .legend-nav {</td></tr><tr><td class="line-number" value="175"></td><td class="line-content">    display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;</td></tr><tr><td class="line-number" value="176"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="177"></td><td class="line-content">.legend-btn {</td></tr><tr><td class="line-number" value="178"></td><td class="line-content">    display:inline-flex; align-items:center; gap:6px;</td></tr><tr><td class="line-number" value="179"></td><td class="line-content">    background:#f4f6f8; border:1px solid #e2e8f0; border-radius:8px;</td></tr><tr><td class="line-number" value="180"></td><td class="line-content">    padding:8px 10px; font-size:12px; color:#333; text-decoration:none;</td></tr><tr><td class="line-number" value="181"></td><td class="line-content">    box-shadow:0 1px 2px rgba(0,0,0,.05);</td></tr><tr><td class="line-number" value="182"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="183"></td><td class="line-content">.legend-btn:hover { background:#eef2f6; }</td></tr><tr><td class="line-number" value="184"></td><td class="line-content">.legend-btn .kecil { opacity:.7; font-weight:600; }</td></tr><tr><td class="line-number" value="185"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="186"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="187"></td><td class="line-content">    <span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="188"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="189"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://unpkg.com/@turf/turf@6.5.0/turf.min.js" rel="noreferrer noopener">https://unpkg.com/@turf/turf@6.5.0/turf.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="190"></td><td class="line-content"><span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="191"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><span class="html-tag">&lt;body&gt;</span></td></tr><tr><td class="line-number" value="193"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">map</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="194"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bus-cards-container</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">busCards</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="195"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-card text-center</span>"&gt;</span></td></tr><tr><td class="line-number" value="196"></td><td class="line-content">    <span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-main.png" rel="noreferrer noopener">https://live.paj.com.my/assets/logo-main.png</a>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">logo-container mt-2</span>" <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">Logo</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width: 70px; height: auto;</span>"&gt;</span></td></tr><tr><td class="line-number" value="197"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="198"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="199"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="200"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Bas<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="201"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="202"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="203"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-stop-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="204"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Perhentian<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="205"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="206"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="207"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-route</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="208"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Laluan<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="209"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="210"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="211"></td><td class="line-content">    <span class="html-comment">&lt;!-- NEW: Butang Kembali --&gt;</span></td></tr><tr><td class="line-number" value="212"></td><td class="line-content">    <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">back-btn</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://live.paj.com.my/" rel="noreferrer noopener">https://live.paj.com.my</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">btnBack</span>"&gt;</span></td></tr><tr><td class="line-number" value="213"></td><td class="line-content">        <span class="html-comment">&lt;!-- ikon anak panah kecil (SVG inline supaya tiada dependensi) --&gt;</span></td></tr><tr><td class="line-number" value="214"></td><td class="line-content">        <span class="html-tag">&lt;svg <span class="html-attribute-name">width</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">viewBox</span>="<span class="html-attribute-value">0 0 24 24</span>" <span class="html-attribute-name">fill</span>="<span class="html-attribute-value">none</span>" <span class="html-attribute-name">aria-hidden</span>="<span class="html-attribute-value">true</span>"&gt;</span></td></tr><tr><td class="line-number" value="215"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M10 19l-7-7 7-7</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="216"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M3 12h18</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="217"></td><td class="line-content">        <span class="html-tag">&lt;/svg&gt;</span></td></tr><tr><td class="line-number" value="218"></td><td class="line-content">        Kembali</td></tr><tr><td class="line-number" value="219"></td><td class="line-content">    <span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="220"></td><td class="line-content"><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="221"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://code.jquery.com/jquery-3.6.0.min.js" rel="noreferrer noopener">https://code.jquery.com/jquery-3.6.0.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="222"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="223"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="224"></td><td class="line-content">    let geojson = {"name":"MU004","type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"LineString","coordinates":[[102.5647363302189,2.046816860947653],[102.565055574679,2.0469727609765],[102.5651548330374,2.046889398422773],[102.5662696180675,2.047561924741963],[102.5662845938407,2.047585064972182],[102.566836929075,2.047979161181877],[102.5683939788431,2.049110435604528],[102.5691333462493,2.049674759146032],[102.5706530119468,2.050716860506501],[102.5721305047455,2.052520447243281],[102.5722148186201,2.052632933646767],[102.5726532406803,2.053304296353049],[102.5726789851468,2.053344914563927],[102.5733904587607,2.054678642512497],[102.5740371856204,2.056347395364694],[102.5742327921287,2.057232567842469],[102.5750100910666,2.05707987744798],[102.5755471213064,2.05698691669163],[102.5762299215748,2.056895426542106],[102.5766872269262,2.056799414644783],[102.5767496061406,2.056840450139277],[102.5768168331215,2.057563748052496],[102.576801091095,2.057578256702339],[102.5762200074693,2.057688642652883],[102.5755363961515,2.057827406941302],[102.5745109732854,2.057959804778815],[102.5752346047481,2.060303453222191],[102.5769077132661,2.066929928502515],[102.5783010163809,2.072283331246708],[102.5798426244106,2.078617481203627],[102.5810447909372,2.083390517460871],[102.5816887686493,2.086007989811573],[102.582005643591,2.086526274726146],[102.5821696273418,2.086751418253209],[102.5826317826081,2.087152916354674],[102.5832029750106,2.087546157212693],[102.5835946206531,2.08771887011211],[102.5839274231081,2.08781204629797],[102.5843329735159,2.087858934349037],[102.5851686830282,2.087761598305245],[102.5858888712307,2.087657363120739],[102.5873618760544,2.086681157718143],[102.5895865964372,2.085880657357195],[102.5901848962887,2.08577177332372],[102.5905346414671,2.085728521017827],[102.5928106465929,2.085732294201245],[102.5934018526189,2.085753964035534],[102.5943807533373,2.085881018812741],[102.5953323167455,2.086053262160261],[102.5968986846865,2.086476473412037],[102.5971783351492,2.086534262089563],[102.5974482495064,2.086518849493781],[102.6001055520173,2.086263529478016],[102.6034322747663,2.085910891499613],[102.6042429766982,2.085827124859275],[102.6046858861252,2.085787284275192],[102.604982716981,2.085780070166059],[102.6055259785019,2.085798200908595],[102.6065574038142,2.085896478245347],[102.6071113979854,2.086043584417324],[102.609736011967,2.087120710150059],[102.6158625335549,2.089562144988548],[102.6198138482685,2.091221886336276],[102.6388779314306,2.099015738519196],[102.6432041856036,2.100683819443566],[102.6436294077258,2.100561566757481],[102.6442952483637,2.100384501498734],[102.6448349719029,2.100304879778573],[102.6452935463167,2.100325494814669],[102.645942233262,2.100534917558671],[102.646350563996,2.100747242696349],[102.6466938598076,2.101029217838279],[102.6468481775855,2.101206275448091],[102.64690326395,2.101317840319896],[102.6469363945327,2.101369845234117],[102.6473241631701,2.10201785084112],[102.6476500090676,2.102557352503846],[102.6477370790494,2.102650564415336],[102.6504839159639,2.103835893794757],[102.6569955210227,2.106413126268836],[102.6595956767199,2.10749912411882],[102.6607274370435,2.107978558425322],[102.6707336672115,2.112005538673729],[102.6766609014451,2.114481299498956],[102.677994658186,2.115283736425468],[102.679950379237,2.11659846414849],[102.683788125484,2.119279246860851],[102.6842381189567,2.119744150048779],[102.6862379529095,2.122375338555091],[102.6867775081649,2.122731450137549],[102.6881005089013,2.123351554103127],[102.6923982706666,2.124922088903561],[102.6929115671727,2.125014059208946],[102.6935805432495,2.125088251799519],[102.6942040833046,2.125153728189453],[102.6947011893869,2.125199306686814],[102.6952276416152,2.125376882101331],[102.6958108433204,2.125603880918479],[102.6981743281309,2.126835689492653],[102.699058132035,2.127312931969647],[102.6998453070662,2.127784701531716],[102.7004691712063,2.12802533736361],[102.7007606233297,2.128117327313104],[102.7012130318689,2.128317820959568],[102.7017154123607,2.128589370509341],[102.701816442564,2.128686734914901],[102.7021370259036,2.128855608175298],[102.7028375121923,2.129104025280747],[102.7035950473432,2.129276390966781],[102.7041991390122,2.129362481804662],[102.7045643282249,2.129323034927054],[102.7057618327677,2.129048119682163],[102.7060907680548,2.128986246535051],[102.7065687973877,2.129024722837431],[102.7074605524564,2.129172992926534],[102.7084882619422,2.129484198160935],[102.7097438286735,2.129784895737997],[102.710572364515,2.129983549356153],[102.7109858683583,2.129998689276137],[102.7116847701741,2.129955628106564],[102.7123792497436,2.130118262465398],[102.7167188322953,2.13191449176857],[102.7196103589942,2.133164833966609],[102.7203820353612,2.133501258202444],[102.7209280424946,2.133635189008751],[102.7216566982836,2.133699753606065],[102.7223774857716,2.13371719140039],[102.7230279310192,2.133566996802246],[102.7236618478609,2.133308738244375],[102.7243697488038,2.133008272025335],[102.7259427487548,2.132266836684495],[102.726462018335,2.132109736092549],[102.7270023812231,2.132027835794184],[102.7297028340521,2.132279879472325],[102.7304400537626,2.132303414707617],[102.7310870319386,2.13236125192075],[102.7317608085704,2.132476529310782],[102.7323176666454,2.132666886204665],[102.7338485414351,2.133341992866522],[102.735055561009,2.134249441562647],[102.7350724413442,2.134346344593606],[102.7350024406002,2.134540621353807],[102.7347404295102,2.135002927116281],[102.7342375772948,2.135856316372198],[102.7336479015247,2.136834032010523],[102.7331119990881,2.137747915207626],[102.7329119375147,2.138162024632649],[102.7319385219237,2.139825839474787],[102.731785005105,2.139941917569556],[102.7314766962914,2.140001641896495],[102.7314728256177,2.140001649626821],[102.7313780023596,2.140117701877137],[102.7313503561476,2.140275248068535],[102.7313663404708,2.140383203646143],[102.731405724381,2.140503772455738],[102.7314238267511,2.140549765953079],[102.7310193198993,2.14129367124692],[102.7305177134804,2.142169173468269],[102.73008132307,2.142927219987171],[102.7297461994649,2.143573261355927],[102.7296300357773,2.144002816879559],[102.7296104355135,2.144660877656773],[102.7297413653991,2.145365296013932],[102.7297813605768,2.146010098044351],[102.7297713837533,2.146218272260213],[102.7296469378113,2.146608825127851],[102.7291135767685,2.147578125008245],[102.7285751267299,2.148540000299059],[102.7280031086909,2.14954543315854],[102.7274748775467,2.150443787664875],[102.7256685779411,2.153584792106528],[102.724632661008,2.155224934337607],[102.7221003833293,2.159923041095728],[102.7221284616808,2.160021253229405],[102.7222053287275,2.160085331643395],[102.7229681049206,2.158546024455499],[102.724396577266,2.155985679963055],[102.7252837641768,2.154472243992554],[102.7262771411666,2.152712490910358],[102.7298342479149,2.146594954028276],[102.7299262364425,2.146107622671074],[102.7298922263832,2.145417232811801],[102.729793165757,2.144966747426233],[102.7296459603307,2.144425852292167],[102.7298049479585,2.143867684442532],[102.7302969654319,2.142834456907334],[102.7313962185547,2.140918348886811],[102.7316346052962,2.140622025196125],[102.7319121299832,2.140598583083056],[102.7319973907544,2.140560230078517],[102.7320920504483,2.140438749369842],[102.7320762645396,2.14028914516406],[102.732008606528,2.139996582783996],[102.7328260135888,2.138459607270144],[102.7339548083999,2.136720072408841],[102.7341459237892,2.136324493104473],[102.7352337985399,2.134310411933467],[102.7354508754983,2.134386595384253],[102.73566988066,2.134539632108976],[102.7366341609023,2.135313504071612],[102.7391754022662,2.137117250917076],[102.7414544416968,2.138780665626562],[102.7419931355638,2.139018643612215],[102.7426295807614,2.139244923503785],[102.743153167784,2.139404204399799],[102.7447126344644,2.139540719470737],[102.7518298780442,2.140369538892281],[102.7563051847789,2.140893159862389],[102.7590417032312,2.141186017798761],[102.7601026776015,2.141277435762953],[102.7613649098906,2.14142293585036],[102.7619675436628,2.141466401379246],[102.762448224971,2.141546781013753],[102.7627348643762,2.141663971836249],[102.7629739453791,2.141775622789562],[102.7641251623579,2.142651715029964],[102.7667597971721,2.144922502459264],[102.7693307854699,2.147161960119182],[102.770495946294,2.148148265942444],[102.7706830995013,2.148374484172395],[102.7722709120932,2.149727025562076],[102.7732263609501,2.150559198178519],[102.7737479071825,2.151016568303538],[102.7746121068324,2.151638816884839],[102.7755294444826,2.152183271361246],[102.7766542559975,2.152822150060469],[102.776830149576,2.152927643658283],[102.7768545459741,2.152885340192387],[102.7768466382899,2.152779117117525],[102.7766405079207,2.1526529603554],[102.7765586115,2.152605189239539],[102.776438451301,2.152586991058133],[102.7764114925992,2.152642621681358],[102.7750370302858,2.151817953030887],[102.7740320457833,2.151152220626515],[102.7725150617901,2.149868168679349],[102.7708657022435,2.148433358328678],[102.767951206703,2.145885257630741],[102.7661035549713,2.144322439666666],[102.7636183634031,2.142201230175699],[102.7628758892984,2.141653280341187],[102.7624583264895,2.141484733299194],[102.7619893094873,2.14141562032629],[102.7551484646185,2.140689379926031],[102.7475694383773,2.139743984171194],[102.7431597976315,2.139271052115874],[102.7424457399293,2.139119580552608],[102.7418707450273,2.138898823645843],[102.7413540836167,2.138620111665715],[102.7403141635499,2.137887160744445],[102.7360586539553,2.134742807308212],[102.7352620932451,2.13419076965433],[102.7350058119555,2.134060501099812],[102.7340493657733,2.133387610573993],[102.733476880602,2.133044431638902],[102.732528212585,2.132613535899735],[102.7321247738741,2.132480760233548],[102.7315638454315,2.132338606929065],[102.7309038785434,2.132243343311361],[102.7287490855175,2.132050222266018],[102.7272071317008,2.131912000639204],[102.726566034793,2.131976485300555],[102.7254978934787,2.132331222062828],[102.7242867426009,2.132966718625793],[102.7236360609058,2.133223493873881],[102.7229768121756,2.13348526559188],[102.7226327758881,2.133584472671129],[102.7218245493499,2.133648056165232],[102.7211023067488,2.133563438747694],[102.7200260545593,2.13322120398505],[102.7158491881578,2.131420681478986],[102.7137076362344,2.130534173190423],[102.7128554700742,2.130153772996637],[102.7124338211701,2.129994985972634],[102.7121389527802,2.129931248709278],[102.7119895867853,2.129910197971641],[102.7114260690033,2.129875965160003],[102.7109478834078,2.129886914159235],[102.7107323274879,2.129912653055169],[102.7102533179939,2.129828752036716],[102.7098179702813,2.129732944194862],[102.7081965936484,2.129318688398373],[102.7071203567354,2.129048201955329],[102.7066021338787,2.128962524948732],[102.7060909858689,2.128925520226487],[102.7053681283751,2.129075989009678],[102.7048226693372,2.129189951894088],[102.7043815109255,2.129290631879108],[102.7041346978661,2.129308435191737],[102.703826175931,2.129272869058546],[102.7035506776522,2.12921676798701],[102.7032701702476,2.129154791065456],[102.7029623574459,2.129093981136658],[102.7023883575623,2.128899339350117],[102.7020336011731,2.128755525804293],[102.7015627876296,2.128444056706641],[102.7008950954921,2.128118779598291],[102.7007026644656,2.128061266728144],[102.7000036216691,2.127805727383635],[102.6996067012393,2.127607737574269],[102.6983566664938,2.126870761485244],[102.6977274589261,2.126523233394036],[102.6956040468387,2.125452168175961],[102.6950989988525,2.125285105895981],[102.6947224566047,2.12516770995626],[102.6942023823527,2.125108813167544],[102.6939431306243,2.125067887716149],[102.69350784203,2.125030803442865],[102.6930905220969,2.124990837256393],[102.6927751759978,2.124948110556973],[102.6923624386094,2.124848530558044],[102.6920504940798,2.124755115584809],[102.6894696637134,2.123810403381256],[102.6883502963736,2.123387745321536],[102.6880505088839,2.123270416996747],[102.6873906276144,2.122967840139127],[102.6869677036877,2.122771306013988],[102.686677758182,2.122622994442054],[102.6862220835703,2.122248987510437],[102.6860443074811,2.121997870904545],[102.6854849333936,2.121305222744126],[102.6851921692739,2.120878569480498],[102.6848084232316,2.120400460563572],[102.6844545434396,2.119954263423382],[102.6842652224683,2.119696488628527],[102.6838718197331,2.119267188337359],[102.6837298155574,2.119124569264609],[102.6779369116969,2.115179767755716],[102.6772717131732,2.114718082644742],[102.6765019120267,2.114311110666888],[102.6754696500662,2.113899466124761],[102.6683530174459,2.111016954399113],[102.6607041575065,2.107931150271212],[102.6589966317032,2.107169014957504],[102.652590492281,2.104596150022131],[102.6480031159705,2.10271548096129],[102.6476504498796,2.102513790781747],[102.647257435699,2.101797377889032],[102.6468995071948,2.101209995316],[102.6466954262816,2.100948977981636],[102.646384324595,2.100716956928205],[102.6460033218662,2.100517782324318],[102.6454635408486,2.100323015627627],[102.6452932411357,2.100278531872579],[102.6448331546863,2.100259091135245],[102.6444371133185,2.100319330521179],[102.6434263909526,2.100547330888439],[102.6432635453141,2.100626608062501],[102.643087924887,2.100594029714699],[102.6429550982957,2.100557486935257],[102.6383361232255,2.09872165299682],[102.632174107061,2.096179945177372],[102.6251593659726,2.093375633140225],[102.6144552572895,2.088924844773083],[102.6104210285744,2.08727493414087],[102.607472395034,2.086084384529551],[102.6070548839297,2.085936767903275],[102.6067561109778,2.085881890394122],[102.6058127315962,2.085776511071131],[102.6049544432806,2.085722361506679],[102.604690431964,2.085733141650177],[102.6026760809234,2.085943806577006],[102.5992884768238,2.086301251790358],[102.5971609159699,2.086483574802085],[102.5961123210355,2.086176811375517],[102.5954204242486,2.085991077434644],[102.5948290864361,2.085906620804093],[102.5948115019835,2.085906619496711],[102.5947228194527,2.085906612939306],[102.5944650794534,2.085855515043273],[102.5938026435488,2.085768434088533],[102.5932849002168,2.085710743885646],[102.5928530037029,2.085696344853659],[102.592381345477,2.085714056568533],[102.5903655565194,2.085674638644051],[102.5896752915755,2.085826067609047],[102.5888205551591,2.086094191036156],[102.5872452257479,2.08668114924283],[102.5858904142612,2.08759727821603],[102.5845349571848,2.087769311107246],[102.5842946730507,2.087777060389175],[102.5840887821419,2.08777315713737],[102.5837518133546,2.087715017343916],[102.583369905974,2.087584323913523],[102.5829728458963,2.087341934146022],[102.5825615195857,2.087063553676786],[102.5822099981968,2.086709997465022],[102.5820179644815,2.086453547694648],[102.5818848779822,2.086191545958501],[102.5817316594777,2.085731018606781],[102.581644705071,2.085439912013134],[102.5807554708142,2.081899481652255],[102.5802582314085,2.080065935755675],[102.5791316068943,2.075423850813397],[102.576782716609,2.066163048640845],[102.5753236264674,2.060400680863273],[102.5749077648498,2.058977611513035],[102.5759136711405,2.058977601704656],[102.5759783624103,2.058811172000257],[102.575905775532,2.057792627278623],[102.5768192450036,2.057583021479179],[102.5767316892839,2.056756841912788],[102.5751374522642,2.056995307962834],[102.5743039976378,2.057157058249294],[102.5741251189624,2.056512202717323],[102.5738098160208,2.055622346784295],[102.573315793124,2.054409923055878],[102.5725827595736,2.053070116134609],[102.5721723962581,2.052487823262333],[102.5721888743799,2.052374356349991],[102.5727727586964,2.051907156685907],[102.5726336647404,2.05182087322547],[102.5713148499897,2.050433978556833],[102.5693568676739,2.048975613191236],[102.5679773188531,2.047901734098813],[102.5659338270553,2.046334111588982],[102.5646764219385,2.045727712635876],[102.5640502130983,2.04546138283241],[102.5635660422592,2.045309715829433],[102.5633103923915,2.045990440263612],[102.5639639262167,2.04620648471157],[102.5646363759513,2.046569058442704],[102.564587174651,2.046712647329539],[102.5646822894721,2.046766186876295]]}}]};</td></tr><tr><td class="line-number" value="225"></td><td class="line-content">    let pois = [{"name":"Hospital Pakar Sultanah Fatimah","lat":"2.05673126","lng":"102.57423860"},{"name":"Taman Putera Indah","lat":"2.06956346","lng":"102.57751380"},{"name":"SMK Tun Perak","lat":"2.07509726","lng":"102.57886770"},{"name":"SMK Tun Perak ( Tiang 2)","lat":"2.07567738","lng":"102.57921600"},{"name":"Kampung Temiang ubah ke (Hospital Pakar Sultanah Fatimah, Muar)","lat":"2.08648763","lng":"102.58209780"},{"name":"Kampung Simpang Baba","lat":"2.08657361","lng":"102.59706640"},{"name":"Simpang Jalan Naib Piee","lat":"2.08567668","lng":"102.60455850"},{"name":"Klinik desa Sungai Terap","lat":"2.08865699","lng":"102.61398060"},{"name":"Sekolah Kebangsaan Sungai Raya (Tiang 1)","lat":"2.09323570","lng":"102.62506910"},{"name":"Sekolah Kebangsaan Sungai Raya (Tiang 2)","lat":"2.09354390","lng":"102.62522550"},{"name":"Bukit Pasir","lat":"2.09658329","lng":"102.63284550"},{"name":"Sekolah Kebangsaan Sri Bukit Pasir","lat":"2.09780473","lng":"102.63630730"},{"name":"Kuaters JKR Muar, Bukit Pasir","lat":"2.10781001","lng":"102.66062260"},{"name":"Taman Pagoh Jaya","lat":"2.13120490","lng":"102.71501650"},{"name":"Taman Pagoh Jaya (Tiang 2)","lat":"2.13111067","lng":"102.71557390"},{"name":"UTHM Pagoh","lat":"2.15235782","lng":"102.72602600"},{"name":"Seri Pekembar","lat":"2.13588207","lng":"102.73786460"},{"name":"Sekolah Agama Pekan Pagoh","lat":"2.14573359","lng":"102.76759870"},{"name":"Masjid Jamek Pekan Pagoh","lat":"2.14783822","lng":"102.77031450"},{"name":"SMK Sultan Alauddin Riayat Shah 1","lat":"2.15257038","lng":"102.77649350"},{"name":"Tmn. Putra Indah (Bus Stop)","lat":"2.07058700","lng":"102.57795500"},{"name":"Taman Ria (Bus Stop)","lat":"2.07848100","lng":"102.57991200"},{"name":"Taman Temiang Baru (Bus Stop)","lat":"2.08649300","lng":"102.58766900"},{"name":"Bukit Pasir (Bus Stop)","lat":"2.10022700","lng":"102.64185900"},{"name":"Taman Mas Jaya,Jalan Salleh","lat":"2.06700257","lng":"102.57707280"},{"name":"Taman Seri Gemilang,Jalan Salleh","lat":"2.07359807","lng":"102.57854260"},{"name":"Taman Suria,Jalan Salleh","lat":"2.07385122","lng":"102.57877820"},{"name":"Taman Ria Permai,Jalan Salleh","lat":"2.07776736","lng":"102.57958370"},{"name":"Temiang Pagoh,Jalan Salleh","lat":"2.08767178","lng":"102.58523650"},{"name":"Taman Desa Jaya,Jalan Salleh","lat":"2.08590866","lng":"102.60418420"},{"name":"Sungai Terap KM 7,Jalan Salleh","lat":"2.08589168","lng":"102.60571230"},{"name":"Sungai Terap KM 8,Jalan Salleh","lat":"2.08736411","lng":"102.61087170"},{"name":"Taman Pasir Raya,Jalan Muar - Labis","lat":"2.09130818","lng":"102.61987990"},{"name":"Kampung Bukit Pasir,Jalan Muar - Labis","lat":"2.09552663","lng":"102.63072960"},{"name":"Sekolah Agama Sungai Raya","lat":"2.09648232","lng":"102.63301290"},{"name":"Dataran Bukit Pasir,Jalan Muar - Labis","lat":"2.09894270","lng":"102.63912230"},{"name":"Public Bank Bukit Pasir","lat":"2.09971206","lng":"102.64055420"},{"name":"Kampung Paya Panjang,Jalan Muar - Labis","lat":"2.10661059","lng":"102.65780190"},{"name":"Balai Raya Paya Panjang,Jalan Muar - Labis","lat":"2.10705382","lng":"102.65886920"},{"name":"Ladang Pagoh,Jalan Muar - Labis","lat":"2.11898492","lng":"102.68387080"},{"name":"Pusat Perniagaan Pagoh Permai,Jalan Muar","lat":"2.12972704","lng":"102.71091130"},{"name":"Taman Pagoh Jaya 3,Jalan Muar - Labis","lat":"2.12995569","lng":"102.71183070"},{"name":"Opposite IKTBN Pagoh,Jalan Muar - Pagoh","lat":"2.13288969","lng":"102.71982530"},{"name":"IKTBN Pagoh,Jalan Muar - Pagoh","lat":"2.13331200","lng":"102.72081020"},{"name":"Opposite Kawasan Perindustrian Pagoh","lat":"2.13287403","lng":"102.72470370"},{"name":"Kawasan Perindustrian Pagoh","lat":"2.13243286","lng":"102.72462800"},{"name":"Opposite Exit to Tol Pagoh","lat":"2.13203644","lng":"102.72749940"},{"name":"Exit to Tol Pagoh","lat":"2.13180030","lng":"102.72864280"},{"name":"Masjid Pekan Pagoh","lat":"2.14831004","lng":"102.77064580"},{"name":"Agro Bazar R\u0026amp;R Pagoh","lat":"2.13691722","lng":"102.73883450"},{"name":"Sekolah Kebangsaan Parit Setongkat","lat":"2.06332406","lng":"102.57611090"},{"name":"Terminal Feri Bandar Maharani Bandar Diraja","lat":"2.04804211","lng":"102.56686930"},{"name":"UTHM Pagoh II","lat":"2.15214600","lng":"102.72676100"},{"name":"UTHM Pagoh III","lat":"2.14683700","lng":"102.72975700"},{"name":"Terminal Maharani","lat":"2.04669694","lng":"102.56485480"},{"name":"Kampung Paya Panjang,Jalan Muar - Labis II","lat":"2.10661059","lng":"102.65780190"},{"name":"Terminal Maharani","lat":"2.04669694","lng":"102.56485480"}];</td></tr><tr><td class="line-number" value="226"></td><td class="line-content">    let imageBusStop = 'https://live.paj.com.my/assets/bus-stop-marker.png';</td></tr><tr><td class="line-number" value="227"></td><td class="line-content">    let imageArrows = 'https://live.paj.com.my/assets/arrow-markers-red.png';</td></tr><tr><td class="line-number" value="228"></td><td class="line-content">    let imageBus = 'https://live.paj.com.my/assets/bus-marker.png';</td></tr><tr><td class="line-number" value="229"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="230"></td><td class="line-content">    // Convert POIs to GeoJSON format</td></tr><tr><td class="line-number" value="231"></td><td class="line-content">    const poisGeoJSON = {</td></tr><tr><td class="line-number" value="232"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="233"></td><td class="line-content">        features: pois.map(poi =&gt; ({</td></tr><tr><td class="line-number" value="234"></td><td class="line-content">            type: 'Feature',</td></tr><tr><td class="line-number" value="235"></td><td class="line-content">            geometry: {</td></tr><tr><td class="line-number" value="236"></td><td class="line-content">                type: 'Point',</td></tr><tr><td class="line-number" value="237"></td><td class="line-content">                coordinates: [parseFloat(poi.lng), parseFloat(poi.lat)]</td></tr><tr><td class="line-number" value="238"></td><td class="line-content">            },</td></tr><tr><td class="line-number" value="239"></td><td class="line-content">            properties: {</td></tr><tr><td class="line-number" value="240"></td><td class="line-content">                name: poi.name</td></tr><tr><td class="line-number" value="241"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="242"></td><td class="line-content">        }))</td></tr><tr><td class="line-number" value="243"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="244"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="245"></td><td class="line-content">    // Create initial bus GeoJSON with empty features</td></tr><tr><td class="line-number" value="246"></td><td class="line-content">    const busGeoJSON = {</td></tr><tr><td class="line-number" value="247"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="248"></td><td class="line-content">        features: []</td></tr><tr><td class="line-number" value="249"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="250"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="251"></td><td class="line-content">    mapboxgl.accessToken = 'pk.eyJ1IjoiYWxpZmRhcnNpbSIsImEiOiJjbTRjZ3djcmIwNTMxMmlxcGZvZWx1eTFqIn0.X3VV1PhXekp3_HAwoB6kbw';</td></tr><tr><td class="line-number" value="252"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="253"></td><td class="line-content">    // Initialize map with default center</td></tr><tr><td class="line-number" value="254"></td><td class="line-content">    const map = new mapboxgl.Map({</td></tr><tr><td class="line-number" value="255"></td><td class="line-content">        container: 'map',</td></tr><tr><td class="line-number" value="256"></td><td class="line-content">        style: 'mapbox://styles/mapbox/streets-v12',</td></tr><tr><td class="line-number" value="257"></td><td class="line-content">        center: [103.317818, 2.029433],</td></tr><tr><td class="line-number" value="258"></td><td class="line-content">        zoom: 8</td></tr><tr><td class="line-number" value="259"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="260"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="261"></td><td class="line-content">    // Wait for map to load before adding layers</td></tr><tr><td class="line-number" value="262"></td><td class="line-content">    map.on('load', () =&gt; {</td></tr><tr><td class="line-number" value="263"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="264"></td><td class="line-content">        // Load both bus stop and bus icons</td></tr><tr><td class="line-number" value="265"></td><td class="line-content">        Promise.all([</td></tr><tr><td class="line-number" value="266"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="267"></td><td class="line-content">                map.loadImage(imageBusStop, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="268"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="269"></td><td class="line-content">                    map.addImage('bus-stop-icon', image);</td></tr><tr><td class="line-number" value="270"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="271"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="272"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="273"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="274"></td><td class="line-content">                map.loadImage(imageBus, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="275"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="276"></td><td class="line-content">                    map.addImage('bus-icon', image);</td></tr><tr><td class="line-number" value="277"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="278"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="279"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="280"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="281"></td><td class="line-content">                map.loadImage(imageArrows, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="282"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="283"></td><td class="line-content">                    map.addImage('arrow-icon', image);</td></tr><tr><td class="line-number" value="284"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="285"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="286"></td><td class="line-content">            })</td></tr><tr><td class="line-number" value="287"></td><td class="line-content">        ]).then(() =&gt; {</td></tr><tr><td class="line-number" value="288"></td><td class="line-content">            // Add the route source</td></tr><tr><td class="line-number" value="289"></td><td class="line-content">            map.addSource('route', {</td></tr><tr><td class="line-number" value="290"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="291"></td><td class="line-content">                'data': geojson</td></tr><tr><td class="line-number" value="292"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="293"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="294"></td><td class="line-content">            // Add the bus stops source</td></tr><tr><td class="line-number" value="295"></td><td class="line-content">            map.addSource('bus-stops', {</td></tr><tr><td class="line-number" value="296"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="297"></td><td class="line-content">                'data': poisGeoJSON</td></tr><tr><td class="line-number" value="298"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="299"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="300"></td><td class="line-content">            // Add the bus source</td></tr><tr><td class="line-number" value="301"></td><td class="line-content">            map.addSource('bus', {</td></tr><tr><td class="line-number" value="302"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="303"></td><td class="line-content">                'data': busGeoJSON</td></tr><tr><td class="line-number" value="304"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="305"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="306"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="307"></td><td class="line-content">            // Add the arrow layer</td></tr><tr><td class="line-number" value="308"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="309"></td><td class="line-content">                'id': 'route-arrows',</td></tr><tr><td class="line-number" value="310"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="311"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="312"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="313"></td><td class="line-content">                    'symbol-placement': 'line',</td></tr><tr><td class="line-number" value="314"></td><td class="line-content">                    'symbol-spacing': 25,</td></tr><tr><td class="line-number" value="315"></td><td class="line-content">                    'icon-image': 'arrow-icon',</td></tr><tr><td class="line-number" value="316"></td><td class="line-content">                    'icon-size': 0.3,</td></tr><tr><td class="line-number" value="317"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="318"></td><td class="line-content">                    'icon-ignore-placement': true,</td></tr><tr><td class="line-number" value="319"></td><td class="line-content">                    'icon-rotation-alignment': 'map',</td></tr><tr><td class="line-number" value="320"></td><td class="line-content">                    'icon-pitch-alignment': 'map'</td></tr><tr><td class="line-number" value="321"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="322"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="323"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="324"></td><td class="line-content">            // Add the route layer</td></tr><tr><td class="line-number" value="325"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="326"></td><td class="line-content">                'id': 'route',</td></tr><tr><td class="line-number" value="327"></td><td class="line-content">                'type': 'line',</td></tr><tr><td class="line-number" value="328"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="329"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="330"></td><td class="line-content">                    'line-join': 'round',</td></tr><tr><td class="line-number" value="331"></td><td class="line-content">                    'line-cap': 'round'</td></tr><tr><td class="line-number" value="332"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="333"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="334"></td><td class="line-content">                    'line-color': '#ff0000',</td></tr><tr><td class="line-number" value="335"></td><td class="line-content">                    'line-width': 3</td></tr><tr><td class="line-number" value="336"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="337"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="338"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="339"></td><td class="line-content">            // Add the bus stops layer</td></tr><tr><td class="line-number" value="340"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="341"></td><td class="line-content">                'id': 'bus-stops',</td></tr><tr><td class="line-number" value="342"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="343"></td><td class="line-content">                'source': 'bus-stops',</td></tr><tr><td class="line-number" value="344"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="345"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="346"></td><td class="line-content">                    'icon-image': 'bus-stop-icon',</td></tr><tr><td class="line-number" value="347"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="348"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="349"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="350"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="351"></td><td class="line-content">                        10, 0.45,</td></tr><tr><td class="line-number" value="352"></td><td class="line-content">                        13, 0.55,</td></tr><tr><td class="line-number" value="353"></td><td class="line-content">                        16, 0.65</td></tr><tr><td class="line-number" value="354"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="355"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="356"></td><td class="line-content">                    'text-field': ['get', 'name'],</td></tr><tr><td class="line-number" value="357"></td><td class="line-content">                    'text-size': 11.5,</td></tr><tr><td class="line-number" value="358"></td><td class="line-content">                    'text-offset': [0, -1.8],</td></tr><tr><td class="line-number" value="359"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="360"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="361"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold'],</td></tr><tr><td class="line-number" value="362"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="363"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="364"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="365"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="366"></td><td class="line-content">                    'text-color': '#6884D9',</td></tr><tr><td class="line-number" value="367"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="368"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="369"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="370"></td><td class="line-content">            // Add the bus layer</td></tr><tr><td class="line-number" value="371"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="372"></td><td class="line-content">                'id': 'bus',</td></tr><tr><td class="line-number" value="373"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="374"></td><td class="line-content">                'source': 'bus',</td></tr><tr><td class="line-number" value="375"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="376"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="377"></td><td class="line-content">                    'icon-image': 'bus-icon',</td></tr><tr><td class="line-number" value="378"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="379"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="380"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="381"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="382"></td><td class="line-content">                        10, 0.65,</td></tr><tr><td class="line-number" value="383"></td><td class="line-content">                        13, 0.75,</td></tr><tr><td class="line-number" value="384"></td><td class="line-content">                        16, 0.85</td></tr><tr><td class="line-number" value="385"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="386"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="387"></td><td class="line-content">                    'text-field': ['get', 'busId'],</td></tr><tr><td class="line-number" value="388"></td><td class="line-content">                    'text-size': 12,</td></tr><tr><td class="line-number" value="389"></td><td class="line-content">                    'text-offset': [0, -2.1],</td></tr><tr><td class="line-number" value="390"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="391"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="392"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold']</td></tr><tr><td class="line-number" value="393"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="394"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="395"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="396"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="397"></td><td class="line-content">                    'text-color': '#ff3c00'</td></tr><tr><td class="line-number" value="398"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="399"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="400"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="401"></td><td class="line-content">            // Add popup on click for buses</td></tr><tr><td class="line-number" value="402"></td><td class="line-content">            map.on('click', 'bus', (e) =&gt; {</td></tr><tr><td class="line-number" value="403"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="404"></td><td class="line-content">                const busId = e.features[0].properties.busId;</td></tr><tr><td class="line-number" value="405"></td><td class="line-content">                const lastUpdate = new Date(e.features[0].properties.lastUpdate).toLocaleString();</td></tr><tr><td class="line-number" value="406"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="407"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="408"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="409"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="410"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="411"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="412"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="413"></td><td class="line-content">                        &lt;p class="bus-stop-name"&gt;Bus ${busId}&lt;/p&gt;</td></tr><tr><td class="line-number" value="414"></td><td class="line-content">                        &lt;p style="margin: 5px 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdate}&lt;/p&gt;</td></tr><tr><td class="line-number" value="415"></td><td class="line-content">                    `)</td></tr><tr><td class="line-number" value="416"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="417"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="418"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="419"></td><td class="line-content">            // Change cursor on hover for buses</td></tr><tr><td class="line-number" value="420"></td><td class="line-content">            map.on('mouseenter', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="421"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="422"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="423"></td><td class="line-content">            map.on('mouseleave', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="424"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="425"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="426"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="427"></td><td class="line-content">            // Add popup on click for bus stops</td></tr><tr><td class="line-number" value="428"></td><td class="line-content">            map.on('click', 'bus-stops', (e) =&gt; {</td></tr><tr><td class="line-number" value="429"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="430"></td><td class="line-content">                const name = e.features[0].properties.name;</td></tr><tr><td class="line-number" value="431"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="432"></td><td class="line-content">                new mapboxgl.Popup()</td></tr><tr><td class="line-number" value="433"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="434"></td><td class="line-content">                    .setHTML(`&lt;p class="bus-stop-name"&gt;${name}&lt;/p&gt;`)</td></tr><tr><td class="line-number" value="435"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="436"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="437"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="438"></td><td class="line-content">            // Change cursor on hover for bus stops</td></tr><tr><td class="line-number" value="439"></td><td class="line-content">            map.on('mouseenter', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="440"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="441"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="442"></td><td class="line-content">            map.on('mouseleave', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="443"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="444"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="445"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="446"></td><td class="line-content">            // Get the bounds of all features</td></tr><tr><td class="line-number" value="447"></td><td class="line-content">            const coordinates = geojson.features[0].geometry.coordinates;</td></tr><tr><td class="line-number" value="448"></td><td class="line-content">            const bounds = coordinates.reduce((bounds, coord) =&gt; {</td></tr><tr><td class="line-number" value="449"></td><td class="line-content">                return bounds.extend(coord);</td></tr><tr><td class="line-number" value="450"></td><td class="line-content">            }, new mapboxgl.LngLatBounds(coordinates[0], coordinates[0]));</td></tr><tr><td class="line-number" value="451"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="452"></td><td class="line-content">            // Extend bounds to include POIs</td></tr><tr><td class="line-number" value="453"></td><td class="line-content">            pois.forEach(poi =&gt; {</td></tr><tr><td class="line-number" value="454"></td><td class="line-content">                bounds.extend([parseFloat(poi.lng), parseFloat(poi.lat)]);</td></tr><tr><td class="line-number" value="455"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="456"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="457"></td><td class="line-content">            // Fit the map to the route with padding</td></tr><tr><td class="line-number" value="458"></td><td class="line-content">            map.fitBounds(bounds, {</td></tr><tr><td class="line-number" value="459"></td><td class="line-content">                padding: 50,</td></tr><tr><td class="line-number" value="460"></td><td class="line-content">                duration: 1000</td></tr><tr><td class="line-number" value="461"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="462"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="463"></td><td class="line-content">        }).catch(error =&gt; console.error('Error loading images:', error));</td></tr><tr><td class="line-number" value="464"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="465"></td><td class="line-content">        updateBusLocation();</td></tr><tr><td class="line-number" value="466"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="467"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="468"></td><td class="line-content">    // Function to fetch and update bus location</td></tr><tr><td class="line-number" value="469"></td><td class="line-content">    function updateBusLocation() {</td></tr><tr><td class="line-number" value="470"></td><td class="line-content">        $.ajax({</td></tr><tr><td class="line-number" value="471"></td><td class="line-content">            url: `https://live.paj.com.my/get/MU004`,</td></tr><tr><td class="line-number" value="472"></td><td class="line-content">            method: 'get',</td></tr><tr><td class="line-number" value="473"></td><td class="line-content">            cache: false,</td></tr><tr><td class="line-number" value="474"></td><td class="line-content">            dataType: "json",</td></tr><tr><td class="line-number" value="475"></td><td class="line-content">            success: function(result) {</td></tr><tr><td class="line-number" value="476"></td><td class="line-content">                if (result.success) {</td></tr><tr><td class="line-number" value="477"></td><td class="line-content">                    let arrayData = Object.values(result.data);</td></tr><tr><td class="line-number" value="478"></td><td class="line-content">                    // Update bus positions in GeoJSON</td></tr><tr><td class="line-number" value="479"></td><td class="line-content">                    const newBusGeoJSON = {</td></tr><tr><td class="line-number" value="480"></td><td class="line-content">                        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="481"></td><td class="line-content">                        features: arrayData.map(bus =&gt; ({</td></tr><tr><td class="line-number" value="482"></td><td class="line-content">                            type: 'Feature',</td></tr><tr><td class="line-number" value="483"></td><td class="line-content">                            geometry: {</td></tr><tr><td class="line-number" value="484"></td><td class="line-content">                                type: 'Point',</td></tr><tr><td class="line-number" value="485"></td><td class="line-content">                                coordinates: [bus.lng, bus.lat]</td></tr><tr><td class="line-number" value="486"></td><td class="line-content">                            },</td></tr><tr><td class="line-number" value="487"></td><td class="line-content">                            properties: {</td></tr><tr><td class="line-number" value="488"></td><td class="line-content">                                busId: bus.bus,</td></tr><tr><td class="line-number" value="489"></td><td class="line-content">                                title: `Bus ${bus.bus}`,</td></tr><tr><td class="line-number" value="490"></td><td class="line-content">                                lastUpdate: bus.time</td></tr><tr><td class="line-number" value="491"></td><td class="line-content">                            }</td></tr><tr><td class="line-number" value="492"></td><td class="line-content">                        }))</td></tr><tr><td class="line-number" value="493"></td><td class="line-content">                    };</td></tr><tr><td class="line-number" value="494"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="495"></td><td class="line-content">                    try {</td></tr><tr><td class="line-number" value="496"></td><td class="line-content">                        map.getSource('bus').setData(newBusGeoJSON);</td></tr><tr><td class="line-number" value="497"></td><td class="line-content">                        // Update the sliding cards</td></tr><tr><td class="line-number" value="498"></td><td class="line-content">                        updateBusCards(arrayData);</td></tr><tr><td class="line-number" value="499"></td><td class="line-content">                    } catch (e) {</td></tr><tr><td class="line-number" value="500"></td><td class="line-content">                        // console.error('Error updating map:', e);</td></tr><tr><td class="line-number" value="501"></td><td class="line-content">                    }</td></tr><tr><td class="line-number" value="502"></td><td class="line-content">                } else {</td></tr><tr><td class="line-number" value="503"></td><td class="line-content">                    // console.log('Error:', result.message);</td></tr><tr><td class="line-number" value="504"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="505"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="506"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="507"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="508"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="509"></td><td class="line-content">    // Function to update bus cards</td></tr><tr><td class="line-number" value="510"></td><td class="line-content">    function updateBusCards(busData) {</td></tr><tr><td class="line-number" value="511"></td><td class="line-content">        const busCardsContainer = document.getElementById('busCards');</td></tr><tr><td class="line-number" value="512"></td><td class="line-content">        busCardsContainer.innerHTML = ''; // Clear existing cards</td></tr><tr><td class="line-number" value="513"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="514"></td><td class="line-content">        if (busData.length &lt; 3) {</td></tr><tr><td class="line-number" value="515"></td><td class="line-content">            // Center the container for a single bus</td></tr><tr><td class="line-number" value="516"></td><td class="line-content">            busCardsContainer.style.display = 'flex';</td></tr><tr><td class="line-number" value="517"></td><td class="line-content">            busCardsContainer.style.justifyContent = 'center';</td></tr><tr><td class="line-number" value="518"></td><td class="line-content">        } else {</td></tr><tr><td class="line-number" value="519"></td><td class="line-content">            // Restore default styles for multiple buses</td></tr><tr><td class="line-number" value="520"></td><td class="line-content">            busCardsContainer.style.display = 'block';</td></tr><tr><td class="line-number" value="521"></td><td class="line-content">            busCardsContainer.style.justifyContent = ''; // Clear the justifyContent</td></tr><tr><td class="line-number" value="522"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="523"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="524"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="525"></td><td class="line-content">        busData.forEach(bus =&gt; {</td></tr><tr><td class="line-number" value="526"></td><td class="line-content">            const card = document.createElement('div');</td></tr><tr><td class="line-number" value="527"></td><td class="line-content">            card.className = 'bus-card';</td></tr><tr><td class="line-number" value="528"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="529"></td><td class="line-content">            // Check if the last update is within the last 30 minutes</td></tr><tr><td class="line-number" value="530"></td><td class="line-content">            const lastUpdateTime = new Date(bus.time);</td></tr><tr><td class="line-number" value="531"></td><td class="line-content">            // const timeDifferenceInMinutes = (currentTime - lastUpdateTime) / (1000 * 60);</td></tr><tr><td class="line-number" value="532"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="533"></td><td class="line-content">            // if (timeDifferenceInMinutes &lt;= 30) {</td></tr><tr><td class="line-number" value="534"></td><td class="line-content">            //     card.style.background = 'rgb(20,192,80)'; // Light green background</td></tr><tr><td class="line-number" value="535"></td><td class="line-content">            // }</td></tr><tr><td class="line-number" value="536"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="537"></td><td class="line-content">            card.onclick = () =&gt; {</td></tr><tr><td class="line-number" value="538"></td><td class="line-content">                // Remove active class from all cards</td></tr><tr><td class="line-number" value="539"></td><td class="line-content">                document.querySelectorAll('.bus-card').forEach(c =&gt; c.classList.remove('active'));</td></tr><tr><td class="line-number" value="540"></td><td class="line-content">                // Add active class to clicked card</td></tr><tr><td class="line-number" value="541"></td><td class="line-content">                card.classList.add('active');</td></tr><tr><td class="line-number" value="542"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="543"></td><td class="line-content">                // Fly to bus location</td></tr><tr><td class="line-number" value="544"></td><td class="line-content">                map.flyTo({</td></tr><tr><td class="line-number" value="545"></td><td class="line-content">                    center: [bus.lng, bus.lat],</td></tr><tr><td class="line-number" value="546"></td><td class="line-content">                    zoom: 15,</td></tr><tr><td class="line-number" value="547"></td><td class="line-content">                    duration: 1000</td></tr><tr><td class="line-number" value="548"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="549"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="550"></td><td class="line-content">                // Show popup for the bus</td></tr><tr><td class="line-number" value="551"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="552"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="553"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="554"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="555"></td><td class="line-content">                    .setLngLat([bus.lng, bus.lat])</td></tr><tr><td class="line-number" value="556"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="557"></td><td class="line-content">                    &lt;p class="bus-stop-name"&gt;Bus ${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="558"></td><td class="line-content">                    &lt;p style="margin: 0 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdateTime.toLocaleString()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="559"></td><td class="line-content">                `)</td></tr><tr><td class="line-number" value="560"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="561"></td><td class="line-content">            };</td></tr><tr><td class="line-number" value="562"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="563"></td><td class="line-content">            let time = new Date(bus.time);</td></tr><tr><td class="line-number" value="564"></td><td class="line-content">            let now = new Date();</td></tr><tr><td class="line-number" value="565"></td><td class="line-content">            let timeDifference = (now - time) / (1000 * 60); // Difference in minutes</td></tr><tr><td class="line-number" value="566"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="567"></td><td class="line-content">            let onlineStat = '';</td></tr><tr><td class="line-number" value="568"></td><td class="line-content">            // Apply green background if less than 30 minutes</td></tr><tr><td class="line-number" value="569"></td><td class="line-content">            if (timeDifference &lt; 30) {</td></tr><tr><td class="line-number" value="570"></td><td class="line-content">                // add a class to the card</td></tr><tr><td class="line-number" value="571"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream mt-1 fs-2 online" style="color: #0fa354 !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="572"></td><td class="line-content">                card.classList.add('online');</td></tr><tr><td class="line-number" value="573"></td><td class="line-content">                card.classList.remove('offline');</td></tr><tr><td class="line-number" value="574"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="575"></td><td class="line-content">            else {</td></tr><tr><td class="line-number" value="576"></td><td class="line-content">                // remove the class</td></tr><tr><td class="line-number" value="577"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream-slash mt-1 fs-2 offline" style="color: #ff274f !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="578"></td><td class="line-content">                card.classList.remove('online');</td></tr><tr><td class="line-number" value="579"></td><td class="line-content">                card.classList.add('offline');</td></tr><tr><td class="line-number" value="580"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="581"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="582"></td><td class="line-content">            // Format time as dd/mm/yyyy hh:mm:ss AM/PM</td></tr><tr><td class="line-number" value="583"></td><td class="line-content">            let timeString = time.toLocaleString('en-GB', {hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true});</td></tr><tr><td class="line-number" value="584"></td><td class="line-content">            card.innerHTML = `</td></tr><tr><td class="line-number" value="585"></td><td class="line-content">                &lt;div class="d-flex justify-content-between"&gt;</td></tr><tr><td class="line-number" value="586"></td><td class="line-content">                    &lt;div class="d-flex"&gt;</td></tr><tr><td class="line-number" value="587"></td><td class="line-content">                        &lt;div class="legend-icon me-1" style="background-image: url(https://live.paj.com.my/assets/bus-marker.png)"&gt;&lt;/div&gt;</td></tr><tr><td class="line-number" value="588"></td><td class="line-content">                        &lt;p class="bus-id mb-0 fs-4 fw-bold"&gt;${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="589"></td><td class="line-content">                    &lt;/div&gt;</td></tr><tr><td class="line-number" value="590"></td><td class="line-content">                    ${onlineStat}</td></tr><tr><td class="line-number" value="591"></td><td class="line-content">                &lt;/div&gt;</td></tr><tr><td class="line-number" value="592"></td><td class="line-content">                &lt;p class="last-update fs-7 fw-bold"&gt;&lt;i class="fa-solid fa-clock ms-1 me-2 text-primary"&gt;&lt;/i&gt;${timeString.toUpperCase()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="593"></td><td class="line-content">            `;</td></tr><tr><td class="line-number" value="594"></td><td class="line-content">            busCardsContainer.appendChild(card);</td></tr><tr><td class="line-number" value="595"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="596"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="597"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="598"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="599"></td><td class="line-content">    // interval to update bus location</td></tr><tr><td class="line-number" value="600"></td><td class="line-content">    setInterval(updateBusLocation, 10000);</td></tr><tr><td class="line-number" value="601"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="602"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="603"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span></td></tr><tr><td class="line-number" value="604"></td><td class="line-content"><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>