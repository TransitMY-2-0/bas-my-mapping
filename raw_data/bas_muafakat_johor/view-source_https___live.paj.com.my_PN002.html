
<!-- saved from url=(0029)https://live.paj.com.my/PN002 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="color-scheme" content="light dark"></head><body><div class="line-gutter-backdrop"></div><form autocomplete="off"><label class="line-wrap-control">Line wrap<input type="checkbox" aria-label="Line wrap"></label></form><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content">    <span class="html-tag">&lt;title&gt;</span>Jejak Kedudukan Bas Muafakat Johor<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">UTF-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">viewport</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">width=device-width, initial-scale=1.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">description</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Jejak Kedudukan Bas Muafakat Johor</span>"/&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">shortcut icon</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-paj.png" rel="noreferrer noopener">/assets/logo-paj.png</a>"/&gt;</span></td></tr><tr><td class="line-number" value="9"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="10"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/plugins/global/plugins.bundle.css" rel="noreferrer noopener">/assets/plugins/global/plugins.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/css/style.bundle.css" rel="noreferrer noopener">/assets/css/style.bundle.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"/&gt;</span></td></tr><tr><td class="line-number" value="12"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css" rel="noreferrer noopener">https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">    <span class="html-tag">&lt;style&gt;</span></td></tr><tr><td class="line-number" value="14"></td><td class="line-content">        body {</td></tr><tr><td class="line-number" value="15"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="16"></td><td class="line-content">            padding: 0;</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">        #map {</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">            top: 0;</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">            bottom: 0;</td></tr><tr><td class="line-number" value="22"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="23"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="24"></td><td class="line-content">        .legend-card {</td></tr><tr><td class="line-number" value="25"></td><td class="line-content">            position: absolute;</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">            top: 10px;</td></tr><tr><td class="line-number" value="27"></td><td class="line-content">            right: 10px;</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">            background: white;</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">            padding-top: 3px;</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">            box-shadow: 0 2px 4px rgba(0,0,0,0.1);</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">            z-index: 1;</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">            max-width: 200px;</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">        .legend-title {</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">            font-weight: 600;</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">            margin: 0 0 10px 0;</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="42"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="43"></td><td class="line-content">        .legend-item {</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">            display: flex;</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">            align-items: center;</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">            margin-bottom: 8px;</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">        .legend-item:last-child {</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">            margin-bottom: 0;</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="51"></td><td class="line-content">        .legend-icon {</td></tr><tr><td class="line-number" value="52"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">            height: 20px;</td></tr><tr><td class="line-number" value="54"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="55"></td><td class="line-content">            background-size: contain;</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">            background-repeat: no-repeat;</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">            background-position: center;</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="59"></td><td class="line-content">        .legend-text {</td></tr><tr><td class="line-number" value="60"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">        .legend-route {</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">            background-color: #ff0000;</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">            width: 20px;</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">            height: 3px;</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">            margin-right: 8px;</td></tr><tr><td class="line-number" value="68"></td><td class="line-content">            border-radius: 2px;</td></tr><tr><td class="line-number" value="69"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">        .mapboxgl-popup-content {</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">            padding: 15px;</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="73"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="74"></td><td class="line-content">        .bus-stop-name {</td></tr><tr><td class="line-number" value="75"></td><td class="line-content">            font-weight: bold;</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="77"></td><td class="line-content">            color: #333;</td></tr><tr><td class="line-number" value="78"></td><td class="line-content">            font-size: 14px;</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="80"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="81"></td><td class="line-content">        /* New styles for the sliding cards */</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">        .bus-cards-container {</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">            position: fixed;</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">            bottom: 30px;</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">            left: 50%;</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">            transform: translateX(-50%);</td></tr><tr><td class="line-number" value="87"></td><td class="line-content">            /*height: 50px;*/</td></tr><tr><td class="line-number" value="88"></td><td class="line-content">            background: transparent;</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">            overflow-x: auto;</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">            white-space: nowrap;</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">            padding-top: 10px;</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">            padding-bottom: 10px;</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">            padding-left: 10px;</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">            /*padding-bottom: 10px;*/</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">            scrollbar-width: none; /* Firefox */</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">            -ms-overflow-style: none; /* IE and Edge */</td></tr><tr><td class="line-number" value="97"></td><td class="line-content">            z-index: 1000;</td></tr><tr><td class="line-number" value="98"></td><td class="line-content">            width: 100%;</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">            max-width: 1200px;</td></tr><tr><td class="line-number" value="100"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="101"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="102"></td><td class="line-content">        /*.bus-cards-container::-webkit-scrollbar {*/</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">        /*    display: none; !* Chrome, Safari, Opera *!*/</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="105"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="106"></td><td class="line-content">        .bus-card {</td></tr><tr><td class="line-number" value="107"></td><td class="line-content">            display: inline-block;</td></tr><tr><td class="line-number" value="108"></td><td class="line-content">            width: 160px;</td></tr><tr><td class="line-number" value="109"></td><td class="line-content">            height: 60px;</td></tr><tr><td class="line-number" value="110"></td><td class="line-content">            margin-right: 10px;</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">            background: rgba(255, 255, 255, 0.9);</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">            border-radius: 8px;</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">            padding: 10px;</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">            vertical-align: top;</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">            cursor: pointer;</td></tr><tr><td class="line-number" value="117"></td><td class="line-content">            transition: all 0.2s ease;</td></tr><tr><td class="line-number" value="118"></td><td class="line-content">            backdrop-filter: blur(5px);</td></tr><tr><td class="line-number" value="119"></td><td class="line-content">            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; /* Add this line */</td></tr><tr><td class="line-number" value="120"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="121"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="122"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="123"></td><td class="line-content">        .bus-card:hover {</td></tr><tr><td class="line-number" value="124"></td><td class="line-content">            transform: translateY(-2px);</td></tr><tr><td class="line-number" value="125"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="126"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="127"></td><td class="line-content">        .bus-card.active {</td></tr><tr><td class="line-number" value="128"></td><td class="line-content">            background: #e3f2fd;</td></tr><tr><td class="line-number" value="129"></td><td class="line-content">            border: 2px solid #2196f3;</td></tr><tr><td class="line-number" value="130"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="131"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="132"></td><td class="line-content">        .bus-id {</td></tr><tr><td class="line-number" value="133"></td><td class="line-content">            /*font-weight: bold;*/</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">            /*font-size: 16px;*/</td></tr><tr><td class="line-number" value="135"></td><td class="line-content">            color: #434343;</td></tr><tr><td class="line-number" value="136"></td><td class="line-content">            margin: 0 0 5px 0;</td></tr><tr><td class="line-number" value="137"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="138"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="139"></td><td class="line-content">        .last-update {</td></tr><tr><td class="line-number" value="140"></td><td class="line-content">            font-size: 12px;</td></tr><tr><td class="line-number" value="141"></td><td class="line-content">            color: #666;</td></tr><tr><td class="line-number" value="142"></td><td class="line-content">            margin: 0;</td></tr><tr><td class="line-number" value="143"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="144"></td><td class="line-content">        .online {</td></tr><tr><td class="line-number" value="145"></td><td class="line-content">            /*background: #0fa354;*/</td></tr><tr><td class="line-number" value="146"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="147"></td><td class="line-content">        .offline {</td></tr><tr><td class="line-number" value="148"></td><td class="line-content">            background: #dadada;</td></tr><tr><td class="line-number" value="149"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="150"></td><td class="line-content">        /*.logo-container img {*/</td></tr><tr><td class="line-number" value="151"></td><td class="line-content">        /*    height: 40px;*/</td></tr><tr><td class="line-number" value="152"></td><td class="line-content">        /*    width: auto;*/</td></tr><tr><td class="line-number" value="153"></td><td class="line-content">        /*}*/</td></tr><tr><td class="line-number" value="154"></td><td class="line-content"> .back-btn{</td></tr><tr><td class="line-number" value="155"></td><td class="line-content">      display:inline-flex;</td></tr><tr><td class="line-number" value="156"></td><td class="line-content">      align-items:center;</td></tr><tr><td class="line-number" value="157"></td><td class="line-content">      gap:8px;</td></tr><tr><td class="line-number" value="158"></td><td class="line-content">      margin-top:10px;</td></tr><tr><td class="line-number" value="159"></td><td class="line-content">      padding:8px 12px;</td></tr><tr><td class="line-number" value="160"></td><td class="line-content">      border-radius:8px;</td></tr><tr><td class="line-number" value="161"></td><td class="line-content">      border:1px solid rgba(0,0,0,.08);</td></tr><tr><td class="line-number" value="162"></td><td class="line-content">      background:#f4f6f8;</td></tr><tr><td class="line-number" value="163"></td><td class="line-content">      font-size:12px;</td></tr><tr><td class="line-number" value="164"></td><td class="line-content">      font-weight:600;</td></tr><tr><td class="line-number" value="165"></td><td class="line-content">      color:#2b2e34;</td></tr><tr><td class="line-number" value="166"></td><td class="line-content">      text-decoration:none;</td></tr><tr><td class="line-number" value="167"></td><td class="line-content">      box-shadow:0 1px 2px rgba(0,0,0,.06);</td></tr><tr><td class="line-number" value="168"></td><td class="line-content">      transition:transform .12s ease, background .12s ease;</td></tr><tr><td class="line-number" value="169"></td><td class="line-content">  }</td></tr><tr><td class="line-number" value="170"></td><td class="line-content">  .back-btn:hover{ background:#e9ecef; transform:translateY(-1px); }</td></tr><tr><td class="line-number" value="171"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="172"></td><td class="line-content">  .legend-card{ z-index: 2001!important; } /* pastikan atas Mapbox controls */</td></tr><tr><td class="line-number" value="173"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="174"></td><td class="line-content">  .legend-nav {</td></tr><tr><td class="line-number" value="175"></td><td class="line-content">    display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;</td></tr><tr><td class="line-number" value="176"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="177"></td><td class="line-content">.legend-btn {</td></tr><tr><td class="line-number" value="178"></td><td class="line-content">    display:inline-flex; align-items:center; gap:6px;</td></tr><tr><td class="line-number" value="179"></td><td class="line-content">    background:#f4f6f8; border:1px solid #e2e8f0; border-radius:8px;</td></tr><tr><td class="line-number" value="180"></td><td class="line-content">    padding:8px 10px; font-size:12px; color:#333; text-decoration:none;</td></tr><tr><td class="line-number" value="181"></td><td class="line-content">    box-shadow:0 1px 2px rgba(0,0,0,.05);</td></tr><tr><td class="line-number" value="182"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="183"></td><td class="line-content">.legend-btn:hover { background:#eef2f6; }</td></tr><tr><td class="line-number" value="184"></td><td class="line-content">.legend-btn .kecil { opacity:.7; font-weight:600; }</td></tr><tr><td class="line-number" value="185"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="186"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="187"></td><td class="line-content">    <span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="188"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="189"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://unpkg.com/@turf/turf@6.5.0/turf.min.js" rel="noreferrer noopener">https://unpkg.com/@turf/turf@6.5.0/turf.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="190"></td><td class="line-content"><span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="191"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><span class="html-tag">&lt;body&gt;</span></td></tr><tr><td class="line-number" value="193"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">map</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="194"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bus-cards-container</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">busCards</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="195"></td><td class="line-content"><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-card text-center</span>"&gt;</span></td></tr><tr><td class="line-number" value="196"></td><td class="line-content">    <span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://live.paj.com.my/assets/logo-main.png" rel="noreferrer noopener">https://live.paj.com.my/assets/logo-main.png</a>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">logo-container mt-2</span>" <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">Logo</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width: 70px; height: auto;</span>"&gt;</span></td></tr><tr><td class="line-number" value="197"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="198"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="199"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="200"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Bas<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="201"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="202"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="203"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-icon</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">background-image: url(https://live.paj.com.my/assets/bus-stop-marker.png)</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="204"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Perhentian<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="205"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="206"></td><td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-item</span>"&gt;</span></td></tr><tr><td class="line-number" value="207"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-route</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="208"></td><td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">legend-text</span>"&gt;</span>Laluan<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="209"></td><td class="line-content">    <span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="210"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="211"></td><td class="line-content">    <span class="html-comment">&lt;!-- NEW: Butang Kembali --&gt;</span></td></tr><tr><td class="line-number" value="212"></td><td class="line-content">    <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">back-btn</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://live.paj.com.my/" rel="noreferrer noopener">https://live.paj.com.my</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">btnBack</span>"&gt;</span></td></tr><tr><td class="line-number" value="213"></td><td class="line-content">        <span class="html-comment">&lt;!-- ikon anak panah kecil (SVG inline supaya tiada dependensi) --&gt;</span></td></tr><tr><td class="line-number" value="214"></td><td class="line-content">        <span class="html-tag">&lt;svg <span class="html-attribute-name">width</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">14</span>" <span class="html-attribute-name">viewBox</span>="<span class="html-attribute-value">0 0 24 24</span>" <span class="html-attribute-name">fill</span>="<span class="html-attribute-value">none</span>" <span class="html-attribute-name">aria-hidden</span>="<span class="html-attribute-value">true</span>"&gt;</span></td></tr><tr><td class="line-number" value="215"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M10 19l-7-7 7-7</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="216"></td><td class="line-content">          <span class="html-tag">&lt;path <span class="html-attribute-name">d</span>="<span class="html-attribute-value">M3 12h18</span>" <span class="html-attribute-name">stroke</span>="<span class="html-attribute-value">#2b2e34</span>" <span class="html-attribute-name">stroke-width</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">stroke-linecap</span>="<span class="html-attribute-value">round</span>" <span class="html-attribute-name">stroke-linejoin</span>="<span class="html-attribute-value">round</span>"/&gt;</span></td></tr><tr><td class="line-number" value="217"></td><td class="line-content">        <span class="html-tag">&lt;/svg&gt;</span></td></tr><tr><td class="line-number" value="218"></td><td class="line-content">        Kembali</td></tr><tr><td class="line-number" value="219"></td><td class="line-content">    <span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="220"></td><td class="line-content"><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="221"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://code.jquery.com/jquery-3.6.0.min.js" rel="noreferrer noopener">https://code.jquery.com/jquery-3.6.0.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="222"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js" rel="noreferrer noopener">https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="223"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="224"></td><td class="line-content">    let geojson = {"name":"PN002 ","type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"LineString","coordinates":[[103.5180711126269,1.498806404563059],[103.5178384995732,1.499207268418888],[103.5174128827819,1.501222736408671],[103.517392116638,1.501575823501706],[103.5173172415982,1.502068723143793],[103.5172958577334,1.502256675270759],[103.5172773270837,1.502568273187299],[103.5171387832221,1.503027643418567],[103.5169766986006,1.503208021742958],[103.5156557279775,1.504400387659184],[103.5149672422144,1.50531723423587],[103.514044987992,1.506625264054865],[103.5134945838482,1.507071270834788],[103.5109935781355,1.507880941544542],[103.51162697439,1.510432854032527],[103.5122534824167,1.512910707816514],[103.5129005729455,1.515297646852365],[103.513588174713,1.517945864999759],[103.5143152776912,1.520544522024501],[103.5149004821191,1.5226116632833],[103.5151836623088,1.524078080655558],[103.5125650024532,1.524943172993253],[103.5104027133962,1.525524206635993],[103.5088146875401,1.526168683180563],[103.5072647764331,1.526570492513079],[103.5049527994004,1.527097851129475],[103.5042622576692,1.527468028087106],[103.5040246823514,1.527702969154056],[103.5033886448907,1.528824640670572],[103.5021820495585,1.530796676822338],[103.5005983514449,1.533194299208035],[103.4993140678277,1.535367504880133],[103.4987805413789,1.536081964998351],[103.4980719660775,1.536847912228937],[103.4967877209746,1.538345549965966],[103.4956744902496,1.539759470630959],[103.4949601093021,1.540806968365865],[103.4943781981429,1.542197075070746],[103.4938364513083,1.543548959128567],[103.4935912157939,1.544413618961999],[103.4931764668527,1.5459276691048],[103.492797979191,1.547438306220611],[103.4921908258414,1.549655630302314],[103.491759548933,1.55141230179123],[103.4913869944541,1.552781157698276],[103.4911504057511,1.553512656505802],[103.4908960171022,1.553997998336957],[103.490608459101,1.554339417371573],[103.4905270894851,1.554517066584951],[103.4906142092672,1.554805967580979],[103.4905232446826,1.555080189376345],[103.4901946017595,1.555913081882996],[103.4901802289993,1.556111091024495],[103.4902404315208,1.556383360024942],[103.4903318182554,1.556747433299491],[103.4904648610576,1.557688210800583],[103.4903927758787,1.558110271005746],[103.4900902382155,1.558582617767014],[103.4894481372584,1.55921509359292],[103.4893268087425,1.559539676948449],[103.4892486977651,1.560083607067158],[103.4891998943032,1.560717955624824],[103.4893395586346,1.561165700015861],[103.4898388762085,1.56299829885024],[103.4899955266641,1.56391977669542],[103.4899919437668,1.56420995942398],[103.4894046323044,1.565168715181555],[103.4886372358497,1.566374517675996],[103.4881713184935,1.566971614835519],[103.4881131372815,1.567322205929204],[103.4881243065706,1.567829633171135],[103.4881505618248,1.568303303839881],[103.4882658937136,1.569264836876608],[103.488423766874,1.569530939272726],[103.4888812360488,1.569973661877482],[103.4896023539549,1.570704055813573],[103.4898824249551,1.570980926738635],[103.4899502154598,1.571512949235155],[103.4896911715808,1.573558253428977],[103.4896511981263,1.574784333297177],[103.4896793467785,1.576282804320705],[103.4905815959454,1.577779834796942],[103.4911198428054,1.578637645331528],[103.4915526050598,1.578992092279925],[103.4921155648576,1.579398240904042],[103.4930578857106,1.57996037300474],[103.4939366681056,1.580082227430761],[103.4942303058415,1.580221362332428],[103.4945286973428,1.580549023478168],[103.4947017377128,1.580996017295121],[103.4950810462075,1.582296257523522],[103.4966517405259,1.583443102402114],[103.4977009392637,1.583893807135067],[103.4983449158068,1.584246393987463],[103.4989755712238,1.584611882282433],[103.4997917068857,1.585114811868376],[103.5003860203763,1.58577549438077],[103.5005692531012,1.585936515566653],[103.5007239023947,1.58597609793107],[103.5014456759773,1.58626512005315],[103.5021606180668,1.586845212158063],[103.5025160502572,1.58702815181426],[103.5033216781909,1.586945487690272],[103.50371801739,1.586894553500484],[103.5040156388081,1.586957260969815],[103.5044356577015,1.587287545604693],[103.5047584736175,1.587394322470384],[103.5052056753929,1.587381067464135],[103.5057164207052,1.587432707815679],[103.5062076961086,1.587538583059496],[103.5068167827291,1.587465759354502],[103.5073254388109,1.587249608128834],[103.5077823138267,1.587078227461432],[103.5082522029357,1.587217233120252],[103.5084836263746,1.587407811307258],[103.5087092427638,1.587637039600836],[103.5088270866608,1.587918100890883],[103.5088045359599,1.588221628558927],[103.5088307291778,1.589719793423215],[103.5088611159598,1.590566237219456],[103.5089677042517,1.5908523163004],[103.5094871510471,1.591589892094448],[103.510138963392,1.592540674035814],[103.5103930364662,1.592899348858782],[103.5104810948232,1.592807966963165],[103.510798470603,1.592650682783561],[103.5104154907966,1.592754652950691],[103.5101503334016,1.592374599823958],[103.5096301743478,1.591657038766852],[103.5091679029515,1.590982143411965],[103.5089053683455,1.590555164739926],[103.5087722129198,1.588938661723728],[103.5087487512062,1.587908351090329],[103.5086429599175,1.587657873810212],[103.5083179052928,1.58733151548735],[103.5077402278312,1.587149963809396],[103.5069212694738,1.58734964018973],[103.5064579898639,1.587462693154476],[103.5060290406778,1.587462874327157],[103.5049187793947,1.587463330487058],[103.5045153259297,1.587363207818466],[103.5039918943324,1.586990911575342],[103.5033843493661,1.586962424095441],[103.502957473808,1.587007402423221],[103.5025751671995,1.587056241650883],[103.5022042744693,1.586825928893897],[103.5017147473519,1.586398323756955],[103.5010536431533,1.586078887095928],[103.5005714148009,1.585874668574266],[103.5001839273056,1.585510072352859],[103.4998874839701,1.585179706953747],[103.4994203655737,1.58483246300491],[103.4985054273302,1.584300129574604],[103.4977558693162,1.583873173816572],[103.4967083091096,1.583411138630932],[103.4942720015893,1.585956161704958],[103.4814484993952,1.599695677500087],[103.4747603331494,1.593482344538027],[103.4744066562525,1.592885560663672],[103.4731021347567,1.591522333077135],[103.4719040985941,1.590230071909749],[103.4712639312371,1.589276850130876],[103.4693802850017,1.587789972156908],[103.4677589068175,1.586338977283408],[103.4667427987855,1.586087794230526],[103.4653398234939,1.585967639560416],[103.4638641903912,1.58555910354415],[103.4640957944456,1.584649573345439],[103.4642200430001,1.584127992603683],[103.4644284385708,1.583534222244833],[103.4646164966513,1.582966145260573],[103.464753779814,1.582507034810212],[103.4648235800912,1.582142628863874],[103.4649043224432,1.581837644289672],[103.4650398616681,1.581462668191362],[103.4652095275297,1.58114256620882],[103.4654615024816,1.5806396697059],[103.4656415690451,1.580106378742966],[103.4657734592026,1.579611142374456],[103.4658815139535,1.579250754759641],[103.4660998421297,1.578454009451615],[103.4665134049309,1.576739155156641],[103.4666345783226,1.576188217315496],[103.4669657072901,1.574845411357301],[103.4672453143646,1.5736944071004],[103.4674629060579,1.572918947265803],[103.4678813123277,1.571745312283822],[103.4680669676158,1.571213790983375],[103.4682087932516,1.570980691185893],[103.4684365467848,1.570740858885425],[103.4690723657791,1.570212711489996],[103.4693610580662,1.569982409240122],[103.4706805244488,1.568988913496243],[103.4716757013356,1.568252153709858],[103.4742156195135,1.566659433798205],[103.4756431884592,1.566026658967881],[103.4756936335574,1.566009959582851],[103.4776898517669,1.565461698699555],[103.4786389060589,1.565130139299979],[103.480690586999,1.562899472748435],[103.4818564327211,1.561283987940922],[103.4822968618418,1.560585046449909],[103.4834272185869,1.559891273592313],[103.4848412438211,1.559300505335024],[103.4854482696758,1.558472213220128],[103.4856685029655,1.557847505075091],[103.4858431319717,1.557324193962532],[103.4861650844396,1.556828498372027],[103.4872343910651,1.556546953509703],[103.4876832288981,1.556268365711203],[103.4887160412023,1.55559387566443],[103.4905096488243,1.554334530971303],[103.4909496962381,1.553870732379957],[103.4912076939773,1.553192552910211],[103.4916296708861,1.551560710599518],[103.4917989192109,1.550853193875214],[103.4926849596262,1.547478976504948],[103.4937462123799,1.543637385903141],[103.4948208298059,1.540954530840626],[103.4959517022107,1.539284980656327],[103.498323675507,1.536477653639039],[103.4992525988569,1.535369852171455],[103.5024805878796,1.530216094458099],[103.5034723562304,1.528508063092938],[103.5040736387029,1.527508785985762],[103.5049090720919,1.52705539503266],[103.5075948893622,1.526468700334684],[103.5105486641213,1.525417543207077],[103.5146222665911,1.524253858519496],[103.5151819091123,1.524022770505582],[103.5149018786679,1.522836912198922],[103.5136824071053,1.518636840236175],[103.5130218065188,1.516013900409498],[103.5120610350967,1.512595824574205],[103.5115307425497,1.510330208520103],[103.5111765234582,1.509348793771936],[103.5111515519527,1.508939286385106],[103.5108984896303,1.507872098984024],[103.5135191942818,1.507161842420268],[103.5140442547004,1.506838315355777],[103.5148959365121,1.505573789865753],[103.5157094352927,1.504456611822909],[103.5165487281341,1.50375174646642],[103.5172292057536,1.503084520028404],[103.5173743032872,1.502480540542739],[103.5174433086638,1.502000031865651],[103.5176033546022,1.500566678204884],[103.5176856070521,1.500113598055687],[103.5180007685446,1.499253246556653],[103.51823471342,1.498861253287411],[103.5183932989302,1.498603690409045],[103.518603158305,1.49830530767875],[103.5189094920273,1.498023193563267],[103.5192316545956,1.497773248239826],[103.5192477812038,1.497765176064324],[103.5194737891116,1.497635954363643],[103.5199182488734,1.497579331111426],[103.5208673160032,1.497516433551388],[103.5213997866256,1.497500245701547],[103.5217080049894,1.497467903928376],[103.5220964496847,1.497370823818131],[103.5234646296816,1.496884312563795],[103.524588998066,1.496489507613401],[103.5252692458456,1.496245243201494],[103.5260297953523,1.495969788891223],[103.5265550500758,1.495832101625524],[103.5272086540076,1.495725959970202],[103.5285955462875,1.495619859536905],[103.5292408752501,1.495571346140421],[103.5295286777354,1.495594819823863],[103.5296344110129,1.495441919380418],[103.5296201106476,1.495216405053157],[103.5293864477198,1.49509542285115],[103.5289035374865,1.494920817843965],[103.5285006869196,1.494864406642812],[103.528160190198,1.49492097524649],[103.5281199020489,1.494937129616035],[103.5273938544984,1.495260286336625],[103.527377697024,1.495260286444537],[103.524305348262,1.496470730331677],[103.5220277850207,1.497299886941627],[103.5216495080748,1.497414899276623],[103.5211076087516,1.497438959480692],[103.5199699624062,1.497468829270866],[103.5194351045325,1.497525350577529],[103.5189583909199,1.497799636008095],[103.5183532386433,1.498419493026032],[103.5180711126269,1.498806404563059]]}}]};</td></tr><tr><td class="line-number" value="225"></td><td class="line-content">    let pois = [{"name":"Kampung Seri Menanti","lat":"1.58524000","lng":"103.46400000"},{"name":"Kampung Pak Kalib","lat":"1.56548000","lng":"103.47767000"},{"name":"Sk Kampung Sawah","lat":"1.54324593","lng":"103.49380060"},{"name":"Klinik Kesihatan Pekan Nenas","lat":"1.52177000","lng":"103.51451000"},{"name":"SMK Dato Mohd. Yunos Sulaiman","lat":"1.51944856","lng":"103.51379700"},{"name":"Sekolah Agama Kampung Sawah","lat":"1.54407809","lng":"103.49373170"},{"name":"Jalan Sawah, Taman Damai","lat":"1.52247268","lng":"103.51465820"},{"name":"SMK Dato Mohd. Yunos Sulaiman (hala ke pekan nenas)","lat":"1.51956905","lng":"103.51404180"},{"name":"SMK Pekan Nenas","lat":"1.51476764","lng":"103.51285370"},{"name":"Sekolah Agama Pekan Nenas","lat":"1.51218761","lng":"103.51208940"},{"name":"Opposite Sekolah Agama Pekan Nenas","lat":"1.51240861","lng":"103.51201000"},{"name":"Taman Utama,Jalan Skudai - Pontian","lat":"1.50323519","lng":"103.51710770"},{"name":"Maybank Pekan Nanas","lat":"1.50213428","lng":"103.51723730"},{"name":"Pekan Nenas Batu 26,Jalan Skudai - Pontian","lat":"1.49883688","lng":"103.51806300"},{"name":"Taman Perindustrian Pekan Nenas 1,Jalan Skudai - Pontian","lat":"1.49714616","lng":"103.52229920"},{"name":"Kampung Seri Menanti (2)","lat":"1.57831850","lng":"103.46615780"},{"name":"Kampung Seri Menanti (3)","lat":"1.56844439","lng":"103.47143370"},{"name":"Taman Perindustrian Pekan Nenas 1,Jalan Skudai - Pontian","lat":"1.49714616","lng":"103.52229920"}];</td></tr><tr><td class="line-number" value="226"></td><td class="line-content">    let imageBusStop = 'https://live.paj.com.my/assets/bus-stop-marker.png';</td></tr><tr><td class="line-number" value="227"></td><td class="line-content">    let imageArrows = 'https://live.paj.com.my/assets/arrow-markers-red.png';</td></tr><tr><td class="line-number" value="228"></td><td class="line-content">    let imageBus = 'https://live.paj.com.my/assets/bus-marker.png';</td></tr><tr><td class="line-number" value="229"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="230"></td><td class="line-content">    // Convert POIs to GeoJSON format</td></tr><tr><td class="line-number" value="231"></td><td class="line-content">    const poisGeoJSON = {</td></tr><tr><td class="line-number" value="232"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="233"></td><td class="line-content">        features: pois.map(poi =&gt; ({</td></tr><tr><td class="line-number" value="234"></td><td class="line-content">            type: 'Feature',</td></tr><tr><td class="line-number" value="235"></td><td class="line-content">            geometry: {</td></tr><tr><td class="line-number" value="236"></td><td class="line-content">                type: 'Point',</td></tr><tr><td class="line-number" value="237"></td><td class="line-content">                coordinates: [parseFloat(poi.lng), parseFloat(poi.lat)]</td></tr><tr><td class="line-number" value="238"></td><td class="line-content">            },</td></tr><tr><td class="line-number" value="239"></td><td class="line-content">            properties: {</td></tr><tr><td class="line-number" value="240"></td><td class="line-content">                name: poi.name</td></tr><tr><td class="line-number" value="241"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="242"></td><td class="line-content">        }))</td></tr><tr><td class="line-number" value="243"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="244"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="245"></td><td class="line-content">    // Create initial bus GeoJSON with empty features</td></tr><tr><td class="line-number" value="246"></td><td class="line-content">    const busGeoJSON = {</td></tr><tr><td class="line-number" value="247"></td><td class="line-content">        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="248"></td><td class="line-content">        features: []</td></tr><tr><td class="line-number" value="249"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="250"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="251"></td><td class="line-content">    mapboxgl.accessToken = 'pk.eyJ1IjoiYWxpZmRhcnNpbSIsImEiOiJjbTRjZ3djcmIwNTMxMmlxcGZvZWx1eTFqIn0.X3VV1PhXekp3_HAwoB6kbw';</td></tr><tr><td class="line-number" value="252"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="253"></td><td class="line-content">    // Initialize map with default center</td></tr><tr><td class="line-number" value="254"></td><td class="line-content">    const map = new mapboxgl.Map({</td></tr><tr><td class="line-number" value="255"></td><td class="line-content">        container: 'map',</td></tr><tr><td class="line-number" value="256"></td><td class="line-content">        style: 'mapbox://styles/mapbox/streets-v12',</td></tr><tr><td class="line-number" value="257"></td><td class="line-content">        center: [103.317818, 2.029433],</td></tr><tr><td class="line-number" value="258"></td><td class="line-content">        zoom: 8</td></tr><tr><td class="line-number" value="259"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="260"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="261"></td><td class="line-content">    // Wait for map to load before adding layers</td></tr><tr><td class="line-number" value="262"></td><td class="line-content">    map.on('load', () =&gt; {</td></tr><tr><td class="line-number" value="263"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="264"></td><td class="line-content">        // Load both bus stop and bus icons</td></tr><tr><td class="line-number" value="265"></td><td class="line-content">        Promise.all([</td></tr><tr><td class="line-number" value="266"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="267"></td><td class="line-content">                map.loadImage(imageBusStop, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="268"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="269"></td><td class="line-content">                    map.addImage('bus-stop-icon', image);</td></tr><tr><td class="line-number" value="270"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="271"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="272"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="273"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="274"></td><td class="line-content">                map.loadImage(imageBus, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="275"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="276"></td><td class="line-content">                    map.addImage('bus-icon', image);</td></tr><tr><td class="line-number" value="277"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="278"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="279"></td><td class="line-content">            }),</td></tr><tr><td class="line-number" value="280"></td><td class="line-content">            new Promise((resolve, reject) =&gt; {</td></tr><tr><td class="line-number" value="281"></td><td class="line-content">                map.loadImage(imageArrows, (error, image) =&gt; {</td></tr><tr><td class="line-number" value="282"></td><td class="line-content">                    if (error) reject(error);</td></tr><tr><td class="line-number" value="283"></td><td class="line-content">                    map.addImage('arrow-icon', image);</td></tr><tr><td class="line-number" value="284"></td><td class="line-content">                    resolve();</td></tr><tr><td class="line-number" value="285"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="286"></td><td class="line-content">            })</td></tr><tr><td class="line-number" value="287"></td><td class="line-content">        ]).then(() =&gt; {</td></tr><tr><td class="line-number" value="288"></td><td class="line-content">            // Add the route source</td></tr><tr><td class="line-number" value="289"></td><td class="line-content">            map.addSource('route', {</td></tr><tr><td class="line-number" value="290"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="291"></td><td class="line-content">                'data': geojson</td></tr><tr><td class="line-number" value="292"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="293"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="294"></td><td class="line-content">            // Add the bus stops source</td></tr><tr><td class="line-number" value="295"></td><td class="line-content">            map.addSource('bus-stops', {</td></tr><tr><td class="line-number" value="296"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="297"></td><td class="line-content">                'data': poisGeoJSON</td></tr><tr><td class="line-number" value="298"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="299"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="300"></td><td class="line-content">            // Add the bus source</td></tr><tr><td class="line-number" value="301"></td><td class="line-content">            map.addSource('bus', {</td></tr><tr><td class="line-number" value="302"></td><td class="line-content">                'type': 'geojson',</td></tr><tr><td class="line-number" value="303"></td><td class="line-content">                'data': busGeoJSON</td></tr><tr><td class="line-number" value="304"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="305"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="306"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="307"></td><td class="line-content">            // Add the arrow layer</td></tr><tr><td class="line-number" value="308"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="309"></td><td class="line-content">                'id': 'route-arrows',</td></tr><tr><td class="line-number" value="310"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="311"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="312"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="313"></td><td class="line-content">                    'symbol-placement': 'line',</td></tr><tr><td class="line-number" value="314"></td><td class="line-content">                    'symbol-spacing': 25,</td></tr><tr><td class="line-number" value="315"></td><td class="line-content">                    'icon-image': 'arrow-icon',</td></tr><tr><td class="line-number" value="316"></td><td class="line-content">                    'icon-size': 0.3,</td></tr><tr><td class="line-number" value="317"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="318"></td><td class="line-content">                    'icon-ignore-placement': true,</td></tr><tr><td class="line-number" value="319"></td><td class="line-content">                    'icon-rotation-alignment': 'map',</td></tr><tr><td class="line-number" value="320"></td><td class="line-content">                    'icon-pitch-alignment': 'map'</td></tr><tr><td class="line-number" value="321"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="322"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="323"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="324"></td><td class="line-content">            // Add the route layer</td></tr><tr><td class="line-number" value="325"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="326"></td><td class="line-content">                'id': 'route',</td></tr><tr><td class="line-number" value="327"></td><td class="line-content">                'type': 'line',</td></tr><tr><td class="line-number" value="328"></td><td class="line-content">                'source': 'route',</td></tr><tr><td class="line-number" value="329"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="330"></td><td class="line-content">                    'line-join': 'round',</td></tr><tr><td class="line-number" value="331"></td><td class="line-content">                    'line-cap': 'round'</td></tr><tr><td class="line-number" value="332"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="333"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="334"></td><td class="line-content">                    'line-color': '#ff0000',</td></tr><tr><td class="line-number" value="335"></td><td class="line-content">                    'line-width': 3</td></tr><tr><td class="line-number" value="336"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="337"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="338"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="339"></td><td class="line-content">            // Add the bus stops layer</td></tr><tr><td class="line-number" value="340"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="341"></td><td class="line-content">                'id': 'bus-stops',</td></tr><tr><td class="line-number" value="342"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="343"></td><td class="line-content">                'source': 'bus-stops',</td></tr><tr><td class="line-number" value="344"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="345"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="346"></td><td class="line-content">                    'icon-image': 'bus-stop-icon',</td></tr><tr><td class="line-number" value="347"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="348"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="349"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="350"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="351"></td><td class="line-content">                        10, 0.45,</td></tr><tr><td class="line-number" value="352"></td><td class="line-content">                        13, 0.55,</td></tr><tr><td class="line-number" value="353"></td><td class="line-content">                        16, 0.65</td></tr><tr><td class="line-number" value="354"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="355"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="356"></td><td class="line-content">                    'text-field': ['get', 'name'],</td></tr><tr><td class="line-number" value="357"></td><td class="line-content">                    'text-size': 11.5,</td></tr><tr><td class="line-number" value="358"></td><td class="line-content">                    'text-offset': [0, -1.8],</td></tr><tr><td class="line-number" value="359"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="360"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="361"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold'],</td></tr><tr><td class="line-number" value="362"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="363"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="364"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="365"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="366"></td><td class="line-content">                    'text-color': '#6884D9',</td></tr><tr><td class="line-number" value="367"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="368"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="369"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="370"></td><td class="line-content">            // Add the bus layer</td></tr><tr><td class="line-number" value="371"></td><td class="line-content">            map.addLayer({</td></tr><tr><td class="line-number" value="372"></td><td class="line-content">                'id': 'bus',</td></tr><tr><td class="line-number" value="373"></td><td class="line-content">                'type': 'symbol',</td></tr><tr><td class="line-number" value="374"></td><td class="line-content">                'source': 'bus',</td></tr><tr><td class="line-number" value="375"></td><td class="line-content">                'layout': {</td></tr><tr><td class="line-number" value="376"></td><td class="line-content">                    'icon-anchor': 'bottom',</td></tr><tr><td class="line-number" value="377"></td><td class="line-content">                    'icon-image': 'bus-icon',</td></tr><tr><td class="line-number" value="378"></td><td class="line-content">                    'icon-size': [</td></tr><tr><td class="line-number" value="379"></td><td class="line-content">                        'interpolate',</td></tr><tr><td class="line-number" value="380"></td><td class="line-content">                        ['linear'],</td></tr><tr><td class="line-number" value="381"></td><td class="line-content">                        ['zoom'],</td></tr><tr><td class="line-number" value="382"></td><td class="line-content">                        10, 0.65,</td></tr><tr><td class="line-number" value="383"></td><td class="line-content">                        13, 0.75,</td></tr><tr><td class="line-number" value="384"></td><td class="line-content">                        16, 0.85</td></tr><tr><td class="line-number" value="385"></td><td class="line-content">                    ],</td></tr><tr><td class="line-number" value="386"></td><td class="line-content">                    'icon-allow-overlap': true,</td></tr><tr><td class="line-number" value="387"></td><td class="line-content">                    'text-field': ['get', 'busId'],</td></tr><tr><td class="line-number" value="388"></td><td class="line-content">                    'text-size': 12,</td></tr><tr><td class="line-number" value="389"></td><td class="line-content">                    'text-offset': [0, -2.1],</td></tr><tr><td class="line-number" value="390"></td><td class="line-content">                    'text-anchor': 'bottom',</td></tr><tr><td class="line-number" value="391"></td><td class="line-content">                    'text-optional': true,</td></tr><tr><td class="line-number" value="392"></td><td class="line-content">                    'text-font': ['Arial Unicode MS Bold']</td></tr><tr><td class="line-number" value="393"></td><td class="line-content">                },</td></tr><tr><td class="line-number" value="394"></td><td class="line-content">                'paint': {</td></tr><tr><td class="line-number" value="395"></td><td class="line-content">                    'text-halo-color': '#ffffff',</td></tr><tr><td class="line-number" value="396"></td><td class="line-content">                    'text-halo-width': 1,</td></tr><tr><td class="line-number" value="397"></td><td class="line-content">                    'text-color': '#ff3c00'</td></tr><tr><td class="line-number" value="398"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="399"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="400"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="401"></td><td class="line-content">            // Add popup on click for buses</td></tr><tr><td class="line-number" value="402"></td><td class="line-content">            map.on('click', 'bus', (e) =&gt; {</td></tr><tr><td class="line-number" value="403"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="404"></td><td class="line-content">                const busId = e.features[0].properties.busId;</td></tr><tr><td class="line-number" value="405"></td><td class="line-content">                const lastUpdate = new Date(e.features[0].properties.lastUpdate).toLocaleString();</td></tr><tr><td class="line-number" value="406"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="407"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="408"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="409"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="410"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="411"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="412"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="413"></td><td class="line-content">                        &lt;p class="bus-stop-name"&gt;Bus ${busId}&lt;/p&gt;</td></tr><tr><td class="line-number" value="414"></td><td class="line-content">                        &lt;p style="margin: 5px 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdate}&lt;/p&gt;</td></tr><tr><td class="line-number" value="415"></td><td class="line-content">                    `)</td></tr><tr><td class="line-number" value="416"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="417"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="418"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="419"></td><td class="line-content">            // Change cursor on hover for buses</td></tr><tr><td class="line-number" value="420"></td><td class="line-content">            map.on('mouseenter', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="421"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="422"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="423"></td><td class="line-content">            map.on('mouseleave', 'bus', () =&gt; {</td></tr><tr><td class="line-number" value="424"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="425"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="426"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="427"></td><td class="line-content">            // Add popup on click for bus stops</td></tr><tr><td class="line-number" value="428"></td><td class="line-content">            map.on('click', 'bus-stops', (e) =&gt; {</td></tr><tr><td class="line-number" value="429"></td><td class="line-content">                const coordinates = e.features[0].geometry.coordinates.slice();</td></tr><tr><td class="line-number" value="430"></td><td class="line-content">                const name = e.features[0].properties.name;</td></tr><tr><td class="line-number" value="431"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="432"></td><td class="line-content">                new mapboxgl.Popup()</td></tr><tr><td class="line-number" value="433"></td><td class="line-content">                    .setLngLat(coordinates)</td></tr><tr><td class="line-number" value="434"></td><td class="line-content">                    .setHTML(`&lt;p class="bus-stop-name"&gt;${name}&lt;/p&gt;`)</td></tr><tr><td class="line-number" value="435"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="436"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="437"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="438"></td><td class="line-content">            // Change cursor on hover for bus stops</td></tr><tr><td class="line-number" value="439"></td><td class="line-content">            map.on('mouseenter', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="440"></td><td class="line-content">                map.getCanvas().style.cursor = 'pointer';</td></tr><tr><td class="line-number" value="441"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="442"></td><td class="line-content">            map.on('mouseleave', 'bus-stops', () =&gt; {</td></tr><tr><td class="line-number" value="443"></td><td class="line-content">                map.getCanvas().style.cursor = '';</td></tr><tr><td class="line-number" value="444"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="445"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="446"></td><td class="line-content">            // Get the bounds of all features</td></tr><tr><td class="line-number" value="447"></td><td class="line-content">            const coordinates = geojson.features[0].geometry.coordinates;</td></tr><tr><td class="line-number" value="448"></td><td class="line-content">            const bounds = coordinates.reduce((bounds, coord) =&gt; {</td></tr><tr><td class="line-number" value="449"></td><td class="line-content">                return bounds.extend(coord);</td></tr><tr><td class="line-number" value="450"></td><td class="line-content">            }, new mapboxgl.LngLatBounds(coordinates[0], coordinates[0]));</td></tr><tr><td class="line-number" value="451"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="452"></td><td class="line-content">            // Extend bounds to include POIs</td></tr><tr><td class="line-number" value="453"></td><td class="line-content">            pois.forEach(poi =&gt; {</td></tr><tr><td class="line-number" value="454"></td><td class="line-content">                bounds.extend([parseFloat(poi.lng), parseFloat(poi.lat)]);</td></tr><tr><td class="line-number" value="455"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="456"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="457"></td><td class="line-content">            // Fit the map to the route with padding</td></tr><tr><td class="line-number" value="458"></td><td class="line-content">            map.fitBounds(bounds, {</td></tr><tr><td class="line-number" value="459"></td><td class="line-content">                padding: 50,</td></tr><tr><td class="line-number" value="460"></td><td class="line-content">                duration: 1000</td></tr><tr><td class="line-number" value="461"></td><td class="line-content">            });</td></tr><tr><td class="line-number" value="462"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="463"></td><td class="line-content">        }).catch(error =&gt; console.error('Error loading images:', error));</td></tr><tr><td class="line-number" value="464"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="465"></td><td class="line-content">        updateBusLocation();</td></tr><tr><td class="line-number" value="466"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="467"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="468"></td><td class="line-content">    // Function to fetch and update bus location</td></tr><tr><td class="line-number" value="469"></td><td class="line-content">    function updateBusLocation() {</td></tr><tr><td class="line-number" value="470"></td><td class="line-content">        $.ajax({</td></tr><tr><td class="line-number" value="471"></td><td class="line-content">            url: `https://live.paj.com.my/get/PN002`,</td></tr><tr><td class="line-number" value="472"></td><td class="line-content">            method: 'get',</td></tr><tr><td class="line-number" value="473"></td><td class="line-content">            cache: false,</td></tr><tr><td class="line-number" value="474"></td><td class="line-content">            dataType: "json",</td></tr><tr><td class="line-number" value="475"></td><td class="line-content">            success: function(result) {</td></tr><tr><td class="line-number" value="476"></td><td class="line-content">                if (result.success) {</td></tr><tr><td class="line-number" value="477"></td><td class="line-content">                    let arrayData = Object.values(result.data);</td></tr><tr><td class="line-number" value="478"></td><td class="line-content">                    // Update bus positions in GeoJSON</td></tr><tr><td class="line-number" value="479"></td><td class="line-content">                    const newBusGeoJSON = {</td></tr><tr><td class="line-number" value="480"></td><td class="line-content">                        type: 'FeatureCollection',</td></tr><tr><td class="line-number" value="481"></td><td class="line-content">                        features: arrayData.map(bus =&gt; ({</td></tr><tr><td class="line-number" value="482"></td><td class="line-content">                            type: 'Feature',</td></tr><tr><td class="line-number" value="483"></td><td class="line-content">                            geometry: {</td></tr><tr><td class="line-number" value="484"></td><td class="line-content">                                type: 'Point',</td></tr><tr><td class="line-number" value="485"></td><td class="line-content">                                coordinates: [bus.lng, bus.lat]</td></tr><tr><td class="line-number" value="486"></td><td class="line-content">                            },</td></tr><tr><td class="line-number" value="487"></td><td class="line-content">                            properties: {</td></tr><tr><td class="line-number" value="488"></td><td class="line-content">                                busId: bus.bus,</td></tr><tr><td class="line-number" value="489"></td><td class="line-content">                                title: `Bus ${bus.bus}`,</td></tr><tr><td class="line-number" value="490"></td><td class="line-content">                                lastUpdate: bus.time</td></tr><tr><td class="line-number" value="491"></td><td class="line-content">                            }</td></tr><tr><td class="line-number" value="492"></td><td class="line-content">                        }))</td></tr><tr><td class="line-number" value="493"></td><td class="line-content">                    };</td></tr><tr><td class="line-number" value="494"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="495"></td><td class="line-content">                    try {</td></tr><tr><td class="line-number" value="496"></td><td class="line-content">                        map.getSource('bus').setData(newBusGeoJSON);</td></tr><tr><td class="line-number" value="497"></td><td class="line-content">                        // Update the sliding cards</td></tr><tr><td class="line-number" value="498"></td><td class="line-content">                        updateBusCards(arrayData);</td></tr><tr><td class="line-number" value="499"></td><td class="line-content">                    } catch (e) {</td></tr><tr><td class="line-number" value="500"></td><td class="line-content">                        // console.error('Error updating map:', e);</td></tr><tr><td class="line-number" value="501"></td><td class="line-content">                    }</td></tr><tr><td class="line-number" value="502"></td><td class="line-content">                } else {</td></tr><tr><td class="line-number" value="503"></td><td class="line-content">                    // console.log('Error:', result.message);</td></tr><tr><td class="line-number" value="504"></td><td class="line-content">                }</td></tr><tr><td class="line-number" value="505"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="506"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="507"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="508"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="509"></td><td class="line-content">    // Function to update bus cards</td></tr><tr><td class="line-number" value="510"></td><td class="line-content">    function updateBusCards(busData) {</td></tr><tr><td class="line-number" value="511"></td><td class="line-content">        const busCardsContainer = document.getElementById('busCards');</td></tr><tr><td class="line-number" value="512"></td><td class="line-content">        busCardsContainer.innerHTML = ''; // Clear existing cards</td></tr><tr><td class="line-number" value="513"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="514"></td><td class="line-content">        if (busData.length &lt; 3) {</td></tr><tr><td class="line-number" value="515"></td><td class="line-content">            // Center the container for a single bus</td></tr><tr><td class="line-number" value="516"></td><td class="line-content">            busCardsContainer.style.display = 'flex';</td></tr><tr><td class="line-number" value="517"></td><td class="line-content">            busCardsContainer.style.justifyContent = 'center';</td></tr><tr><td class="line-number" value="518"></td><td class="line-content">        } else {</td></tr><tr><td class="line-number" value="519"></td><td class="line-content">            // Restore default styles for multiple buses</td></tr><tr><td class="line-number" value="520"></td><td class="line-content">            busCardsContainer.style.display = 'block';</td></tr><tr><td class="line-number" value="521"></td><td class="line-content">            busCardsContainer.style.justifyContent = ''; // Clear the justifyContent</td></tr><tr><td class="line-number" value="522"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="523"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="524"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="525"></td><td class="line-content">        busData.forEach(bus =&gt; {</td></tr><tr><td class="line-number" value="526"></td><td class="line-content">            const card = document.createElement('div');</td></tr><tr><td class="line-number" value="527"></td><td class="line-content">            card.className = 'bus-card';</td></tr><tr><td class="line-number" value="528"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="529"></td><td class="line-content">            // Check if the last update is within the last 30 minutes</td></tr><tr><td class="line-number" value="530"></td><td class="line-content">            const lastUpdateTime = new Date(bus.time);</td></tr><tr><td class="line-number" value="531"></td><td class="line-content">            // const timeDifferenceInMinutes = (currentTime - lastUpdateTime) / (1000 * 60);</td></tr><tr><td class="line-number" value="532"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="533"></td><td class="line-content">            // if (timeDifferenceInMinutes &lt;= 30) {</td></tr><tr><td class="line-number" value="534"></td><td class="line-content">            //     card.style.background = 'rgb(20,192,80)'; // Light green background</td></tr><tr><td class="line-number" value="535"></td><td class="line-content">            // }</td></tr><tr><td class="line-number" value="536"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="537"></td><td class="line-content">            card.onclick = () =&gt; {</td></tr><tr><td class="line-number" value="538"></td><td class="line-content">                // Remove active class from all cards</td></tr><tr><td class="line-number" value="539"></td><td class="line-content">                document.querySelectorAll('.bus-card').forEach(c =&gt; c.classList.remove('active'));</td></tr><tr><td class="line-number" value="540"></td><td class="line-content">                // Add active class to clicked card</td></tr><tr><td class="line-number" value="541"></td><td class="line-content">                card.classList.add('active');</td></tr><tr><td class="line-number" value="542"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="543"></td><td class="line-content">                // Fly to bus location</td></tr><tr><td class="line-number" value="544"></td><td class="line-content">                map.flyTo({</td></tr><tr><td class="line-number" value="545"></td><td class="line-content">                    center: [bus.lng, bus.lat],</td></tr><tr><td class="line-number" value="546"></td><td class="line-content">                    zoom: 15,</td></tr><tr><td class="line-number" value="547"></td><td class="line-content">                    duration: 1000</td></tr><tr><td class="line-number" value="548"></td><td class="line-content">                });</td></tr><tr><td class="line-number" value="549"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="550"></td><td class="line-content">                // Show popup for the bus</td></tr><tr><td class="line-number" value="551"></td><td class="line-content">                new mapboxgl.Popup({</td></tr><tr><td class="line-number" value="552"></td><td class="line-content">                    anchor: 'bottom',</td></tr><tr><td class="line-number" value="553"></td><td class="line-content">                    offset: [0, -40]</td></tr><tr><td class="line-number" value="554"></td><td class="line-content">                })</td></tr><tr><td class="line-number" value="555"></td><td class="line-content">                    .setLngLat([bus.lng, bus.lat])</td></tr><tr><td class="line-number" value="556"></td><td class="line-content">                    .setHTML(`</td></tr><tr><td class="line-number" value="557"></td><td class="line-content">                    &lt;p class="bus-stop-name"&gt;Bus ${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="558"></td><td class="line-content">                    &lt;p style="margin: 0 0 0 0; font-size: 12px;"&gt;Update: ${lastUpdateTime.toLocaleString()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="559"></td><td class="line-content">                `)</td></tr><tr><td class="line-number" value="560"></td><td class="line-content">                    .addTo(map);</td></tr><tr><td class="line-number" value="561"></td><td class="line-content">            };</td></tr><tr><td class="line-number" value="562"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="563"></td><td class="line-content">            let time = new Date(bus.time);</td></tr><tr><td class="line-number" value="564"></td><td class="line-content">            let now = new Date();</td></tr><tr><td class="line-number" value="565"></td><td class="line-content">            let timeDifference = (now - time) / (1000 * 60); // Difference in minutes</td></tr><tr><td class="line-number" value="566"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="567"></td><td class="line-content">            let onlineStat = '';</td></tr><tr><td class="line-number" value="568"></td><td class="line-content">            // Apply green background if less than 30 minutes</td></tr><tr><td class="line-number" value="569"></td><td class="line-content">            if (timeDifference &lt; 30) {</td></tr><tr><td class="line-number" value="570"></td><td class="line-content">                // add a class to the card</td></tr><tr><td class="line-number" value="571"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream mt-1 fs-2 online" style="color: #0fa354 !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="572"></td><td class="line-content">                card.classList.add('online');</td></tr><tr><td class="line-number" value="573"></td><td class="line-content">                card.classList.remove('offline');</td></tr><tr><td class="line-number" value="574"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="575"></td><td class="line-content">            else {</td></tr><tr><td class="line-number" value="576"></td><td class="line-content">                // remove the class</td></tr><tr><td class="line-number" value="577"></td><td class="line-content">                onlineStat = `&lt;i class="fa-solid fa-signal-stream-slash mt-1 fs-2 offline" style="color: #ff274f !important;"&gt;&lt;/i&gt;`;</td></tr><tr><td class="line-number" value="578"></td><td class="line-content">                card.classList.remove('online');</td></tr><tr><td class="line-number" value="579"></td><td class="line-content">                card.classList.add('offline');</td></tr><tr><td class="line-number" value="580"></td><td class="line-content">            }</td></tr><tr><td class="line-number" value="581"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="582"></td><td class="line-content">            // Format time as dd/mm/yyyy hh:mm:ss AM/PM</td></tr><tr><td class="line-number" value="583"></td><td class="line-content">            let timeString = time.toLocaleString('en-GB', {hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true});</td></tr><tr><td class="line-number" value="584"></td><td class="line-content">            card.innerHTML = `</td></tr><tr><td class="line-number" value="585"></td><td class="line-content">                &lt;div class="d-flex justify-content-between"&gt;</td></tr><tr><td class="line-number" value="586"></td><td class="line-content">                    &lt;div class="d-flex"&gt;</td></tr><tr><td class="line-number" value="587"></td><td class="line-content">                        &lt;div class="legend-icon me-1" style="background-image: url(https://live.paj.com.my/assets/bus-marker.png)"&gt;&lt;/div&gt;</td></tr><tr><td class="line-number" value="588"></td><td class="line-content">                        &lt;p class="bus-id mb-0 fs-4 fw-bold"&gt;${bus.bus}&lt;/p&gt;</td></tr><tr><td class="line-number" value="589"></td><td class="line-content">                    &lt;/div&gt;</td></tr><tr><td class="line-number" value="590"></td><td class="line-content">                    ${onlineStat}</td></tr><tr><td class="line-number" value="591"></td><td class="line-content">                &lt;/div&gt;</td></tr><tr><td class="line-number" value="592"></td><td class="line-content">                &lt;p class="last-update fs-7 fw-bold"&gt;&lt;i class="fa-solid fa-clock ms-1 me-2 text-primary"&gt;&lt;/i&gt;${timeString.toUpperCase()}&lt;/p&gt;</td></tr><tr><td class="line-number" value="593"></td><td class="line-content">            `;</td></tr><tr><td class="line-number" value="594"></td><td class="line-content">            busCardsContainer.appendChild(card);</td></tr><tr><td class="line-number" value="595"></td><td class="line-content">        });</td></tr><tr><td class="line-number" value="596"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="597"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="598"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="599"></td><td class="line-content">    // interval to update bus location</td></tr><tr><td class="line-number" value="600"></td><td class="line-content">    setInterval(updateBusLocation, 10000);</td></tr><tr><td class="line-number" value="601"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="602"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="603"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span></td></tr><tr><td class="line-number" value="604"></td><td class="line-content"><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>